[2021-06-10 21:39:54,116] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-10 21:39:57,823] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_serial.py --batch-size 12289 --deepspeed_config ds_config.json
[2021-06-10 21:39:58,767] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-10 21:39:58,767] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-10 21:39:58,767] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-10 21:39:58,767] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-10 21:39:58,767] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623361204.2395558
before load_ogb step Time(s): 0.0019
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.17578125, 'VmSize': 20395.00390625, 'VmHWM': 1164.453125, 'VmRSS': 1164.453125}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6439
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2828
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0785
-------------------------------------------------end of load ogb****************** step Time(s): 0.0021
finish constructing ogbn-products
load ogb-products time total: 2.0087664127349854
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0097
after inductive else step Time(s): 0.0000
after label step Time(s): 3.8112
after train_g.create_formats_() step Time(s): 1.7393
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-10 21:40:11,832] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-10 21:40:11,832] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-10 21:40:11,837] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-10 21:40:14,209] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-10 21:40:14,211] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-10 21:40:14,212] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-10 21:40:14,212] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-10 21:40:14,212] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-10 21:40:14,212] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7fcb7a558860>
[2021-06-10 21:40:14,212] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 21:40:14,212] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-10 21:40:14,212] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-10 21:40:14,213] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-10 21:40:14,214] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-10 21:40:14,214] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-10 21:40:14,215] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9306011199951172  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68603515625GB

Max Memory Allocated 1.2876191139221191  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.74072265625GB

Max Memory Allocated 1.2876191139221191  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.03955078125GB

Max Memory Allocated 1.3846850395202637  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.03955078125GB

Max Memory Allocated 1.3846850395202637  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.410447120666504  GigaBytes

Epoch 00000 | Step 00000 | Loss 5.6163 | Train Acc 0.0200 | Speed (samples/sec) nan | GPU 1444.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.410447120666504  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6394777297973633  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6394777297973633  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6394777297973633  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6394777297973633  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6394777297973633  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6394777297973633  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6394777297973633  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6394777297973633  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6394777297973633  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51611328125GB

Max Memory Allocated 1.6394777297973633  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6394777297973633  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6394777297973633  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6400704383850098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6400704383850098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6400704383850098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6400704383850098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6400704383850098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6400704383850098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86376953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86572265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

avg iteration(step) data from cpu to GPU time:16.33777176 ms
avg iteration GPU training time:22.29503129 ms
avg iteration (step) total cpu time:197.72570783 ms
Epoch Time(s): 5.2831
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

Epoch 00001 | Step 00000 | Loss 4.2064 | Train Acc 0.0798 | Speed (samples/sec) 179981.2190 | GPU 1681.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86376953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

avg iteration(step) data from cpu to GPU time:16.15278279 ms
avg iteration GPU training time:22.74384880 ms
avg iteration (step) total cpu time:165.29811512 ms
Epoch Time(s): 5.3382
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

Epoch 00002 | Step 00000 | Loss 4.1735 | Train Acc 0.0834 | Speed (samples/sec) 185359.3778 | GPU 1681.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419286727905273  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

avg iteration(step) data from cpu to GPU time:16.48104113 ms
avg iteration GPU training time:21.41323332 ms
avg iteration (step) total cpu time:159.06284072 ms
Epoch Time(s): 4.9618
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

Epoch 00003 | Step 00000 | Loss 3.9014 | Train Acc 0.1114 | Speed (samples/sec) 182633.5488 | GPU 1681.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.92041015625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94384765625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91845703125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86376953125GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419525146484375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

avg iteration(step) data from cpu to GPU time:16.01696569 ms
avg iteration GPU training time:21.57724502 ms
avg iteration (step) total cpu time:185.06617980 ms
Epoch Time(s): 5.1962
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

Epoch 00004 | Step 00000 | Loss 3.4588 | Train Acc 0.1720 | Speed (samples/sec) 185983.1428 | GPU 1681.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

avg iteration(step) data from cpu to GPU time:16.99424301 ms
avg iteration GPU training time:21.47507217 ms
avg iteration (step) total cpu time:181.07247353 ms
Epoch Time(s): 5.2824
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

Epoch 00005 | Step 00000 | Loss 3.0701 | Train Acc 0.2555 | Speed (samples/sec) 183546.9759 | GPU 1681.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

avg iteration(step) data from cpu to GPU time:16.43219774 ms
avg iteration GPU training time:21.02177186 ms
avg iteration (step) total cpu time:164.08939795 ms
Epoch Time(s): 4.8900
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

Epoch 00006 | Step 00000 | Loss 2.6388 | Train Acc 0.3481 | Speed (samples/sec) 183017.7302 | GPU 1681.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

avg iteration(step) data from cpu to GPU time:17.82144599 ms
avg iteration GPU training time:22.13641305 ms
avg iteration (step) total cpu time:271.22077075 ms
Epoch Time(s): 8.7495
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

Epoch 00007 | Step 00000 | Loss 2.2817 | Train Acc 0.4215 | Speed (samples/sec) 183316.9241 | GPU 1681.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.641977310180664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:16.66719142 ms
avg iteration GPU training time:22.15207256 ms
avg iteration (step) total cpu time:219.59655935 ms
Epoch Time(s): 5.4014
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00008 | Step 00000 | Loss 2.0265 | Train Acc 0.4735 | Speed (samples/sec) 181902.2430 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:17.37278262 ms
avg iteration GPU training time:22.20449742 ms
avg iteration (step) total cpu time:167.23682664 ms
Epoch Time(s): 5.0472
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00009 | Step 00000 | Loss 1.7849 | Train Acc 0.5171 | Speed (samples/sec) 180493.5089 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

[2021-06-10 21:41:11,211] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-10 21:41:11,211] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=4762.247673240839
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:15.16287726 ms
avg iteration GPU training time:21.03112706 ms
avg iteration (step) total cpu time:246.17977576 ms
Epoch Time(s): 6.8451
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00010 | Step 00000 | Loss 1.6397 | Train Acc 0.5465 | Speed (samples/sec) 182531.7128 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:19.54576874 ms
avg iteration GPU training time:21.85536315 ms
avg iteration (step) total cpu time:243.10421944 ms
Epoch Time(s): 5.8417
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00011 | Step 00000 | Loss 1.5120 | Train Acc 0.5728 | Speed (samples/sec) 176705.8969 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:17.13566555 ms
avg iteration GPU training time:24.44736880 ms
avg iteration (step) total cpu time:231.58303174 ms
Epoch Time(s): 5.8268
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00012 | Step 00000 | Loss 1.3905 | Train Acc 0.6147 | Speed (samples/sec) 172117.2799 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:15.53774842 ms
avg iteration GPU training time:22.00432587 ms
avg iteration (step) total cpu time:202.61966098 ms
Epoch Time(s): 5.6307
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00013 | Step 00000 | Loss 1.2768 | Train Acc 0.6591 | Speed (samples/sec) 173903.2497 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:15.81178188 ms
avg iteration GPU training time:21.05964227 ms
avg iteration (step) total cpu time:192.83749840 ms
Epoch Time(s): 5.0937
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00014 | Step 00000 | Loss 1.2201 | Train Acc 0.6821 | Speed (samples/sec) 174896.6412 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:16.85024305 ms
avg iteration GPU training time:21.81819656 ms
avg iteration (step) total cpu time:166.81228984 ms
Epoch Time(s): 4.8803
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00015 | Step 00000 | Loss 1.1648 | Train Acc 0.7080 | Speed (samples/sec) 175485.4439 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:15.86950389 ms
avg iteration GPU training time:20.65289255 ms
avg iteration (step) total cpu time:167.85511104 ms
Epoch Time(s): 4.9732
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00016 | Step 00000 | Loss 1.1075 | Train Acc 0.7260 | Speed (samples/sec) 176919.0306 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:16.45095556 ms
avg iteration GPU training time:21.34050889 ms
avg iteration (step) total cpu time:189.52798843 ms
Epoch Time(s): 5.1888
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00017 | Step 00000 | Loss 1.0614 | Train Acc 0.7343 | Speed (samples/sec) 177806.8197 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:14.69501097 ms
avg iteration GPU training time:23.58798530 ms
avg iteration (step) total cpu time:178.52553454 ms
Epoch Time(s): 5.1006
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.9749 | Train Acc 0.7538 | Speed (samples/sec) 178443.6213 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:15.78569612 ms
avg iteration GPU training time:21.10452635 ms
avg iteration (step) total cpu time:183.55545131 ms
Epoch Time(s): 5.0529
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.9605 | Train Acc 0.7614 | Speed (samples/sec) 178173.0164 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

[2021-06-10 21:42:04,576] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 21:42:04,576] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=4819.810428912374
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:15.70921005 ms
avg iteration GPU training time:21.40823243 ms
avg iteration (step) total cpu time:220.33342448 ms
Epoch Time(s): 5.7752
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.9114 | Train Acc 0.7805 | Speed (samples/sec) 179189.0756 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

avg iteration(step) data from cpu to GPU time:16.63716949 ms
avg iteration GPU training time:23.01477502 ms
avg iteration (step) total cpu time:205.43339036 ms
Epoch Time(s): 5.2881
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.9024 | Train Acc 0.7811 | Speed (samples/sec) 178029.9258 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6430435180664062  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

avg iteration(step) data from cpu to GPU time:16.32329022 ms
avg iteration GPU training time:20.77397797 ms
avg iteration (step) total cpu time:163.25436939 ms
Epoch Time(s): 4.8784
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.8904 | Train Acc 0.7877 | Speed (samples/sec) 178631.6069 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

avg iteration(step) data from cpu to GPU time:17.45542960 ms
avg iteration GPU training time:20.80467796 ms
avg iteration (step) total cpu time:182.38607320 ms
Epoch Time(s): 5.0628
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.8484 | Train Acc 0.7947 | Speed (samples/sec) 179149.2999 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

avg iteration(step) data from cpu to GPU time:17.26194312 ms
avg iteration GPU training time:21.41300063 ms
avg iteration (step) total cpu time:292.33750430 ms
Epoch Time(s): 6.6455
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.8216 | Train Acc 0.8015 | Speed (samples/sec) 178295.2289 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

avg iteration(step) data from cpu to GPU time:15.08834319 ms
avg iteration GPU training time:20.90350827 ms
avg iteration (step) total cpu time:166.87787663 ms
Epoch Time(s): 5.2326
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.8078 | Train Acc 0.8015 | Speed (samples/sec) 178817.7680 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

avg iteration(step) data from cpu to GPU time:15.90449168 ms
avg iteration GPU training time:21.50996936 ms
avg iteration (step) total cpu time:197.16991078 ms
Epoch Time(s): 5.1214
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.7660 | Train Acc 0.8098 | Speed (samples/sec) 177613.8609 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

avg iteration(step) data from cpu to GPU time:17.08618190 ms
avg iteration GPU training time:21.45457719 ms
avg iteration (step) total cpu time:283.27816183 ms
Epoch Time(s): 6.4099
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.7478 | Train Acc 0.8179 | Speed (samples/sec) 176202.8034 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

avg iteration(step) data from cpu to GPU time:14.82563201 ms
avg iteration GPU training time:23.74691807 ms
avg iteration (step) total cpu time:207.95692097 ms
Epoch Time(s): 5.5523
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.7428 | Train Acc 0.8161 | Speed (samples/sec) 174950.4785 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

avg iteration(step) data from cpu to GPU time:15.02942233 ms
avg iteration GPU training time:21.26417143 ms
avg iteration (step) total cpu time:190.49551270 ms
Epoch Time(s): 5.3122
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.7149 | Train Acc 0.8226 | Speed (samples/sec) 175654.4661 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

[2021-06-10 21:42:59,523] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 21:42:59,523] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=4882.599385243062
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

avg iteration(step) data from cpu to GPU time:17.31529583 ms
avg iteration GPU training time:20.75032165 ms
avg iteration (step) total cpu time:195.85429538 ms
Epoch Time(s): 5.4435
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.7310 | Train Acc 0.8203 | Speed (samples/sec) 176185.1912 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

avg iteration(step) data from cpu to GPU time:16.95430400 ms
avg iteration GPU training time:20.72693513 ms
avg iteration (step) total cpu time:167.88775271 ms
Epoch Time(s): 5.0085
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.7060 | Train Acc 0.8294 | Speed (samples/sec) 176362.3811 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437797546386719  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.10041298 ms
avg iteration GPU training time:20.71194753 ms
avg iteration (step) total cpu time:167.27083380 ms
Epoch Time(s): 4.8788
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.6846 | Train Acc 0.8286 | Speed (samples/sec) 176866.0242 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:15.24962928 ms
avg iteration GPU training time:20.71985435 ms
avg iteration (step) total cpu time:192.18876145 ms
Epoch Time(s): 5.3371
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.6732 | Train Acc 0.8295 | Speed (samples/sec) 177610.3980 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:16.05522910 ms
avg iteration GPU training time:20.88781669 ms
avg iteration (step) total cpu time:172.46486924 ms
Epoch Time(s): 5.0328
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.6536 | Train Acc 0.8346 | Speed (samples/sec) 178255.2324 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:16.50975123 ms
avg iteration GPU training time:22.29916503 ms
avg iteration (step) total cpu time:210.62751250 ms
Epoch Time(s): 5.5706
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.6687 | Train Acc 0.8311 | Speed (samples/sec) 178711.9445 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:15.23598550 ms
avg iteration GPU training time:21.25665734 ms
avg iteration (step) total cpu time:192.07913225 ms
Epoch Time(s): 5.2652
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.6541 | Train Acc 0.8356 | Speed (samples/sec) 178757.4035 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.38184131 ms
avg iteration GPU training time:20.83032435 ms
avg iteration (step) total cpu time:180.55384809 ms
Epoch Time(s): 5.1174
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.6637 | Train Acc 0.8320 | Speed (samples/sec) 179134.1302 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:15.13774551 ms
avg iteration GPU training time:20.72485525 ms
avg iteration (step) total cpu time:177.78873444 ms
Epoch Time(s): 5.1086
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.6374 | Train Acc 0.8392 | Speed (samples/sec) 179439.8495 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:15.74926845 ms
avg iteration GPU training time:20.55077518 ms
avg iteration (step) total cpu time:181.20691993 ms
Epoch Time(s): 5.0930
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.6457 | Train Acc 0.8374 | Speed (samples/sec) 179910.6324 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

[2021-06-10 21:43:51,104] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 21:43:51,105] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=4874.832597672844
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:20.49668642 ms
avg iteration GPU training time:21.28341259 ms
avg iteration (step) total cpu time:189.75355408 ms
Epoch Time(s): 5.1683
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.6369 | Train Acc 0.8408 | Speed (samples/sec) 179416.1620 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:16.14612363 ms
avg iteration GPU training time:20.43563929 ms
avg iteration (step) total cpu time:164.34528611 ms
Epoch Time(s): 4.8710
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.6345 | Train Acc 0.8386 | Speed (samples/sec) 179670.2013 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:16.26429098 ms
avg iteration GPU training time:22.11424307 ms
avg iteration (step) total cpu time:193.03376024 ms
Epoch Time(s): 5.2061
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.6239 | Train Acc 0.8438 | Speed (samples/sec) 179203.7908 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.26020371 ms
avg iteration GPU training time:25.05617176 ms
avg iteration (step) total cpu time:191.81114977 ms
Epoch Time(s): 5.2870
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.6205 | Train Acc 0.8424 | Speed (samples/sec) 179164.6297 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6439385414123535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

avg iteration(step) data from cpu to GPU time:15.39231994 ms
avg iteration GPU training time:21.05021962 ms
avg iteration (step) total cpu time:179.90316044 ms
Epoch Time(s): 5.0816
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.5800 | Train Acc 0.8519 | Speed (samples/sec) 179717.0626 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

avg iteration(step) data from cpu to GPU time:16.47093530 ms
avg iteration GPU training time:21.23538902 ms
avg iteration (step) total cpu time:189.14504485 ms
Epoch Time(s): 5.1914
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.6174 | Train Acc 0.8450 | Speed (samples/sec) 179826.2221 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

avg iteration(step) data from cpu to GPU time:18.12258365 ms
avg iteration GPU training time:21.82053531 ms
avg iteration (step) total cpu time:181.60676956 ms
Epoch Time(s): 5.0706
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.5858 | Train Acc 0.8469 | Speed (samples/sec) 179881.9224 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

avg iteration(step) data from cpu to GPU time:15.44156508 ms
avg iteration GPU training time:20.68000273 ms
avg iteration (step) total cpu time:195.21739266 ms
Epoch Time(s): 5.2695
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.6195 | Train Acc 0.8445 | Speed (samples/sec) 180340.8981 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21923828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

avg iteration(step) data from cpu to GPU time:16.97303581 ms
avg iteration GPU training time:20.69423450 ms
avg iteration (step) total cpu time:181.59287626 ms
Epoch Time(s): 5.0495
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.6012 | Train Acc 0.8457 | Speed (samples/sec) 180242.5192 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

avg iteration(step) data from cpu to GPU time:16.96524507 ms
avg iteration GPU training time:21.86745609 ms
avg iteration (step) total cpu time:185.74380875 ms
Epoch Time(s): 5.1394
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.5924 | Train Acc 0.8488 | Speed (samples/sec) 180321.3337 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

[2021-06-10 21:44:42,245] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 21:44:42,245] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=4923.309437473662
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

avg iteration(step) data from cpu to GPU time:16.06984719 ms
avg iteration GPU training time:21.26621680 ms
avg iteration (step) total cpu time:168.10074720 ms
Epoch Time(s): 4.9733
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.5927 | Train Acc 0.8476 | Speed (samples/sec) 180594.4391 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27392578125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29736328125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27197265625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.644096851348877  GigaBytes

avg iteration(step) data from cpu to GPU time:16.55195626 ms
avg iteration GPU training time:20.97824894 ms
avg iteration (step) total cpu time:188.30310215 ms
Epoch Time(s): 5.3030
Eval Acc 0.8577
Test Acc: 0.6817
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.5852 | Train Acc 0.8499 | Speed (samples/sec) 180852.6378 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.53110981 ms
avg iteration GPU training time:21.30266172 ms
avg iteration (step) total cpu time:250.83866986 ms
Epoch Time(s): 6.0507
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.5934 | Train Acc 0.8467 | Speed (samples/sec) 180166.7730 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.92430800 ms
avg iteration GPU training time:21.72712708 ms
avg iteration (step) total cpu time:219.94083578 ms
Epoch Time(s): 5.4467
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.5782 | Train Acc 0.8520 | Speed (samples/sec) 180201.2152 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.34685681 ms
avg iteration GPU training time:21.96396203 ms
avg iteration (step) total cpu time:242.53788861 ms
Epoch Time(s): 5.6693
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.5664 | Train Acc 0.8517 | Speed (samples/sec) 179552.3778 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.99323940 ms
avg iteration GPU training time:20.95922626 ms
avg iteration (step) total cpu time:163.39226203 ms
Epoch Time(s): 4.9810
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.5631 | Train Acc 0.8579 | Speed (samples/sec) 179815.1692 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.17032415 ms
avg iteration GPU training time:20.98528862 ms
avg iteration (step) total cpu time:193.21084023 ms
Epoch Time(s): 5.1599
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.5832 | Train Acc 0.8481 | Speed (samples/sec) 180052.1838 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.65508643 ms
avg iteration GPU training time:22.76150114 ms
avg iteration (step) total cpu time:181.92811446 ms
Epoch Time(s): 5.1536
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.5811 | Train Acc 0.8456 | Speed (samples/sec) 180255.6682 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.33778026 ms
avg iteration GPU training time:21.16660656 ms
avg iteration (step) total cpu time:185.68513610 ms
Epoch Time(s): 5.2400
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.5520 | Train Acc 0.8571 | Speed (samples/sec) 180646.0518 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.39921743 ms
avg iteration GPU training time:21.13697416 ms
avg iteration (step) total cpu time:208.86824348 ms
Epoch Time(s): 5.3837
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.5597 | Train Acc 0.8544 | Speed (samples/sec) 180537.3288 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

[2021-06-10 21:46:08,866] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 21:46:08,866] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=4946.0992627867245
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.54822089 ms
avg iteration GPU training time:22.40379039 ms
avg iteration (step) total cpu time:183.26523087 ms
Epoch Time(s): 5.1129
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.5516 | Train Acc 0.8598 | Speed (samples/sec) 180695.4286 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.84514887 ms
avg iteration GPU training time:21.22380499 ms
avg iteration (step) total cpu time:166.96359894 ms
Epoch Time(s): 4.9581
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.5439 | Train Acc 0.8586 | Speed (samples/sec) 180640.7406 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.88523648 ms
avg iteration GPU training time:20.73643650 ms
avg iteration (step) total cpu time:204.25839858 ms
Epoch Time(s): 5.4452
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.5810 | Train Acc 0.8489 | Speed (samples/sec) 180917.9922 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:18.46997825 ms
avg iteration GPU training time:21.14107045 ms
avg iteration (step) total cpu time:162.37995841 ms
Epoch Time(s): 4.9375
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.5525 | Train Acc 0.8561 | Speed (samples/sec) 181004.1627 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.47421395 ms
avg iteration GPU training time:21.59045237 ms
avg iteration (step) total cpu time:174.35392466 ms
Epoch Time(s): 5.0442
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.5511 | Train Acc 0.8564 | Speed (samples/sec) 180880.1289 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.68614101 ms
avg iteration GPU training time:21.12987640 ms
avg iteration (step) total cpu time:191.75030968 ms
Epoch Time(s): 5.2677
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.5562 | Train Acc 0.8543 | Speed (samples/sec) 180937.6900 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.50913178 ms
avg iteration GPU training time:22.94161172 ms
avg iteration (step) total cpu time:178.25932936 ms
Epoch Time(s): 5.0544
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.5492 | Train Acc 0.8564 | Speed (samples/sec) 181166.4477 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.41680882 ms
avg iteration GPU training time:20.90888474 ms
avg iteration (step) total cpu time:232.27990757 ms
Epoch Time(s): 5.6872
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.5383 | Train Acc 0.8634 | Speed (samples/sec) 180822.4445 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:17.41896144 ms
avg iteration GPU training time:21.48118106 ms
avg iteration (step) total cpu time:201.38343898 ms
Epoch Time(s): 5.2521
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.5478 | Train Acc 0.8572 | Speed (samples/sec) 180707.2783 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.53331193 ms
avg iteration GPU training time:21.74840736 ms
avg iteration (step) total cpu time:182.22756819 ms
Epoch Time(s): 5.1248
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.5460 | Train Acc 0.8557 | Speed (samples/sec) 180586.3496 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

[2021-06-10 21:47:00,999] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 21:47:00,999] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=4955.086912567275
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.45736729 ms
avg iteration GPU training time:21.11660819 ms
avg iteration (step) total cpu time:205.83785664 ms
Epoch Time(s): 5.3609
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.5542 | Train Acc 0.8519 | Speed (samples/sec) 180877.5223 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:14.72252811 ms
avg iteration GPU training time:20.99541525 ms
avg iteration (step) total cpu time:188.55266138 ms
Epoch Time(s): 5.1020
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.5607 | Train Acc 0.8557 | Speed (samples/sec) 180974.9786 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.14378756 ms
avg iteration GPU training time:22.08880858 ms
avg iteration (step) total cpu time:182.60385773 ms
Epoch Time(s): 5.1389
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.5376 | Train Acc 0.8588 | Speed (samples/sec) 181046.4864 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:14.70149812 ms
avg iteration GPU training time:20.61598292 ms
avg iteration (step) total cpu time:173.13905196 ms
Epoch Time(s): 5.0517
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.5375 | Train Acc 0.8569 | Speed (samples/sec) 181427.9880 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.86515765 ms
avg iteration GPU training time:21.19777749 ms
avg iteration (step) total cpu time:188.65520304 ms
Epoch Time(s): 5.1899
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.5335 | Train Acc 0.8604 | Speed (samples/sec) 181300.8672 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.31114448 ms
avg iteration GPU training time:21.10827065 ms
avg iteration (step) total cpu time:213.40344169 ms
Epoch Time(s): 5.4273
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.5291 | Train Acc 0.8580 | Speed (samples/sec) 181006.5503 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.48143708 ms
avg iteration GPU training time:20.93116778 ms
avg iteration (step) total cpu time:168.59405691 ms
Epoch Time(s): 4.9816
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.5319 | Train Acc 0.8590 | Speed (samples/sec) 181111.9489 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.96414549 ms
avg iteration GPU training time:21.85274748 ms
avg iteration (step) total cpu time:168.03026199 ms
Epoch Time(s): 4.9228
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.5294 | Train Acc 0.8586 | Speed (samples/sec) 181110.5877 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.08276064 ms
avg iteration GPU training time:21.52579793 ms
avg iteration (step) total cpu time:228.98791053 ms
Epoch Time(s): 5.9387
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.5402 | Train Acc 0.8591 | Speed (samples/sec) 181307.5915 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.51747764 ms
avg iteration GPU training time:21.97728885 ms
avg iteration (step) total cpu time:166.71930660 ms
Epoch Time(s): 5.0895
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.5433 | Train Acc 0.8619 | Speed (samples/sec) 181459.4738 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

[2021-06-10 21:47:52,988] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 21:47:52,988] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=4975.215984576608
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.26250761 ms
avg iteration GPU training time:20.83771636 ms
avg iteration (step) total cpu time:187.87444722 ms
Epoch Time(s): 5.1462
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.5243 | Train Acc 0.8625 | Speed (samples/sec) 181054.8354 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:17.84991698 ms
avg iteration GPU training time:21.77466202 ms
avg iteration (step) total cpu time:221.17987546 ms
Epoch Time(s): 5.5481
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.5225 | Train Acc 0.8617 | Speed (samples/sec) 180709.8733 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:18.00020079 ms
avg iteration GPU training time:21.03314920 ms
avg iteration (step) total cpu time:165.73630680 ms
Epoch Time(s): 5.0196
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.5318 | Train Acc 0.8613 | Speed (samples/sec) 180594.4549 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.70054089 ms
avg iteration GPU training time:21.36340661 ms
avg iteration (step) total cpu time:187.45610931 ms
Epoch Time(s): 5.2137
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.5345 | Train Acc 0.8584 | Speed (samples/sec) 180505.4084 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.34510534 ms
avg iteration GPU training time:21.20927117 ms
avg iteration (step) total cpu time:299.64553226 ms
Epoch Time(s): 6.7470
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.5291 | Train Acc 0.8591 | Speed (samples/sec) 180350.2705 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.58878847 ms
avg iteration GPU training time:21.37455108 ms
avg iteration (step) total cpu time:182.99362876 ms
Epoch Time(s): 5.2450
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.5148 | Train Acc 0.8653 | Speed (samples/sec) 180010.6210 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.43251497 ms
avg iteration GPU training time:20.63175843 ms
avg iteration (step) total cpu time:194.69115951 ms
Epoch Time(s): 5.1649
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.5120 | Train Acc 0.8639 | Speed (samples/sec) 180154.8605 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:17.16840995 ms
avg iteration GPU training time:21.46052413 ms
avg iteration (step) total cpu time:244.10588091 ms
Epoch Time(s): 5.9371
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.5114 | Train Acc 0.8638 | Speed (samples/sec) 179720.4408 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.75246265 ms
avg iteration GPU training time:20.65002476 ms
avg iteration (step) total cpu time:186.64477088 ms
Epoch Time(s): 5.1487
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.5341 | Train Acc 0.8616 | Speed (samples/sec) 179779.1289 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.39674499 ms
avg iteration GPU training time:21.18237651 ms
avg iteration (step) total cpu time:206.37614077 ms
Epoch Time(s): 5.3539
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.5444 | Train Acc 0.8542 | Speed (samples/sec) 179776.3500 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

[2021-06-10 21:48:47,996] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 21:48:47,996] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=4974.817651178157
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.15910131 ms
avg iteration GPU training time:21.79521457 ms
avg iteration (step) total cpu time:228.28236493 ms
Epoch Time(s): 5.6289
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.5400 | Train Acc 0.8574 | Speed (samples/sec) 179554.9805 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.64492226 ms
avg iteration GPU training time:21.41582558 ms
avg iteration (step) total cpu time:176.63749782 ms
Epoch Time(s): 5.1217
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.5306 | Train Acc 0.8600 | Speed (samples/sec) 179590.6339 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:14.58923912 ms
avg iteration GPU training time:21.18213827 ms
avg iteration (step) total cpu time:183.93291127 ms
Epoch Time(s): 5.2079
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.5055 | Train Acc 0.8669 | Speed (samples/sec) 179717.5679 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.53926104 ms
avg iteration GPU training time:20.78457000 ms
avg iteration (step) total cpu time:206.96867596 ms
Epoch Time(s): 5.3868
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4939 | Train Acc 0.8682 | Speed (samples/sec) 179771.5352 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:18.26571933 ms
avg iteration GPU training time:20.87171763 ms
avg iteration (step) total cpu time:179.64980819 ms
Epoch Time(s): 5.0317
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.5181 | Train Acc 0.8593 | Speed (samples/sec) 179834.5804 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.29018749 ms
avg iteration GPU training time:20.76348808 ms
avg iteration (step) total cpu time:224.41359000 ms
Epoch Time(s): 6.0407
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.5072 | Train Acc 0.8658 | Speed (samples/sec) 180041.1310 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.41326254 ms
avg iteration GPU training time:21.24995786 ms
avg iteration (step) total cpu time:212.33209697 ms
Epoch Time(s): 5.4601
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.5184 | Train Acc 0.8628 | Speed (samples/sec) 180055.5621 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.76105309 ms
avg iteration GPU training time:22.13025457 ms
avg iteration (step) total cpu time:188.54932352 ms
Epoch Time(s): 5.1932
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.5187 | Train Acc 0.8653 | Speed (samples/sec) 180051.4087 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.82799131 ms
avg iteration GPU training time:21.95735290 ms
avg iteration (step) total cpu time:178.31080610 ms
Epoch Time(s): 5.1065
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.5257 | Train Acc 0.8622 | Speed (samples/sec) 179899.1484 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.13883920 ms
avg iteration GPU training time:21.61596506 ms
avg iteration (step) total cpu time:204.99444008 ms
Epoch Time(s): 5.4223
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.5080 | Train Acc 0.8646 | Speed (samples/sec) 180023.0889 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

[2021-06-10 21:49:41,069] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 21:49:41,070] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=4974.833155291682
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:16.69305611 ms
avg iteration GPU training time:23.93924349 ms
avg iteration (step) total cpu time:174.46652326 ms
Epoch Time(s): 5.1021
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.5203 | Train Acc 0.8626 | Speed (samples/sec) 179913.7534 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62744140625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.65087890625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62548828125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898018836975098  GigaBytes

avg iteration(step) data from cpu to GPU time:15.45497608 ms
avg iteration GPU training time:21.66571028 ms
avg iteration (step) total cpu time:191.25158137 ms
Epoch Time(s): 5.3317
Eval Acc 0.8712
Test Acc: 0.6939
Avg epoch time(time.time()): 5343.7150319417315 ms
total avg iteration(step) data from cpu to GPU time:16.31637846 ms
total avg iteration GPU training time:21.50260357 ms
total avg iteration (step) total cpu time:195.08428342 ms
