[2021-06-12 17:09:24,247] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-12 17:09:27,924] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_serial.py --batch-size 12289 --deepspeed_config ds_config.json
[2021-06-12 17:09:28,821] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-12 17:09:28,821] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-12 17:09:28,821] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-12 17:09:28,821] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-12 17:09:28,821] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623517774.4402535
before load_ogb step Time(s): 0.0019
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.1796875, 'VmSize': 20395.00390625, 'VmHWM': 1164.89453125, 'VmRSS': 1164.89453125}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6501
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2834
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0012
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0789
-------------------------------------------------end of load ogb****************** step Time(s): 0.0019
finish constructing ogbn-products
load ogb-products time total: 2.0157785415649414
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0167
after inductive else step Time(s): 0.0001
after label step Time(s): 3.8435
after train_g.create_formats_() step Time(s): 1.7402
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-12 17:09:42,073] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-12 17:09:42,075] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-12 17:09:42,079] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-12 17:09:44,445] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-12 17:09:44,447] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-12 17:09:44,448] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-12 17:09:44,448] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-12 17:09:44,448] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-12 17:09:44,448] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7ef9e36a1898>
[2021-06-12 17:09:44,448] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 17:09:44,448] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-12 17:09:44,448] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-12 17:09:44,449] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-12 17:09:44,450] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-12 17:09:44,450] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-12 17:09:44,450] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-12 17:09:44,451] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68408203125GB

Max Memory Allocated 1.2875022888183594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.73876953125GB

Max Memory Allocated 1.2875022888183594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.42236328125GB

Max Memory Allocated 16.59387445449829  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.42236328125GB

Max Memory Allocated 16.59387445449829  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.43798828125GB

Max Memory Allocated 16.59387445449829  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7813 | Train Acc 0.0322 | Speed (samples/sec) nan | GPU 16992.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.39892578125GB

Max Memory Allocated 16.59387445449829  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.39892578125GB

Max Memory Allocated 16.59387445449829  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.42236328125GB

Max Memory Allocated 16.59387445449829  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.21142578125GB

Max Memory Allocated 16.656898975372314  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.20166015625GB

Max Memory Allocated 16.656898975372314  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.20361328125GB

Max Memory Allocated 16.656898975372314  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.16455078125GB

Max Memory Allocated 16.656898975372314  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.16455078125GB

Max Memory Allocated 16.656898975372314  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.18798828125GB

Max Memory Allocated 16.656898975372314  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09619140625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08447265625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.663872241973877  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07275390625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09619140625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08642578125GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.663872241973877  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07275390625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09619140625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08642578125GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.663872241973877  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04736328125GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04736328125GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07080078125GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09619140625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08642578125GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.663872241973877  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04736328125GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04736328125GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07080078125GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09619140625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08642578125GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.663872241973877  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07275390625GB

Max Memory Allocated 16.663872241973877  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09619140625GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08642578125GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.67153024673462  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07080078125GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09423828125GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08447265625GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08642578125GB

Max Memory Allocated 16.67153024673462  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04736328125GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04736328125GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07080078125GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09423828125GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08642578125GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.67153024673462  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07080078125GB

Max Memory Allocated 16.67153024673462  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.64697265625GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.64892578125GB

Max Memory Allocated 16.681345462799072  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60986328125GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60986328125GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.64892578125GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 16.681345462799072  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.61181640625GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.61181640625GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63525390625GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.64892578125GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 16.681345462799072  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.61181640625GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.61181640625GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63525390625GB

Max Memory Allocated 16.681345462799072  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes

avg iteration(step) data from cpu to GPU time:16.98484360 ms
avg iteration GPU training time:317.01377175 ms
avg iteration (step) total cpu time:348.76264225 ms
Epoch Time(s): 8.4440
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

Epoch 00001 | Step 00000 | Loss 3.3232 | Train Acc 0.2548 | Speed (samples/sec) 33078.4408 | GPU 17107.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54345703125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53369140625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53369140625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53369140625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54345703125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53369140625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54345703125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes

avg iteration(step) data from cpu to GPU time:15.25787345 ms
avg iteration GPU training time:318.39378773 ms
avg iteration (step) total cpu time:346.47419236 ms
Epoch Time(s): 7.9866
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

Epoch 00002 | Step 00000 | Loss 3.3477 | Train Acc 0.2555 | Speed (samples/sec) 33327.8160 | GPU 17107.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54345703125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54345703125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53369140625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54345703125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53369140625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49658203125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53369140625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52197265625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.54541015625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.53564453125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.53759765625GB

Max Memory Allocated 16.706465244293213  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.49853515625GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.52001953125GB

Max Memory Allocated 16.706465244293213  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

avg iteration(step) data from cpu to GPU time:18.53234889 ms
avg iteration GPU training time:319.96106789 ms
avg iteration (step) total cpu time:351.66031664 ms
Epoch Time(s): 8.2440
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42236328125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

Epoch 00003 | Step 00000 | Loss 2.9687 | Train Acc 0.2995 | Speed (samples/sec) 33285.7247 | GPU 17150.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43212890625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42236328125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43212890625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42236328125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43212890625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43212890625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42236328125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43212890625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42236328125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43212890625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43212890625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42236328125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

avg iteration(step) data from cpu to GPU time:16.26463144 ms
avg iteration GPU training time:317.69805076 ms
avg iteration (step) total cpu time:347.21389684 ms
Epoch Time(s): 8.2424
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43212890625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42236328125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

Epoch 00004 | Step 00000 | Loss 2.9344 | Train Acc 0.3223 | Speed (samples/sec) 33136.5023 | GPU 17150.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38525390625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.40869140625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42236328125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

avg iteration(step) data from cpu to GPU time:16.44451792 ms
avg iteration GPU training time:305.20579390 ms
avg iteration (step) total cpu time:334.89602262 ms
Epoch Time(s): 7.6800
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43798828125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

Epoch 00005 | Step 00000 | Loss 2.3617 | Train Acc 0.3944 | Speed (samples/sec) 33436.2738 | GPU 17150.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

avg iteration(step) data from cpu to GPU time:16.63981672 ms
avg iteration GPU training time:311.64542736 ms
avg iteration (step) total cpu time:346.84022990 ms
Epoch Time(s): 7.9861
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

Epoch 00006 | Step 00000 | Loss 2.1802 | Train Acc 0.4349 | Speed (samples/sec) 33465.0555 | GPU 17150.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

avg iteration(step) data from cpu to GPU time:16.71953999 ms
avg iteration GPU training time:315.88368364 ms
avg iteration (step) total cpu time:345.73968974 ms
Epoch Time(s): 7.7228
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

Epoch 00007 | Step 00000 | Loss 1.9009 | Train Acc 0.4835 | Speed (samples/sec) 33518.6232 | GPU 17150.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

avg iteration(step) data from cpu to GPU time:16.84291467 ms
avg iteration GPU training time:311.63285966 ms
avg iteration (step) total cpu time:342.04966372 ms
Epoch Time(s): 7.6769
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

Epoch 00008 | Step 00000 | Loss 1.7226 | Train Acc 0.5265 | Speed (samples/sec) 33593.9642 | GPU 17150.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

avg iteration(step) data from cpu to GPU time:15.71898183 ms
avg iteration GPU training time:308.84523704 ms
avg iteration (step) total cpu time:338.38733760 ms
Epoch Time(s): 7.6196
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

Epoch 00009 | Step 00000 | Loss 1.6009 | Train Acc 0.5651 | Speed (samples/sec) 33687.0789 | GPU 17150.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43408203125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

[2021-06-12 17:11:03,786] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-12 17:11:03,786] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=2533.633882712348
-----------------------------------------after batch engine step
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

avg iteration(step) data from cpu to GPU time:17.11123484 ms
avg iteration GPU training time:310.78624656 ms
avg iteration (step) total cpu time:342.75759350 ms
Epoch Time(s): 7.7309
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42431640625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes

Epoch 00010 | Step 00000 | Loss 1.4680 | Train Acc 0.6058 | Speed (samples/sec) 33688.3744 | GPU 17150.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41259765625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42822265625GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38916015625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.43603515625GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.42626953125GB

Max Memory Allocated 16.748676776885986  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.38720703125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.41064453125GB

Max Memory Allocated 16.748676776885986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.49853515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.49072265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.49072265625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.45166015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.45166015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.47509765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.62939453125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.62939453125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.65087890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.67431640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.62744140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.62744140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.65087890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.53564453125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.53564453125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.49658203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.49658203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.51806640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.53173828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.53369140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.49462890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.49462890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.51806640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.53369140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.53369140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.49462890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.49462890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.51806640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.53369140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.53369140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.49462890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.49462890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.51806640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.28550399 ms
avg iteration GPU training time:351.05174117 ms
avg iteration (step) total cpu time:381.75992532 ms
Epoch Time(s): 8.1119
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40087890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00011 | Step 00000 | Loss 1.3758 | Train Acc 0.6371 | Speed (samples/sec) 33568.0044 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38720703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38720703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41064453125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38720703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38720703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41064453125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38720703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38720703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41064453125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40087890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38720703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36376953125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38720703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.09175292 ms
avg iteration GPU training time:304.57166915 ms
avg iteration (step) total cpu time:334.18150382 ms
Epoch Time(s): 7.6837
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38720703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00012 | Step 00000 | Loss 1.2586 | Train Acc 0.6668 | Speed (samples/sec) 33626.3918 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38720703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.82668790 ms
avg iteration GPU training time:318.05781139 ms
avg iteration (step) total cpu time:347.92824225 ms
Epoch Time(s): 7.8878
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00013 | Step 00000 | Loss 1.1722 | Train Acc 0.6851 | Speed (samples/sec) 33586.3415 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.17780365 ms
avg iteration GPU training time:317.74110829 ms
avg iteration (step) total cpu time:348.68181836 ms
Epoch Time(s): 7.9470
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00014 | Step 00000 | Loss 1.1390 | Train Acc 0.6995 | Speed (samples/sec) 33524.6809 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.67416156 ms
avg iteration GPU training time:314.70842951 ms
avg iteration (step) total cpu time:346.05936571 ms
Epoch Time(s): 7.7745
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00015 | Step 00000 | Loss 1.0589 | Train Acc 0.7248 | Speed (samples/sec) 33529.4983 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.51925529 ms
avg iteration GPU training time:314.75893055 ms
avg iteration (step) total cpu time:343.18119829 ms
Epoch Time(s): 7.7811
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.9920 | Train Acc 0.7386 | Speed (samples/sec) 33549.6868 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40283203125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41259765625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36572265625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.38916015625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.79895254 ms
avg iteration GPU training time:319.13841109 ms
avg iteration (step) total cpu time:349.30339727 ms
Epoch Time(s): 7.8714
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.9539 | Train Acc 0.7547 | Speed (samples/sec) 33533.8039 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.08017150 ms
avg iteration GPU training time:321.25213068 ms
avg iteration (step) total cpu time:352.10043734 ms
Epoch Time(s): 7.8180
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.9157 | Train Acc 0.7682 | Speed (samples/sec) 33518.8946 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.56292092 ms
avg iteration GPU training time:321.96203058 ms
avg iteration (step) total cpu time:353.49867561 ms
Epoch Time(s): 7.8559
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.8727 | Train Acc 0.7822 | Speed (samples/sec) 33492.5644 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

[2021-06-12 17:12:22,409] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 17:12:22,409] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=2531.5871734344387
-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.97404809 ms
avg iteration GPU training time:312.65120628 ms
avg iteration (step) total cpu time:347.13283452 ms
Epoch Time(s): 7.8911
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.8553 | Train Acc 0.7831 | Speed (samples/sec) 33470.9366 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.75769919 ms
avg iteration GPU training time:312.88449652 ms
avg iteration (step) total cpu time:343.23891726 ms
Epoch Time(s): 7.7155
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.7951 | Train Acc 0.8094 | Speed (samples/sec) 33488.1612 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.48396813 ms
avg iteration GPU training time:316.01035656 ms
avg iteration (step) total cpu time:345.98474069 ms
Epoch Time(s): 7.8325
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.7797 | Train Acc 0.8087 | Speed (samples/sec) 33485.6366 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.72038685 ms
avg iteration GPU training time:317.67691317 ms
avg iteration (step) total cpu time:348.67791696 ms
Epoch Time(s): 7.8312
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.7302 | Train Acc 0.8284 | Speed (samples/sec) 33466.2237 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.28717379 ms
avg iteration GPU training time:319.36924605 ms
avg iteration (step) total cpu time:349.67333620 ms
Epoch Time(s): 7.8874
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.6939 | Train Acc 0.8292 | Speed (samples/sec) 33442.0629 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:19.31572099 ms
avg iteration GPU training time:323.64057506 ms
avg iteration (step) total cpu time:356.38488423 ms
Epoch Time(s): 7.9361
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.6742 | Train Acc 0.8408 | Speed (samples/sec) 33396.3471 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:18.27944721 ms
avg iteration GPU training time:330.51215709 ms
avg iteration (step) total cpu time:362.00059544 ms
Epoch Time(s): 7.9962
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.6292 | Train Acc 0.8573 | Speed (samples/sec) 33348.7145 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.34933229 ms
avg iteration GPU training time:323.78902921 ms
avg iteration (step) total cpu time:353.29391740 ms
Epoch Time(s): 7.9116
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.6239 | Train Acc 0.8593 | Speed (samples/sec) 33332.3402 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.80208882 ms
avg iteration GPU training time:314.40786743 ms
avg iteration (step) total cpu time:345.72705356 ms
Epoch Time(s): 7.8231
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.6037 | Train Acc 0.8576 | Speed (samples/sec) 33333.8617 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.75461232 ms
avg iteration GPU training time:304.26746993 ms
avg iteration (step) total cpu time:332.98045939 ms
Epoch Time(s): 7.7514
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.5777 | Train Acc 0.8641 | Speed (samples/sec) 33351.6037 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

[2021-06-12 17:13:40,872] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 17:13:40,872] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=2538.617673941748
-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:18.48771208 ms
avg iteration GPU training time:312.69241610 ms
avg iteration (step) total cpu time:346.07867761 ms
Epoch Time(s): 7.7770
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.5939 | Train Acc 0.8662 | Speed (samples/sec) 33360.1583 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.96633296 ms
avg iteration GPU training time:309.47805786 ms
avg iteration (step) total cpu time:341.08614922 ms
Epoch Time(s): 7.7927
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.5783 | Train Acc 0.8674 | Speed (samples/sec) 33369.2059 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.04966129 ms
avg iteration GPU training time:313.66481434 ms
avg iteration (step) total cpu time:343.79974279 ms
Epoch Time(s): 7.7035
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.5474 | Train Acc 0.8763 | Speed (samples/sec) 33378.1778 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.92998071 ms
avg iteration GPU training time:320.92393910 ms
avg iteration (step) total cpu time:356.21385141 ms
Epoch Time(s): 8.1106
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.5368 | Train Acc 0.8777 | Speed (samples/sec) 33340.9521 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.25539780 ms
avg iteration GPU training time:309.51893754 ms
avg iteration (step) total cpu time:339.03139288 ms
Epoch Time(s): 7.7267
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.5269 | Train Acc 0.8750 | Speed (samples/sec) 33356.4826 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.75662249 ms
avg iteration GPU training time:318.48594804 ms
avg iteration (step) total cpu time:350.02493858 ms
Epoch Time(s): 7.7987
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.4987 | Train Acc 0.8858 | Speed (samples/sec) 33352.3358 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.98683929 ms
avg iteration GPU training time:310.02254139 ms
avg iteration (step) total cpu time:342.55506776 ms
Epoch Time(s): 7.8583
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.4786 | Train Acc 0.8895 | Speed (samples/sec) 33353.0047 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:19.17966227 ms
avg iteration GPU training time:323.02506048 ms
avg iteration (step) total cpu time:355.15453599 ms
Epoch Time(s): 7.9813
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.4832 | Train Acc 0.8865 | Speed (samples/sec) 33330.5297 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.94420971 ms
avg iteration GPU training time:319.14152111 ms
avg iteration (step) total cpu time:348.79034216 ms
Epoch Time(s): 7.8456
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.4782 | Train Acc 0.8849 | Speed (samples/sec) 33332.4166 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.91346923 ms
avg iteration GPU training time:317.08675870 ms
avg iteration (step) total cpu time:346.58728946 ms
Epoch Time(s): 8.0490
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.4784 | Train Acc 0.8855 | Speed (samples/sec) 33311.3734 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

[2021-06-12 17:14:59,548] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 17:14:59,549] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=2521.892949079689
-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.44744743 ms
avg iteration GPU training time:310.83663108 ms
avg iteration (step) total cpu time:340.96043760 ms
Epoch Time(s): 7.8091
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.4787 | Train Acc 0.8840 | Speed (samples/sec) 33314.4089 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:18.39553157 ms
avg iteration GPU training time:314.15250466 ms
avg iteration (step) total cpu time:345.88599205 ms
Epoch Time(s): 7.9068
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.4869 | Train Acc 0.8792 | Speed (samples/sec) 33312.8436 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.70741246 ms
avg iteration GPU training time:317.75686923 ms
avg iteration (step) total cpu time:349.71909090 ms
Epoch Time(s): 8.0653
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.4987 | Train Acc 0.8777 | Speed (samples/sec) 33294.9803 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.24976288 ms
avg iteration GPU training time:311.48001931 ms
avg iteration (step) total cpu time:341.69695594 ms
Epoch Time(s): 7.7679
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.5562 | Train Acc 0.8593 | Speed (samples/sec) 33306.2603 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:18.41676209 ms
avg iteration GPU training time:305.66637074 ms
avg iteration (step) total cpu time:337.01701598 ms
Epoch Time(s): 7.6925
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.5260 | Train Acc 0.8696 | Speed (samples/sec) 33325.0189 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.92688864 ms
avg iteration GPU training time:318.72615745 ms
avg iteration (step) total cpu time:347.33252092 ms
Epoch Time(s): 7.8272
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.5239 | Train Acc 0.8692 | Speed (samples/sec) 33331.4986 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.61461535 ms
avg iteration GPU training time:313.30530617 ms
avg iteration (step) total cpu time:342.57789092 ms
Epoch Time(s): 7.7197
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.5021 | Train Acc 0.8827 | Speed (samples/sec) 33341.6241 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.94136750 ms
avg iteration GPU training time:311.11307872 ms
avg iteration (step) total cpu time:341.07466178 ms
Epoch Time(s): 7.7786
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.4774 | Train Acc 0.8800 | Speed (samples/sec) 33350.1209 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.34388065 ms
avg iteration GPU training time:308.88084273 ms
avg iteration (step) total cpu time:340.05563909 ms
Epoch Time(s): 7.6231
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.4615 | Train Acc 0.8849 | Speed (samples/sec) 33367.5391 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41845703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:18.04869808 ms
avg iteration GPU training time:311.94801469 ms
avg iteration (step) total cpu time:347.89549221 ms
Epoch Time(s): 7.8724
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.4630 | Train Acc 0.8868 | Speed (samples/sec) 33366.2796 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

[2021-06-12 17:16:17,672] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 17:16:17,672] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=2528.1217801208654
-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.60578632 ms
avg iteration GPU training time:317.80430464 ms
avg iteration (step) total cpu time:355.88661107 ms
Epoch Time(s): 7.8691
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.4498 | Train Acc 0.8900 | Speed (samples/sec) 33355.3249 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.06737432 ms
avg iteration GPU training time:309.39575750 ms
avg iteration (step) total cpu time:345.86962787 ms
Epoch Time(s): 7.8646
Eval Acc 0.8898
Test Acc: 0.7265
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.4317 | Train Acc 0.8939 | Speed (samples/sec) 33360.7799 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.49117964 ms
avg iteration GPU training time:327.63750111 ms
avg iteration (step) total cpu time:358.59411413 ms
Epoch Time(s): 8.0281
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.4240 | Train Acc 0.8949 | Speed (samples/sec) 33335.6863 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.99315496 ms
avg iteration GPU training time:321.59990623 ms
avg iteration (step) total cpu time:351.96620768 ms
Epoch Time(s): 7.9319
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.4201 | Train Acc 0.8958 | Speed (samples/sec) 33320.1134 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.78304273 ms
avg iteration GPU training time:348.67083463 ms
avg iteration (step) total cpu time:378.10860981 ms
Epoch Time(s): 8.1842
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.4298 | Train Acc 0.8953 | Speed (samples/sec) 33284.4838 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.62680184 ms
avg iteration GPU training time:327.19492964 ms
avg iteration (step) total cpu time:358.35480690 ms
Epoch Time(s): 8.0710
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.4427 | Train Acc 0.8883 | Speed (samples/sec) 33264.3735 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.55003348 ms
avg iteration GPU training time:328.17997048 ms
avg iteration (step) total cpu time:359.08826915 ms
Epoch Time(s): 7.9749
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.4149 | Train Acc 0.8942 | Speed (samples/sec) 33245.7121 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.29209891 ms
avg iteration GPU training time:317.75756004 ms
avg iteration (step) total cpu time:347.06703099 ms
Epoch Time(s): 7.9647
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.3987 | Train Acc 0.8985 | Speed (samples/sec) 33242.5687 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.25242771 ms
avg iteration GPU training time:315.41910900 ms
avg iteration (step) total cpu time:345.20747445 ms
Epoch Time(s): 7.9424
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.4222 | Train Acc 0.8920 | Speed (samples/sec) 33236.9902 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.08462542 ms
avg iteration GPU training time:310.71579257 ms
avg iteration (step) total cpu time:343.17010099 ms
Epoch Time(s): 7.8292
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.3996 | Train Acc 0.8976 | Speed (samples/sec) 33243.8565 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

[2021-06-12 17:18:28,763] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 17:18:28,763] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=2515.9927901033952
-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.33260215 ms
avg iteration GPU training time:308.83600408 ms
avg iteration (step) total cpu time:343.85416724 ms
Epoch Time(s): 7.6942
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.3844 | Train Acc 0.9045 | Speed (samples/sec) 33258.4079 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.77518550 ms
avg iteration GPU training time:307.62540228 ms
avg iteration (step) total cpu time:337.06049486 ms
Epoch Time(s): 7.6310
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.4091 | Train Acc 0.8962 | Speed (samples/sec) 33277.2727 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41845703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:18.38984117 ms
avg iteration GPU training time:319.72588279 ms
avg iteration (step) total cpu time:350.98999197 ms
Epoch Time(s): 7.7975
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.4066 | Train Acc 0.8963 | Speed (samples/sec) 33279.6721 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.25028931 ms
avg iteration GPU training time:313.89493353 ms
avg iteration (step) total cpu time:347.11417285 ms
Epoch Time(s): 7.8030
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.3932 | Train Acc 0.9002 | Speed (samples/sec) 33279.5679 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.40348226 ms
avg iteration GPU training time:308.90022139 ms
avg iteration (step) total cpu time:338.52934837 ms
Epoch Time(s): 7.7491
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.3988 | Train Acc 0.8980 | Speed (samples/sec) 33287.3823 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.95638371 ms
avg iteration GPU training time:306.79685558 ms
avg iteration (step) total cpu time:345.61408650 ms
Epoch Time(s): 7.7507
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.4071 | Train Acc 0.8941 | Speed (samples/sec) 33291.9911 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.19197958 ms
avg iteration GPU training time:312.37391801 ms
avg iteration (step) total cpu time:341.43426202 ms
Epoch Time(s): 7.7518
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.3758 | Train Acc 0.9038 | Speed (samples/sec) 33299.0342 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:14.93048434 ms
avg iteration GPU training time:343.09464888 ms
avg iteration (step) total cpu time:372.06563083 ms
Epoch Time(s): 8.1412
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.3700 | Train Acc 0.9054 | Speed (samples/sec) 33269.7142 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.32915185 ms
avg iteration GPU training time:341.41656217 ms
avg iteration (step) total cpu time:370.50550634 ms
Epoch Time(s): 8.2181
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.3739 | Train Acc 0.9035 | Speed (samples/sec) 33240.7590 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.06851777 ms
avg iteration GPU training time:332.01480935 ms
avg iteration (step) total cpu time:361.29294742 ms
Epoch Time(s): 8.1392
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.3801 | Train Acc 0.9036 | Speed (samples/sec) 33221.7673 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

[2021-06-12 17:19:47,554] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 17:19:47,555] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=2527.957748889472
-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:18.73460371 ms
avg iteration GPU training time:310.31595126 ms
avg iteration (step) total cpu time:342.28966453 ms
Epoch Time(s): 7.8092
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.3731 | Train Acc 0.9059 | Speed (samples/sec) 33230.0722 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:14.89330621 ms
avg iteration GPU training time:328.67446622 ms
avg iteration (step) total cpu time:356.56274449 ms
Epoch Time(s): 8.0699
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.3662 | Train Acc 0.9072 | Speed (samples/sec) 33220.6967 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.41818749 ms
avg iteration GPU training time:317.36297330 ms
avg iteration (step) total cpu time:346.89229185 ms
Epoch Time(s): 8.0252
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.3770 | Train Acc 0.9065 | Speed (samples/sec) 33213.6628 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.27496737 ms
avg iteration GPU training time:318.08236694 ms
avg iteration (step) total cpu time:350.53209825 ms
Epoch Time(s): 7.8953
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.3563 | Train Acc 0.9092 | Speed (samples/sec) 33216.6227 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.63394902 ms
avg iteration GPU training time:322.14886197 ms
avg iteration (step) total cpu time:351.99806907 ms
Epoch Time(s): 7.9956
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.3534 | Train Acc 0.9072 | Speed (samples/sec) 33210.7710 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.31845830 ms
avg iteration GPU training time:323.43414862 ms
avg iteration (step) total cpu time:352.96370766 ms
Epoch Time(s): 8.0677
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.3685 | Train Acc 0.9041 | Speed (samples/sec) 33208.6152 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.82613564 ms
avg iteration GPU training time:321.20999700 ms
avg iteration (step) total cpu time:356.16482388 ms
Epoch Time(s): 8.2090
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.3564 | Train Acc 0.9086 | Speed (samples/sec) 33196.8649 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.45472006 ms
avg iteration GPU training time:316.95122736 ms
avg iteration (step) total cpu time:347.01056914 ms
Epoch Time(s): 7.8421
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.3596 | Train Acc 0.9077 | Speed (samples/sec) 33203.4045 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.27990983 ms
avg iteration GPU training time:322.19033536 ms
avg iteration (step) total cpu time:352.71657597 ms
Epoch Time(s): 7.9857
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.3674 | Train Acc 0.9048 | Speed (samples/sec) 33202.9070 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.54765103 ms
avg iteration GPU training time:307.10851496 ms
avg iteration (step) total cpu time:338.26078068 ms
Epoch Time(s): 7.9229
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.3532 | Train Acc 0.9086 | Speed (samples/sec) 33210.2595 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

[2021-06-12 17:21:07,597] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 17:21:07,598] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=2536.9692769479725
-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.95744879 ms
avg iteration GPU training time:319.53439054 ms
avg iteration (step) total cpu time:349.86363758 ms
Epoch Time(s): 8.0286
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.3532 | Train Acc 0.9080 | Speed (samples/sec) 33205.9781 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.59961007 ms
avg iteration GPU training time:314.86670199 ms
avg iteration (step) total cpu time:344.20912916 ms
Epoch Time(s): 7.9016
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.3620 | Train Acc 0.9068 | Speed (samples/sec) 33215.5515 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.71995336 ms
avg iteration GPU training time:311.83008090 ms
avg iteration (step) total cpu time:340.99052169 ms
Epoch Time(s): 7.8894
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.3558 | Train Acc 0.9040 | Speed (samples/sec) 33219.6220 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.57654979 ms
avg iteration GPU training time:300.96152566 ms
avg iteration (step) total cpu time:334.86996997 ms
Epoch Time(s): 7.6907
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.4003 | Train Acc 0.8942 | Speed (samples/sec) 33236.2626 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.79331493 ms
avg iteration GPU training time:331.42006337 ms
avg iteration (step) total cpu time:361.66414348 ms
Epoch Time(s): 8.1424
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.3808 | Train Acc 0.8989 | Speed (samples/sec) 33221.4555 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.66789818 ms
avg iteration GPU training time:314.00335693 ms
avg iteration (step) total cpu time:343.54567528 ms
Epoch Time(s): 7.9594
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41845703125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.3572 | Train Acc 0.9057 | Speed (samples/sec) 33225.4272 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.64852680 ms
avg iteration GPU training time:321.01478993 ms
avg iteration (step) total cpu time:349.61271286 ms
Epoch Time(s): 7.8808
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.3806 | Train Acc 0.8976 | Speed (samples/sec) 33228.6038 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.60725550 ms
avg iteration GPU training time:321.22723666 ms
avg iteration (step) total cpu time:351.56670484 ms
Epoch Time(s): 8.0375
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.3740 | Train Acc 0.9039 | Speed (samples/sec) 33220.7042 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.98516083 ms
avg iteration GPU training time:322.79074652 ms
avg iteration (step) total cpu time:353.24215889 ms
Epoch Time(s): 8.0181
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.3739 | Train Acc 0.9016 | Speed (samples/sec) 33214.5974 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.41533678 ms
avg iteration GPU training time:308.98142034 ms
avg iteration (step) total cpu time:338.14699000 ms
Epoch Time(s): 7.9819
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.3490 | Train Acc 0.9058 | Speed (samples/sec) 33220.5696 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

[2021-06-12 17:22:27,242] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 17:22:27,242] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=2533.4755110656056
-----------------------------------------after batch engine step
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.14721177 ms
avg iteration GPU training time:330.70415150 ms
avg iteration (step) total cpu time:363.11405355 ms
Epoch Time(s): 8.1419
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.3589 | Train Acc 0.9030 | Speed (samples/sec) 33209.9224 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.31515356 ms
avg iteration GPU training time:318.85745794 ms
avg iteration (step) total cpu time:347.87182374 ms
Epoch Time(s): 8.0633
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.3404 | Train Acc 0.9098 | Speed (samples/sec) 33205.4176 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.72602784 ms
avg iteration GPU training time:305.69420277 ms
avg iteration (step) total cpu time:349.87798604 ms
Epoch Time(s): 7.8203
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.3631 | Train Acc 0.9052 | Speed (samples/sec) 33215.2528 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:18.38511120 ms
avg iteration GPU training time:302.02483853 ms
avg iteration (step) total cpu time:333.81087130 ms
Epoch Time(s): 7.5922
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.3483 | Train Acc 0.9081 | Speed (samples/sec) 33229.9083 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.84072408 ms
avg iteration GPU training time:303.88328691 ms
avg iteration (step) total cpu time:335.03348177 ms
Epoch Time(s): 8.1391
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.3439 | Train Acc 0.9091 | Speed (samples/sec) 33233.1438 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.84706298 ms
avg iteration GPU training time:308.17342862 ms
avg iteration (step) total cpu time:341.73880924 ms
Epoch Time(s): 7.8121
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.3348 | Train Acc 0.9126 | Speed (samples/sec) 33238.3440 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.52235066 ms
avg iteration GPU training time:310.86850253 ms
avg iteration (step) total cpu time:340.34334530 ms
Epoch Time(s): 7.8419
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.3358 | Train Acc 0.9126 | Speed (samples/sec) 33244.1504 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:15.33741960 ms
avg iteration GPU training time:311.02177013 ms
avg iteration (step) total cpu time:339.51113441 ms
Epoch Time(s): 7.6530
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.3312 | Train Acc 0.9108 | Speed (samples/sec) 33257.5529 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.31078131 ms
avg iteration GPU training time:333.02821766 ms
avg iteration (step) total cpu time:365.25633118 ms
Epoch Time(s): 7.9892
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.3240 | Train Acc 0.9111 | Speed (samples/sec) 33246.2070 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.74470693 ms
avg iteration GPU training time:309.92773438 ms
avg iteration (step) total cpu time:340.12447704 ms
Epoch Time(s): 7.7385
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.3363 | Train Acc 0.9123 | Speed (samples/sec) 33250.1982 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

[2021-06-12 17:23:45,858] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 17:23:45,858] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=2537.1072872879613
-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:17.37610184 ms
avg iteration GPU training time:320.01007080 ms
avg iteration (step) total cpu time:353.92091491 ms
Epoch Time(s): 7.9658
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.3289 | Train Acc 0.9130 | Speed (samples/sec) 33243.6227 | GPU 17158.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41455078125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40478515625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36962890625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39306640625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.36767578125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.39111328125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.41650390625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.40673828125GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.40869140625GB

Max Memory Allocated 16.7564754486084  GigaBytes

avg iteration(step) data from cpu to GPU time:16.95167992 ms
avg iteration GPU training time:309.52925803 ms
avg iteration (step) total cpu time:341.07921340 ms
Epoch Time(s): 7.7813
Eval Acc 0.9078
Test Acc: 0.7550
Avg epoch time(time.time()): 7885.1764301459 ms
total avg iteration(step) data from cpu to GPU time:16.79259766 ms
total avg iteration GPU training time:316.93376510 ms
total avg iteration (step) total cpu time:348.08581547 ms
