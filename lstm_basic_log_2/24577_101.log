[2021-06-12 22:27:36,946] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-12 22:27:40,621] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 24577 --deepspeed_config ds_config.json
[2021-06-12 22:27:41,604] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-12 22:27:41,604] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-12 22:27:41,604] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-12 22:27:41,604] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-12 22:27:41,604] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623536867.1917021
before load_ogb step Time(s): 0.0019
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.171875, 'VmSize': 20395.0234375, 'VmHWM': 1164.75, 'VmRSS': 1164.75}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.4703
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2834
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0012
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.1213
-------------------------------------------------end of load ogb****************** step Time(s): 0.0048
finish constructing ogbn-products
load ogb-products time total: 1.8812384605407715
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 1.8822
after inductive else step Time(s): 0.0000
after label step Time(s): 3.9103
after train_g.create_formats_() step Time(s): 1.7026
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 24577
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-12 22:27:54,717] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-12 22:27:54,719] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-12 22:27:54,722] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-12 22:27:57,101] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-12 22:27:57,103] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-12 22:27:57,103] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-12 22:27:57,103] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-12 22:27:57,103] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-12 22:27:57,103] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7fd140162908>
[2021-06-12 22:27:57,103] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:27:57,103] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-12 22:27:57,103] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-12 22:27:57,103] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-12 22:27:57,103] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-12 22:27:57,103] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-12 22:27:57,104] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-12 22:27:57,105] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-12 22:27:57,105] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-12 22:27:57,105] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-12 22:27:57,105] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-12 22:27:57,105] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-12 22:27:57,105] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-12 22:27:57,105] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-12 22:27:57,106] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.78564453125GB

Max Memory Allocated 1.391092300415039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.85791015625GB

Max Memory Allocated 1.391092300415039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.16845703125GB

Max Memory Allocated 27.32128143310547  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.16845703125GB

Max Memory Allocated 27.32128143310547  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.19384765625GB

Max Memory Allocated 27.32128143310547  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.19384765625GB

Max Memory Allocated 27.32128143310547  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7964 | Train Acc 0.0308 | Speed (samples/sec) nan | GPU 27977.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.13134765625GB

Max Memory Allocated 27.32128143310547  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.13134765625GB

Max Memory Allocated 27.32128143310547  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.17041015625GB

Max Memory Allocated 27.32128143310547  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83056640625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83056640625GB

Max Memory Allocated 27.403603553771973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.76806640625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.76806640625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.80712890625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83056640625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83056640625GB

Max Memory Allocated 27.403603553771973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.76611328125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.76611328125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.80517578125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83056640625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83056640625GB

Max Memory Allocated 27.403603553771973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.76611328125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.76611328125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.80517578125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84423828125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82861328125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82861328125GB

Max Memory Allocated 27.403603553771973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.76611328125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.76611328125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.80517578125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.31298828125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.29736328125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.29736328125GB

Max Memory Allocated 27.403603553771973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.27392578125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32080078125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.29345703125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.403603553771973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.31884765625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.29541015625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.403603553771973  GigaBytes

avg iteration(step) data from cpu to GPU time:29.71861331 ms
avg iteration GPU training time:416.77940877 ms
avg iteration (step) total cpu time:464.98179436 ms
Epoch Time(s): 7.8686
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.31689453125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.29150390625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.403603553771973  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.7345 | Train Acc 0.5182 | Speed (samples/sec) 45485.7866 | GPU 28061.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.31689453125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.29345703125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.403603553771973  GigaBytes

[2021-06-12 22:28:08,767] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-12 22:28:08,880] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=3518.353769128893
-----------------------------------------after batch engine step
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.403603553771973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24072265625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24072265625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32080078125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.29345703125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.403603553771973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.403603553771973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.26806640625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.24267578125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.25244140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.25244140625GB

Max Memory Allocated 27.40965175628662  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.18994140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.18994140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.22900390625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.27197265625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.24462890625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.25439453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.25439453125GB

Max Memory Allocated 27.40965175628662  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.19189453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.19189453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.23095703125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.40965175628662  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.66064453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.66064453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.40965175628662  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.65869140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.65869140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

avg iteration(step) data from cpu to GPU time:29.79557355 ms
avg iteration GPU training time:430.62704468 ms
avg iteration (step) total cpu time:477.04672813 ms
Epoch Time(s): 7.7068
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.66064453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.66064453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

Epoch 00002 | Step 00000 | Loss 1.0166 | Train Acc 0.7352 | Speed (samples/sec) 43368.1626 | GPU 28067.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.65869140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.65869140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.40965175628662  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.65869140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.65869140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.40965175628662  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.65869140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.65869140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

[2021-06-12 22:28:17,212] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:28:17,324] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=3220.7018231005627
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.40965175628662  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.65869140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.65869140625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.40965175628662  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.66064453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.66064453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 27.40965175628662  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.66259765625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.66259765625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.70166015625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 27.40965175628662  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.66064453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.66064453125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.40965175628662  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.28759765625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.26220703125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.27197265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.27197265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

avg iteration(step) data from cpu to GPU time:35.13304456 ms
avg iteration GPU training time:650.72992961 ms
avg iteration (step) total cpu time:704.12882169 ms
Epoch Time(s): 7.5810
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.20947265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.20947265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.24853515625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.29150390625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.26416015625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.412738800048828  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.7261 | Train Acc 0.8269 | Speed (samples/sec) 42405.8519 | GPU 28070.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.21142578125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.21142578125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.25048828125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.29150390625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.26611328125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.27587890625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.27587890625GB

Max Memory Allocated 27.412738800048828  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.21337890625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.21337890625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.25244140625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.29150390625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.26416015625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.412738800048828  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.21142578125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.21142578125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.25048828125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.29150390625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.26611328125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.27587890625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.27587890625GB

Max Memory Allocated 27.412738800048828  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.21337890625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.21337890625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.25244140625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73291015625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.412738800048828  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71728515625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.412738800048828  GigaBytes

[2021-06-12 22:28:25,560] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:28:25,673] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=3162.118559219701
-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.412738800048828  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71728515625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75634765625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.412738800048828  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71728515625GB

Max Memory Allocated 27.412738800048828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73291015625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

avg iteration(step) data from cpu to GPU time:36.69565964 ms
avg iteration GPU training time:410.80209351 ms
avg iteration (step) total cpu time:464.28394318 ms
Epoch Time(s): 6.6125
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73291015625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.5750 | Train Acc 0.8685 | Speed (samples/sec) 43698.4426 | GPU 28094.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71728515625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.436318397521973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71728515625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes

[2021-06-12 22:28:33,336] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:28:33,448] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=3243.2845042705953
-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.436318397521973  GigaBytes

avg iteration(step) data from cpu to GPU time:32.90705045 ms
avg iteration GPU training time:455.63867188 ms
avg iteration (step) total cpu time:508.95992915 ms
Epoch Time(s): 6.8787
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.436318397521973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.4931 | Train Acc 0.8817 | Speed (samples/sec) 44062.8110 | GPU 28108.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.44968891143799  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.44968891143799  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

avg iteration(step) data from cpu to GPU time:27.81612778 ms
avg iteration GPU training time:413.33662923 ms
avg iteration (step) total cpu time:456.14274343 ms
Epoch Time(s): 6.6424
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.44968891143799  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.4554 | Train Acc 0.8864 | Speed (samples/sec) 44625.5375 | GPU 28108.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.44968891143799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

[2021-06-12 22:28:43,956] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:28:44,069] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=3304.9782025558734
-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73291015625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

avg iteration(step) data from cpu to GPU time:29.78288015 ms
avg iteration GPU training time:410.96976725 ms
avg iteration (step) total cpu time:455.69793383 ms
Epoch Time(s): 6.7664
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73291015625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.4208 | Train Acc 0.8930 | Speed (samples/sec) 45016.8097 | GPU 28111.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

[2021-06-12 22:28:51,761] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:28:51,873] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=3346.4767655501355
-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73291015625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

avg iteration(step) data from cpu to GPU time:29.09021823 ms
avg iteration GPU training time:418.52362061 ms
avg iteration (step) total cpu time:461.75161997 ms
Epoch Time(s): 6.8413
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73291015625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3913 | Train Acc 0.8996 | Speed (samples/sec) 45263.5845 | GPU 28111.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73291015625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68017578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67822265625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71728515625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

[2021-06-12 22:28:59,510] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:28:59,622] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=3358.78011511515
-----------------------------------------after batch engine step
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.452626705169678  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68212890625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.452626705169678  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.32275390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.29541015625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.30517578125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.30517578125GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.24072265625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.24072265625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.27978515625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.452913284301758  GigaBytes

avg iteration(step) data from cpu to GPU time:30.48308245 ms
avg iteration GPU training time:622.28764852 ms
avg iteration (step) total cpu time:672.00422287 ms
Epoch Time(s): 7.4132
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38720703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38720703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93212890625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90673828125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3845 | Train Acc 0.9015 | Speed (samples/sec) 44827.3746 | GPU 28111.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85205078125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85205078125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89111328125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93017578125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90673828125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91455078125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91455078125GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85205078125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85205078125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89111328125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93017578125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90478515625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91455078125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91455078125GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85205078125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85205078125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89111328125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93212890625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90673828125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89306640625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93212890625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90673828125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85205078125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85205078125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89111328125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93212890625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90673828125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89306640625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93408203125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90869140625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89306640625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93408203125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.91064453125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

[2021-06-12 22:29:07,869] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:29:07,982] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=3315.507016844306
-----------------------------------------after batch engine step
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

avg iteration(step) data from cpu to GPU time:30.70503426 ms
avg iteration GPU training time:424.25250244 ms
avg iteration (step) total cpu time:473.83443515 ms
Epoch Time(s): 6.8254
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89306640625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93408203125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90869140625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3633 | Train Acc 0.9040 | Speed (samples/sec) 44893.7946 | GPU 28111.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89306640625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93408203125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90869140625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85595703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85595703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89501953125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93603515625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90869140625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89306640625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93408203125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.91064453125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89306640625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93212890625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90673828125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89306640625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93212890625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90869140625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85595703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85595703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89501953125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93408203125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90673828125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91650390625GB

Max Memory Allocated 27.452913284301758  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85400390625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89306640625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.93408203125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.90869140625GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

avg iteration(step) data from cpu to GPU time:26.92897034 ms
avg iteration GPU training time:406.91554769 ms
avg iteration (step) total cpu time:451.63480441 ms
Epoch Time(s): 6.5889
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.85595703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.85595703125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.89501953125GB

Max Memory Allocated 27.452913284301758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62353515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.464609622955322  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3579 | Train Acc 0.9065 | Speed (samples/sec) 44966.8835 | GPU 28123.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.60791015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

[2021-06-12 22:29:19,014] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:29:19,128] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=3285.0050466961798
-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

avg iteration(step) data from cpu to GPU time:28.21729088 ms
avg iteration GPU training time:408.69242350 ms
avg iteration (step) total cpu time:451.59808795 ms
Epoch Time(s): 7.3676
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3636 | Train Acc 0.9055 | Speed (samples/sec) 45043.4528 | GPU 28123.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

[2021-06-12 22:29:26,827] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:29:26,940] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=3309.879568976495
-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

avg iteration(step) data from cpu to GPU time:31.80385017 ms
avg iteration GPU training time:422.12246704 ms
avg iteration (step) total cpu time:472.54681587 ms
Epoch Time(s): 6.9320
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3419 | Train Acc 0.9111 | Speed (samples/sec) 45202.5651 | GPU 28123.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

[2021-06-12 22:29:34,627] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:29:34,740] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=3328.0492134013525
-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

avg iteration(step) data from cpu to GPU time:29.03611692 ms
avg iteration GPU training time:410.02526855 ms
avg iteration (step) total cpu time:457.35406876 ms
Epoch Time(s): 6.7945
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3342 | Train Acc 0.9102 | Speed (samples/sec) 45324.1075 | GPU 28123.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

[2021-06-12 22:29:42,096] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:29:42,209] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=3348.4893750885367
-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

avg iteration(step) data from cpu to GPU time:32.53742917 ms
avg iteration GPU training time:415.23847453 ms
avg iteration (step) total cpu time:465.95994631 ms
Epoch Time(s): 6.5258
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3282 | Train Acc 0.9146 | Speed (samples/sec) 45438.7689 | GPU 28123.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

avg iteration(step) data from cpu to GPU time:31.18980281 ms
avg iteration GPU training time:414.36516317 ms
avg iteration (step) total cpu time:464.34712410 ms
Epoch Time(s): 6.6018
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.3343 | Train Acc 0.9100 | Speed (samples/sec) 45485.8153 | GPU 28123.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

[2021-06-12 22:29:52,599] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:29:52,713] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=3357.3379696387983
-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

avg iteration(step) data from cpu to GPU time:27.86074638 ms
avg iteration GPU training time:410.29550171 ms
avg iteration (step) total cpu time:453.26654116 ms
Epoch Time(s): 6.7885
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.3145 | Train Acc 0.9158 | Speed (samples/sec) 45550.3826 | GPU 28123.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

[2021-06-12 22:30:00,250] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:30:00,362] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=3364.9894572600115
-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

avg iteration(step) data from cpu to GPU time:28.14671961 ms
avg iteration GPU training time:410.57213338 ms
avg iteration (step) total cpu time:457.40079880 ms
Epoch Time(s): 6.6019
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.3341 | Train Acc 0.9117 | Speed (samples/sec) 45612.0867 | GPU 28123.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

[2021-06-12 22:30:07,784] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:30:07,897] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=3374.8427691648044
-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

avg iteration(step) data from cpu to GPU time:30.84890683 ms
avg iteration GPU training time:413.49993896 ms
avg iteration (step) total cpu time:461.33669217 ms
Epoch Time(s): 6.6227
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.3164 | Train Acc 0.9176 | Speed (samples/sec) 45624.9810 | GPU 28123.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62744140625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57470703125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.464609622955322  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.57666015625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.61572265625GB

Max Memory Allocated 27.464609622955322  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:30:15,330] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:30:15,443] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=3384.065828681612
-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:32.15545591 ms
avg iteration GPU training time:411.74722290 ms
avg iteration (step) total cpu time:461.87671026 ms
Epoch Time(s): 6.6875
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.3005 | Train Acc 0.9205 | Speed (samples/sec) 45671.1002 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.68766975 ms
avg iteration GPU training time:414.03559367 ms
avg iteration (step) total cpu time:459.26674207 ms
Epoch Time(s): 6.5983
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.3071 | Train Acc 0.9167 | Speed (samples/sec) 45690.3942 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:30:25,675] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:30:25,788] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=3393.1911698928384
-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.77076276 ms
avg iteration GPU training time:412.89017741 ms
avg iteration (step) total cpu time:456.03108406 ms
Epoch Time(s): 6.4753
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.3100 | Train Acc 0.9174 | Speed (samples/sec) 45766.8801 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:30:33,222] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:30:33,335] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=3403.183744757407
-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:31.44375420 ms
avg iteration GPU training time:416.86002604 ms
avg iteration (step) total cpu time:467.44060516 ms
Epoch Time(s): 6.6057
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.3031 | Train Acc 0.9187 | Speed (samples/sec) 45835.0836 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:30:40,848] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:30:40,961] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=3412.3194994076516
-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.53871981 ms
avg iteration GPU training time:416.67561849 ms
avg iteration (step) total cpu time:461.39836311 ms
Epoch Time(s): 6.7434
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.3034 | Train Acc 0.9183 | Speed (samples/sec) 45878.8463 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:30:48,434] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:30:48,546] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=3420.550947993059
-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:25.79161580 ms
avg iteration GPU training time:408.07114665 ms
avg iteration (step) total cpu time:447.45779037 ms
Epoch Time(s): 6.6824
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.2966 | Train Acc 0.9209 | Speed (samples/sec) 45904.8449 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.38497035 ms
avg iteration GPU training time:415.79843140 ms
avg iteration (step) total cpu time:461.69400215 ms
Epoch Time(s): 6.5156
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2900 | Train Acc 0.9232 | Speed (samples/sec) 45952.0473 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:30:58,717] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:30:58,831] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=3426.763856225743
-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:32.41402690 ms
avg iteration GPU training time:412.63312785 ms
avg iteration (step) total cpu time:459.69430606 ms
Epoch Time(s): 6.5996
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2939 | Train Acc 0.9204 | Speed (samples/sec) 45977.5049 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:31:06,271] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:31:06,384] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=3432.890210980704
-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:29.75105031 ms
avg iteration GPU training time:414.58138021 ms
avg iteration (step) total cpu time:460.67372958 ms
Epoch Time(s): 6.5331
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.2980 | Train Acc 0.9180 | Speed (samples/sec) 46034.1276 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:31:13,905] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:31:14,019] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=3436.8069310198375
-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:29.49825033 ms
avg iteration GPU training time:415.78243001 ms
avg iteration (step) total cpu time:461.63900693 ms
Epoch Time(s): 6.7525
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2871 | Train Acc 0.9218 | Speed (samples/sec) 46041.1365 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:31:21,532] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:31:21,646] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=3442.166259050268
-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:26.71016502 ms
avg iteration GPU training time:406.94627889 ms
avg iteration (step) total cpu time:449.14333026 ms
Epoch Time(s): 6.6795
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2883 | Train Acc 0.9225 | Speed (samples/sec) 46094.2561 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.70369085 ms
avg iteration GPU training time:407.97596232 ms
avg iteration (step) total cpu time:452.05108325 ms
Epoch Time(s): 6.4636
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.2947 | Train Acc 0.9212 | Speed (samples/sec) 46150.8931 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:31:31,839] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:31:31,952] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=3447.905945854943
-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.20002174 ms
avg iteration GPU training time:411.44494629 ms
avg iteration (step) total cpu time:458.68325233 ms
Epoch Time(s): 6.5742
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.2805 | Train Acc 0.9253 | Speed (samples/sec) 46213.3437 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:31:39,336] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:31:39,449] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=3452.8936445237823
-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:26.88477898 ms
avg iteration GPU training time:414.77989705 ms
avg iteration (step) total cpu time:455.97894986 ms
Epoch Time(s): 6.5601
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2765 | Train Acc 0.9235 | Speed (samples/sec) 46228.2692 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:31:46,780] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:31:46,893] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=3458.363250698362
-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.40542984 ms
avg iteration GPU training time:410.12787882 ms
avg iteration (step) total cpu time:452.66731580 ms
Epoch Time(s): 6.5752
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.2832 | Train Acc 0.9229 | Speed (samples/sec) 46272.6408 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:31:54,519] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:31:54,632] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=3460.388754866837
-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.39332263 ms
avg iteration GPU training time:415.49259440 ms
avg iteration (step) total cpu time:457.22397168 ms
Epoch Time(s): 6.8191
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2860 | Train Acc 0.9230 | Speed (samples/sec) 46269.1628 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.63401604 ms
avg iteration GPU training time:423.27011108 ms
avg iteration (step) total cpu time:469.64796384 ms
Epoch Time(s): 6.7370
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75830078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79736328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.2717 | Train Acc 0.9256 | Speed (samples/sec) 46243.8467 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:32:05,158] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:32:05,271] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=3459.825857811347
-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81103515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.80908203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.75634765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79541015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.70666695 ms
avg iteration GPU training time:411.00937907 ms
avg iteration (step) total cpu time:455.80085119 ms
Epoch Time(s): 6.6815
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2885 | Train Acc 0.9212 | Speed (samples/sec) 46255.7409 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:32:12,885] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:32:13,000] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=3462.3942373350988
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.22036235 ms
avg iteration GPU training time:421.62535604 ms
avg iteration (step) total cpu time:463.78938357 ms
Epoch Time(s): 6.8325
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.2720 | Train Acc 0.9267 | Speed (samples/sec) 46253.5700 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:32:20,495] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:32:20,608] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=3464.813589770166
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:36.41974449 ms
avg iteration GPU training time:413.55117798 ms
avg iteration (step) total cpu time:465.61304728 ms
Epoch Time(s): 6.5963
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2821 | Train Acc 0.9236 | Speed (samples/sec) 46276.7739 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:32:28,029] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:32:28,141] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=3467.315325009492
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:30.24088542 ms
avg iteration GPU training time:413.56479899 ms
avg iteration (step) total cpu time:459.63470141 ms
Epoch Time(s): 6.6256
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2779 | Train Acc 0.9239 | Speed (samples/sec) 46272.2815 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.50691160 ms
avg iteration GPU training time:408.31325277 ms
avg iteration (step) total cpu time:452.21853256 ms
Epoch Time(s): 6.6966
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.2803 | Train Acc 0.9244 | Speed (samples/sec) 46303.7909 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:32:38,460] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:32:38,573] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=3470.8916422497578
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.70018133 ms
avg iteration GPU training time:410.07005819 ms
avg iteration (step) total cpu time:460.25872231 ms
Epoch Time(s): 6.5020
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2752 | Train Acc 0.9241 | Speed (samples/sec) 46340.6008 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:32:45,908] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:32:46,021] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=3474.4099460314887
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:29.80375417 ms
avg iteration GPU training time:406.56751506 ms
avg iteration (step) total cpu time:453.79114151 ms
Epoch Time(s): 6.5238
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2761 | Train Acc 0.9261 | Speed (samples/sec) 46365.4668 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:32:53,484] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:32:53,597] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=3477.7810148142325
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:37.39475123 ms
avg iteration GPU training time:423.75956217 ms
avg iteration (step) total cpu time:476.48445765 ms
Epoch Time(s): 6.7076
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.2784 | Train Acc 0.9257 | Speed (samples/sec) 46364.4591 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:33:01,557] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:33:01,670] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=3479.383742058998
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:30.05319405 ms
avg iteration GPU training time:414.90135701 ms
avg iteration (step) total cpu time:458.39770635 ms
Epoch Time(s): 7.1139
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.2658 | Train Acc 0.9275 | Speed (samples/sec) 46376.9024 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:29.08081055 ms
avg iteration GPU training time:411.63767497 ms
avg iteration (step) total cpu time:459.01886622 ms
Epoch Time(s): 7.0454
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.2785 | Train Acc 0.9242 | Speed (samples/sec) 46389.2614 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:33:12,446] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:33:12,558] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=3481.4047216056983
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.97529602 ms
avg iteration GPU training time:414.64065552 ms
avg iteration (step) total cpu time:461.19213104 ms
Epoch Time(s): 6.7485
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2670 | Train Acc 0.9271 | Speed (samples/sec) 46387.8299 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:33:20,211] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:33:20,317] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=3483.0171827307695
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:33.25351397 ms
avg iteration GPU training time:414.59434001 ms
avg iteration (step) total cpu time:464.17681376 ms
Epoch Time(s): 6.7548
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.2676 | Train Acc 0.9249 | Speed (samples/sec) 46393.6747 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:33:27,834] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:33:27,948] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=3483.7427609298657
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.43067805 ms
avg iteration GPU training time:413.82555135 ms
avg iteration (step) total cpu time:460.40137609 ms
Epoch Time(s): 6.6491
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.2646 | Train Acc 0.9277 | Speed (samples/sec) 46394.2765 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:33:35,514] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:33:35,626] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=3484.3744102114147
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.86178144 ms
avg iteration GPU training time:407.39041138 ms
avg iteration (step) total cpu time:452.27781932 ms
Epoch Time(s): 6.7564
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.2738 | Train Acc 0.9262 | Speed (samples/sec) 46384.7424 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:30.27884738 ms
avg iteration GPU training time:409.75466919 ms
avg iteration (step) total cpu time:456.52063688 ms
Epoch Time(s): 6.5950
Eval Acc 0.9155
Test Acc: 0.7673
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.2635 | Train Acc 0.9285 | Speed (samples/sec) 46409.4298 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:34:28,419] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:34:28,532] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=3485.053170190002
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.41320546 ms
avg iteration GPU training time:409.84553019 ms
avg iteration (step) total cpu time:455.27370771 ms
Epoch Time(s): 6.7809
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.2620 | Train Acc 0.9286 | Speed (samples/sec) 46421.2800 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:34:36,106] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:34:36,220] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=3485.4740585328436
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:26.01380221 ms
avg iteration GPU training time:442.29001872 ms
avg iteration (step) total cpu time:483.79882177 ms
Epoch Time(s): 6.8131
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.2608 | Train Acc 0.9281 | Speed (samples/sec) 46391.4653 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:34:43,799] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:34:43,913] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=3484.754352879145
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:29.61004829 ms
avg iteration GPU training time:409.22986857 ms
avg iteration (step) total cpu time:456.65431023 ms
Epoch Time(s): 6.6877
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.2582 | Train Acc 0.9294 | Speed (samples/sec) 46406.7931 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:34:51,441] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:34:51,555] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=3486.7140945505844
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:30.84770139 ms
avg iteration GPU training time:414.29808553 ms
avg iteration (step) total cpu time:462.58322398 ms
Epoch Time(s): 6.7370
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.2791 | Train Acc 0.9239 | Speed (samples/sec) 46420.1581 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:33.08881124 ms
avg iteration GPU training time:413.69146729 ms
avg iteration (step) total cpu time:465.68314234 ms
Epoch Time(s): 8.0528
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.2585 | Train Acc 0.9288 | Speed (samples/sec) 46342.6699 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:35:03,216] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:35:03,329] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=3486.8256791260383
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:26.86879985 ms
avg iteration GPU training time:424.47271729 ms
avg iteration (step) total cpu time:467.23922094 ms
Epoch Time(s): 6.5577
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2564 | Train Acc 0.9299 | Speed (samples/sec) 46349.2536 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:35:11,231] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:35:11,344] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=3485.9630009122593
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:29.91279984 ms
avg iteration GPU training time:417.95519002 ms
avg iteration (step) total cpu time:507.66595205 ms
Epoch Time(s): 7.1431
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2638 | Train Acc 0.9271 | Speed (samples/sec) 46313.7172 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:35:19,121] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:35:19,234] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=3487.1422586536487
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:29.37418620 ms
avg iteration GPU training time:412.64968872 ms
avg iteration (step) total cpu time:456.78814252 ms
Epoch Time(s): 6.7967
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.2649 | Train Acc 0.9269 | Speed (samples/sec) 46327.9205 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:35:26,952] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:35:27,065] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=3485.6622888523875
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:32.72345479 ms
avg iteration GPU training time:444.64081828 ms
avg iteration (step) total cpu time:496.13229434 ms
Epoch Time(s): 6.8932
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.2577 | Train Acc 0.9301 | Speed (samples/sec) 46290.8643 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.01550929 ms
avg iteration GPU training time:418.51058960 ms
avg iteration (step) total cpu time:459.37124888 ms
Epoch Time(s): 7.7878
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.2630 | Train Acc 0.9271 | Speed (samples/sec) 46297.5716 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:35:38,729] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:35:38,841] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=3485.1162711745296
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:30.64104589 ms
avg iteration GPU training time:408.80257161 ms
avg iteration (step) total cpu time:455.61393102 ms
Epoch Time(s): 6.8045
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.2691 | Train Acc 0.9259 | Speed (samples/sec) 46320.1206 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:35:46,374] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:35:46,487] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=3487.2965666973605
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.77443250 ms
avg iteration GPU training time:409.93414307 ms
avg iteration (step) total cpu time:454.08391953 ms
Epoch Time(s): 6.6722
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.2561 | Train Acc 0.9277 | Speed (samples/sec) 46339.0466 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:35:55,269] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:35:55,382] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=3489.5271353165544
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:26.89629873 ms
avg iteration GPU training time:418.99244181 ms
avg iteration (step) total cpu time:459.45183436 ms
Epoch Time(s): 8.0544
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.2652 | Train Acc 0.9281 | Speed (samples/sec) 46355.7258 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:36:03,200] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:36:03,312] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=3489.8473711150777
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:37.40772247 ms
avg iteration GPU training time:427.37628174 ms
avg iteration (step) total cpu time:483.47123464 ms
Epoch Time(s): 6.9637
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.2776 | Train Acc 0.9244 | Speed (samples/sec) 46344.2772 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:34.08361562 ms
avg iteration GPU training time:411.29417928 ms
avg iteration (step) total cpu time:459.77671941 ms
Epoch Time(s): 6.8619
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.2550 | Train Acc 0.9288 | Speed (samples/sec) 46361.0370 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:36:14,022] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:36:14,135] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=3490.851400570698
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:30.97698085 ms
avg iteration GPU training time:416.22728475 ms
avg iteration (step) total cpu time:462.21701304 ms
Epoch Time(s): 6.7474
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.2612 | Train Acc 0.9281 | Speed (samples/sec) 46373.6365 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:36:21,667] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:36:21,790] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=3492.501383616499
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:26.98850123 ms
avg iteration GPU training time:406.50655111 ms
avg iteration (step) total cpu time:450.16702016 ms
Epoch Time(s): 6.6990
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.2522 | Train Acc 0.9315 | Speed (samples/sec) 46396.2457 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:36:29,284] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:36:29,398] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=3494.053421404872
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:31.70153618 ms
avg iteration GPU training time:413.26009115 ms
avg iteration (step) total cpu time:460.51772436 ms
Epoch Time(s): 6.7200
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.2628 | Train Acc 0.9278 | Speed (samples/sec) 46408.5099 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:36:37,003] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:36:37,116] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=3496.5248652789646
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:25.85004807 ms
avg iteration GPU training time:408.46413167 ms
avg iteration (step) total cpu time:451.01865133 ms
Epoch Time(s): 6.7760
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.2546 | Train Acc 0.9293 | Speed (samples/sec) 46428.2919 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:30.91841062 ms
avg iteration GPU training time:422.70114136 ms
avg iteration (step) total cpu time:468.53025754 ms
Epoch Time(s): 6.8418
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.2657 | Train Acc 0.9262 | Speed (samples/sec) 46414.3942 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:36:47,768] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:36:47,881] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=3496.3753367305885
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.52409617 ms
avg iteration GPU training time:450.31854248 ms
avg iteration (step) total cpu time:494.42958832 ms
Epoch Time(s): 6.9045
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.2530 | Train Acc 0.9303 | Speed (samples/sec) 46396.8432 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:36:55,737] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:36:55,851] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=3493.3339034929513
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.87657547 ms
avg iteration GPU training time:416.83274333 ms
avg iteration (step) total cpu time:464.38177427 ms
Epoch Time(s): 6.8399
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.2492 | Train Acc 0.9305 | Speed (samples/sec) 46393.8474 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:37:03,328] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:37:03,441] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=3494.694126141442
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:25.82411766 ms
avg iteration GPU training time:411.79015096 ms
avg iteration (step) total cpu time:452.67923673 ms
Epoch Time(s): 6.6383
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.2526 | Train Acc 0.9295 | Speed (samples/sec) 46403.0622 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:37:10,921] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:37:11,034] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=3496.2715395922937
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.45898692 ms
avg iteration GPU training time:409.35402425 ms
avg iteration (step) total cpu time:450.18895467 ms
Epoch Time(s): 6.6663
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.2659 | Train Acc 0.9262 | Speed (samples/sec) 46418.2321 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.19468816 ms
avg iteration GPU training time:411.06944784 ms
avg iteration (step) total cpu time:457.66051610 ms
Epoch Time(s): 6.6306
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.2605 | Train Acc 0.9271 | Speed (samples/sec) 46436.7009 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:37:21,409] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:37:21,523] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=3498.022850734337
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:31.78964233 ms
avg iteration GPU training time:406.77379354 ms
avg iteration (step) total cpu time:456.64286613 ms
Epoch Time(s): 6.5962
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.2594 | Train Acc 0.9290 | Speed (samples/sec) 46457.6675 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:37:28,958] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:37:29,072] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=3499.6717066155966
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.24585660 ms
avg iteration GPU training time:409.87131755 ms
avg iteration (step) total cpu time:453.62242063 ms
Epoch Time(s): 6.6994
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.2637 | Train Acc 0.9286 | Speed (samples/sec) 46463.2578 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:37:36,599] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:37:36,712] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=3501.520801565388
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:30.04855474 ms
avg iteration GPU training time:412.53837077 ms
avg iteration (step) total cpu time:457.86086718 ms
Epoch Time(s): 6.7244
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.2536 | Train Acc 0.9282 | Speed (samples/sec) 46482.6725 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:37:44,335] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:37:44,448] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=3502.8746784474592
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:31.14485296 ms
avg iteration GPU training time:405.71742757 ms
avg iteration (step) total cpu time:451.13174121 ms
Epoch Time(s): 6.8207
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.2573 | Train Acc 0.9303 | Speed (samples/sec) 46492.6530 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:31.25036812 ms
avg iteration GPU training time:411.50450643 ms
avg iteration (step) total cpu time:458.54655902 ms
Epoch Time(s): 6.6862
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.2564 | Train Acc 0.9279 | Speed (samples/sec) 46497.3000 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:37:55,635] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:37:55,746] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=3503.4230130347787
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:31.64844767 ms
avg iteration GPU training time:416.18710327 ms
avg iteration (step) total cpu time:463.01809947 ms
Epoch Time(s): 7.3159
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.2570 | Train Acc 0.9286 | Speed (samples/sec) 46467.4582 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:38:03,437] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:38:03,550] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=3505.0542688284672
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:32.23111534 ms
avg iteration GPU training time:410.35452271 ms
avg iteration (step) total cpu time:459.89290873 ms
Epoch Time(s): 6.9328
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.2621 | Train Acc 0.9267 | Speed (samples/sec) 46470.3738 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:38:11,062] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:38:11,175] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=3507.0159798469303
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.01310921 ms
avg iteration GPU training time:408.91062419 ms
avg iteration (step) total cpu time:452.65817642 ms
Epoch Time(s): 6.6307
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.2700 | Train Acc 0.9267 | Speed (samples/sec) 46489.1880 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:38:18,597] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:38:18,711] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=3508.794724991375
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:29.05628840 ms
avg iteration GPU training time:411.24421183 ms
avg iteration (step) total cpu time:456.85267448 ms
Epoch Time(s): 6.6589
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.2539 | Train Acc 0.9312 | Speed (samples/sec) 46503.8888 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:26.93991470 ms
avg iteration GPU training time:410.12571208 ms
avg iteration (step) total cpu time:462.29934692 ms
Epoch Time(s): 6.7252
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.2538 | Train Acc 0.9280 | Speed (samples/sec) 46509.1654 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:38:29,337] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:38:29,450] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=3508.7591490911786
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.65994708 ms
avg iteration GPU training time:411.82158407 ms
avg iteration (step) total cpu time:455.83176613 ms
Epoch Time(s): 6.9404
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.2652 | Train Acc 0.9254 | Speed (samples/sec) 46498.6312 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:38:37,142] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:38:37,255] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=3507.247836199548
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:34.33957227 ms
avg iteration GPU training time:412.17542521 ms
avg iteration (step) total cpu time:465.88214238 ms
Epoch Time(s): 6.7567
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.2622 | Train Acc 0.9276 | Speed (samples/sec) 46485.6710 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:38:44,998] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:38:45,112] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=3506.1022823527846
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.93803787 ms
avg iteration GPU training time:443.77641805 ms
avg iteration (step) total cpu time:485.50629616 ms
Epoch Time(s): 6.9825
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.2472 | Train Acc 0.9309 | Speed (samples/sec) 46461.9510 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:38:52,825] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:38:52,939] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=3504.8570375533445
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:29.79789797 ms
avg iteration GPU training time:437.55262248 ms
avg iteration (step) total cpu time:484.82688268 ms
Epoch Time(s): 6.8641
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.2552 | Train Acc 0.9282 | Speed (samples/sec) 46454.2790 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:28.57518895 ms
avg iteration GPU training time:432.70068359 ms
avg iteration (step) total cpu time:478.63825162 ms
Epoch Time(s): 6.9030
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.2533 | Train Acc 0.9290 | Speed (samples/sec) 46439.2845 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:39:03,861] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:39:03,974] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=3502.9332337646097
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:26.81516838 ms
avg iteration GPU training time:445.17484538 ms
avg iteration (step) total cpu time:486.33646965 ms
Epoch Time(s): 7.0669
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.2560 | Train Acc 0.9293 | Speed (samples/sec) 46420.5899 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:39:11,876] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:39:11,989] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=3500.7190193254787
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:30.96698634 ms
avg iteration GPU training time:450.39979045 ms
avg iteration (step) total cpu time:496.76632881 ms
Epoch Time(s): 7.0524
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.2503 | Train Acc 0.9292 | Speed (samples/sec) 46397.6764 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:39:20,415] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:39:20,528] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=3498.7011989027396
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:25.53998947 ms
avg iteration GPU training time:432.25420125 ms
avg iteration (step) total cpu time:473.89308612 ms
Epoch Time(s): 7.4635
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.2536 | Train Acc 0.9286 | Speed (samples/sec) 46357.9742 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:39:28,187] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:39:28,300] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=3499.07119853843
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.21915754 ms
avg iteration GPU training time:405.08321126 ms
avg iteration (step) total cpu time:450.93933741 ms
Epoch Time(s): 6.8395
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.2580 | Train Acc 0.9277 | Speed (samples/sec) 46365.5330 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:29.78739230 ms
avg iteration GPU training time:418.89257812 ms
avg iteration (step) total cpu time:464.05617396 ms
Epoch Time(s): 7.1114
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.2693 | Train Acc 0.9269 | Speed (samples/sec) 46369.4952 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:39:39,202] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:39:39,315] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=3499.535859964049
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.85597865 ms
avg iteration GPU training time:450.26365153 ms
avg iteration (step) total cpu time:492.99788475 ms
Epoch Time(s): 6.9204
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.2512 | Train Acc 0.9292 | Speed (samples/sec) 46346.2525 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:39:47,023] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:39:47,137] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=3498.506564709151
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:30.77041117 ms
avg iteration GPU training time:405.50931803 ms
avg iteration (step) total cpu time:462.50534058 ms
Epoch Time(s): 6.6859
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.2562 | Train Acc 0.9306 | Speed (samples/sec) 46353.8950 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30712890625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:39:54,817] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:39:54,930] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=3498.3766704100117
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:38.49780273 ms
avg iteration GPU training time:425.44176229 ms
avg iteration (step) total cpu time:481.67785009 ms
Epoch Time(s): 6.8249
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.2470 | Train Acc 0.9309 | Speed (samples/sec) 46340.7112 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

[2021-06-12 22:40:02,434] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:40:02,547] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=3499.598485391788
-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:27.40818087 ms
avg iteration GPU training time:407.86591593 ms
avg iteration (step) total cpu time:449.47147369 ms
Epoch Time(s): 6.7137
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.2491 | Train Acc 0.9316 | Speed (samples/sec) 46343.4723 | GPU 28147.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.28173828125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27783203125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26611328125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30517578125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28955078125GB

Max Memory Allocated 27.48751974105835  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.26416015625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.27978515625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.48751974105835  GigaBytes

avg iteration(step) data from cpu to GPU time:26.54162153 ms
avg iteration GPU training time:410.52893066 ms
avg iteration (step) total cpu time:454.98363177 ms
Epoch Time(s): 6.6448
Eval Acc 0.9190
Test Acc: 0.7669
Avg epoch time(time.time()): 6805.9821004668875 ms
total avg iteration(step) data from cpu to GPU time:29.62434709 ms
total avg iteration GPU training time:421.12048561 ms
total avg iteration (step) total cpu time:467.90731150 ms
