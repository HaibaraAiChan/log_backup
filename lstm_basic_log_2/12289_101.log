[2021-06-12 22:40:57,935] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-12 22:41:01,791] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 12289 --deepspeed_config ds_config.json
[2021-06-12 22:41:02,697] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-12 22:41:02,697] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-12 22:41:02,697] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-12 22:41:02,697] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-12 22:41:02,697] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623537668.2563324
before load_ogb step Time(s): 0.0018
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.17578125, 'VmSize': 20395.0, 'VmHWM': 1164.84765625, 'VmRSS': 1164.84765625}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6234
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2833
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0010
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0000
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0777
-------------------------------------------------end of load ogb****************** step Time(s): 0.0019
finish constructing ogbn-products
load ogb-products time total: 1.987652063369751
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 1.9886
after inductive else step Time(s): 0.0000
after label step Time(s): 3.8260
after train_g.create_formats_() step Time(s): 1.7966
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-12 22:41:15,900] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-12 22:41:15,902] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-12 22:41:15,905] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-12 22:41:18,361] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-12 22:41:18,363] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-12 22:41:18,364] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-12 22:41:18,364] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-12 22:41:18,364] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-12 22:41:18,364] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f791413e908>
[2021-06-12 22:41:18,364] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:41:18,364] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-12 22:41:18,364] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-12 22:41:18,365] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-12 22:41:18,366] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-12 22:41:18,366] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-12 22:41:18,367] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68408203125GB

Max Memory Allocated 1.2875080108642578  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.73876953125GB

Max Memory Allocated 1.2875080108642578  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.43017578125GB

Max Memory Allocated 16.60707712173462  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.43017578125GB

Max Memory Allocated 16.60707712173462  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.44580078125GB

Max Memory Allocated 16.60707712173462  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.44580078125GB

Max Memory Allocated 16.60707712173462  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7782 | Train Acc 0.0309 | Speed (samples/sec) nan | GPU 17005.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.40673828125GB

Max Memory Allocated 16.60707712173462  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.40673828125GB

Max Memory Allocated 16.60707712173462  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.43017578125GB

Max Memory Allocated 16.60707712173462  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.32080078125GB

Max Memory Allocated 16.616533279418945  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.31103515625GB

Max Memory Allocated 16.616533279418945  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.31494140625GB

Max Memory Allocated 16.616533279418945  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.31494140625GB

Max Memory Allocated 16.616533279418945  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.27587890625GB

Max Memory Allocated 16.616533279418945  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.27587890625GB

Max Memory Allocated 16.616533279418945  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.29931640625GB

Max Memory Allocated 16.616533279418945  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

[2021-06-12 22:41:24,693] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-12 22:41:24,754] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=4474.076981827647
-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

avg iteration(step) data from cpu to GPU time:18.14257171 ms
avg iteration GPU training time:306.02231667 ms
avg iteration (step) total cpu time:337.14335615 ms
Epoch Time(s): 8.6103
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.0398 | Train Acc 0.7193 | Speed (samples/sec) 33276.2391 | GPU 17082.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

[2021-06-12 22:41:30,425] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:41:30,487] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=4685.45083014281
-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

[2021-06-12 22:41:33,930] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:41:33,988] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=4700.870348367505
-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 16.682215213775635  GigaBytes

avg iteration(step) data from cpu to GPU time:17.55551425 ms
avg iteration GPU training time:315.64912553 ms
avg iteration (step) total cpu time:346.61496769 ms
Epoch Time(s): 7.9449
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45751953125GB

Max Memory Allocated 16.682215213775635  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.5985 | Train Acc 0.8582 | Speed (samples/sec) 33270.8720 | GPU 17110.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32080078125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32080078125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34423828125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36767578125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32080078125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32080078125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34423828125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34423828125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36767578125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35791015625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32080078125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32080078125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34423828125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

[2021-06-12 22:41:40,231] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:41:40,288] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=4547.780995983501
-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32080078125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32080078125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34423828125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32080078125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32080078125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34423828125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35791015625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.36962890625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.35986328125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.36181640625GB

Max Memory Allocated 16.709409713745117  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.34423828125GB

Max Memory Allocated 16.709409713745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.53736435 ms
avg iteration GPU training time:347.22862382 ms
avg iteration (step) total cpu time:383.06396658 ms
Epoch Time(s): 8.5142
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.4671 | Train Acc 0.8853 | Speed (samples/sec) 32452.8293 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:41:46,014] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:41:46,077] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=4551.804632415149
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:41:49,562] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:41:49,624] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=4581.109219782332
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:17.22071552 ms
avg iteration GPU training time:314.67148659 ms
avg iteration (step) total cpu time:348.89815070 ms
Epoch Time(s): 7.8121
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.4371 | Train Acc 0.8892 | Speed (samples/sec) 32601.8167 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:41:55,309] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:41:55,371] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=4575.733854457528
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:41:58,757] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:41:58,820] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=4600.7017601229
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.86806089 ms
avg iteration GPU training time:314.57877697 ms
avg iteration (step) total cpu time:344.99762275 ms
Epoch Time(s): 7.8710
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.3787 | Train Acc 0.9047 | Speed (samples/sec) 32685.8994 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:04,406] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:04,469] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=4628.520130414608
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.89321024 ms
avg iteration GPU training time:306.90528731 ms
avg iteration (step) total cpu time:337.55872466 ms
Epoch Time(s): 7.6327
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.3586 | Train Acc 0.9045 | Speed (samples/sec) 33018.4751 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:10,049] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:10,113] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=4641.792570926795
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:13,499] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:13,562] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=4659.112795405356
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.85139786 ms
avg iteration GPU training time:311.40908536 ms
avg iteration (step) total cpu time:344.73729134 ms
Epoch Time(s): 7.7609
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.3546 | Train Acc 0.9088 | Speed (samples/sec) 33122.6980 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:19,345] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:19,407] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=4664.974786142572
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.26025390625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:15.13490321 ms
avg iteration GPU training time:326.00292691 ms
avg iteration (step) total cpu time:353.81230441 ms
Epoch Time(s): 7.9893
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3346 | Train Acc 0.9125 | Speed (samples/sec) 33139.2537 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:25,174] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:25,236] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=4665.030452855539
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:28,668] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:28,725] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=4673.286971841278
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.48774979 ms
avg iteration GPU training time:318.59363625 ms
avg iteration (step) total cpu time:352.39425572 ms
Epoch Time(s): 7.9001
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3405 | Train Acc 0.9127 | Speed (samples/sec) 33170.5578 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:34,522] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:34,579] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=4660.597516283002
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:37,958] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:38,020] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=4667.262130500333
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.16835499 ms
avg iteration GPU training time:316.47552490 ms
avg iteration (step) total cpu time:346.40676325 ms
Epoch Time(s): 7.8741
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3174 | Train Acc 0.9150 | Speed (samples/sec) 33144.3639 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:43,707] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:43,769] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=4666.526130505244
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:15.72680447 ms
avg iteration GPU training time:309.50723544 ms
avg iteration (step) total cpu time:339.07469836 ms
Epoch Time(s): 7.7671
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3333 | Train Acc 0.9129 | Speed (samples/sec) 33204.6023 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:49,246] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:49,308] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=4679.6903910391775
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:52,723] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:52,786] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=4682.605040744957
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.70535270 ms
avg iteration GPU training time:317.07605535 ms
avg iteration (step) total cpu time:346.59836509 ms
Epoch Time(s): 7.6748
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3156 | Train Acc 0.9124 | Speed (samples/sec) 33266.0026 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:42:58,343] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:42:58,405] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=4689.859116244264
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.31980809 ms
avg iteration GPU training time:319.82069536 ms
avg iteration (step) total cpu time:351.22587464 ms
Epoch Time(s): 7.8230
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3065 | Train Acc 0.9192 | Speed (samples/sec) 33273.2219 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:04,122] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:04,181] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=4685.449886959319
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:07,590] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:07,655] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=4688.767224861002
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.10646681 ms
avg iteration GPU training time:312.20804943 ms
avg iteration (step) total cpu time:342.01205860 ms
Epoch Time(s): 7.7294
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3154 | Train Acc 0.9145 | Speed (samples/sec) 33314.1507 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:13,251] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:13,313] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=4693.258224378588
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:16,697] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:16,760] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=4696.570599399248
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.89185741 ms
avg iteration GPU training time:317.43989147 ms
avg iteration (step) total cpu time:348.41450778 ms
Epoch Time(s): 7.7957
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3113 | Train Acc 0.9178 | Speed (samples/sec) 33340.4383 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:22,460] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:22,523] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=4699.786533789001
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:17.09473471 ms
avg iteration GPU training time:315.29789318 ms
avg iteration (step) total cpu time:346.22118690 ms
Epoch Time(s): 7.7430
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.2997 | Train Acc 0.9208 | Speed (samples/sec) 33381.8939 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:28,072] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:28,135] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=4702.378227211981
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:31,558] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:31,617] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=4704.896200770906
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:18.86964026 ms
avg iteration GPU training time:314.33155961 ms
avg iteration (step) total cpu time:346.27001936 ms
Epoch Time(s): 7.7013
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.2984 | Train Acc 0.9196 | Speed (samples/sec) 33402.3620 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:37,148] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:37,211] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=4707.580638678137
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:14.69592441 ms
avg iteration GPU training time:311.21927435 ms
avg iteration (step) total cpu time:338.70842240 ms
Epoch Time(s): 7.5942
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.2943 | Train Acc 0.9192 | Speed (samples/sec) 33462.0107 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:42,658] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:42,721] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=4714.647877829246
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:46,087] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:46,149] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=4721.0090219595895
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

avg iteration(step) data from cpu to GPU time:16.20943416 ms
avg iteration GPU training time:307.91356035 ms
avg iteration (step) total cpu time:342.82415563 ms
Epoch Time(s): 7.6634
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.2911 | Train Acc 0.9206 | Speed (samples/sec) 33499.2295 | GPU 17149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

[2021-06-12 22:43:51,745] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:51,808] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=4719.4923121121565
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.74798345565796  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.74798345565796  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:43:55,161] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:43:55,225] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=4723.356429578531
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:18.35190695 ms
avg iteration GPU training time:309.76239291 ms
avg iteration (step) total cpu time:341.66088971 ms
Epoch Time(s): 7.7093
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.2838 | Train Acc 0.9241 | Speed (samples/sec) 33507.4261 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:00,737] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:00,800] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=4726.904918012269
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:15.79725959 ms
avg iteration GPU training time:308.05584994 ms
avg iteration (step) total cpu time:336.93779599 ms
Epoch Time(s): 7.6119
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.2750 | Train Acc 0.9260 | Speed (samples/sec) 33555.8912 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:06,273] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:06,336] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=4732.968714536323
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:09,728] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:09,791] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=4737.234293138082
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:17.74996359 ms
avg iteration GPU training time:306.55858265 ms
avg iteration (step) total cpu time:343.59624169 ms
Epoch Time(s): 7.6215
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.2988 | Train Acc 0.9176 | Speed (samples/sec) 33585.4299 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:15,373] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:15,434] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=4739.208074716965
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:16.35660787 ms
avg iteration GPU training time:314.44231900 ms
avg iteration (step) total cpu time:350.00354593 ms
Epoch Time(s): 7.7701
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.2793 | Train Acc 0.9255 | Speed (samples/sec) 33584.2580 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:21,147] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:21,210] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=4738.122470007039
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.26025390625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:24,759] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:24,822] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=4733.053026507388
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:16.17621248 ms
avg iteration GPU training time:319.70443448 ms
avg iteration (step) total cpu time:349.06569394 ms
Epoch Time(s): 7.9461
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.2902 | Train Acc 0.9206 | Speed (samples/sec) 33552.9780 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:30,472] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:30,535] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=4735.010732088058
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:33,854] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:33,917] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=4738.264933730687
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:16.51393743 ms
avg iteration GPU training time:307.14498347 ms
avg iteration (step) total cpu time:339.44758502 ms
Epoch Time(s): 7.7458
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.2851 | Train Acc 0.9225 | Speed (samples/sec) 33576.0734 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:39,657] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:39,721] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=4733.311502454159
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:15.64293246 ms
avg iteration GPU training time:313.67746527 ms
avg iteration (step) total cpu time:343.88152036 ms
Epoch Time(s): 7.8342
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2814 | Train Acc 0.9253 | Speed (samples/sec) 33571.4386 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:45,305] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:45,363] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=4734.069019361646
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:48,828] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:48,891] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=4734.491001532627
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:18.76856709 ms
avg iteration GPU training time:312.17667181 ms
avg iteration (step) total cpu time:347.88578207 ms
Epoch Time(s): 7.8216
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2791 | Train Acc 0.9239 | Speed (samples/sec) 33549.9790 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:44:54,606] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:44:54,668] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=4736.464090219163
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:19.30487572 ms
avg iteration GPU training time:310.05099210 ms
avg iteration (step) total cpu time:342.20105951 ms
Epoch Time(s): 7.8105
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.2786 | Train Acc 0.9233 | Speed (samples/sec) 33563.7490 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:45:00,344] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:00,403] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=4736.051461642001
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:45:03,901] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:03,963] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=4733.692043524814
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:17.68327297 ms
avg iteration GPU training time:320.09587791 ms
avg iteration (step) total cpu time:351.15187818 ms
Epoch Time(s): 7.9773
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2725 | Train Acc 0.9260 | Speed (samples/sec) 33538.0472 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:45:09,706] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:09,769] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=4730.225238505677
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:45:13,093] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:13,156] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=4732.908446535733
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:16.32777309 ms
avg iteration GPU training time:310.37977461 ms
avg iteration (step) total cpu time:339.97930180 ms
Epoch Time(s): 7.8325
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2915 | Train Acc 0.9249 | Speed (samples/sec) 33538.7749 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:45:18,840] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:18,903] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=4731.561999225558
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:15.93216307 ms
avg iteration GPU training time:312.84173861 ms
avg iteration (step) total cpu time:342.61031584 ms
Epoch Time(s): 7.7468
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.2985 | Train Acc 0.9180 | Speed (samples/sec) 33541.9042 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:45:24,511] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:24,574] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=4730.80322194847
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:45:27,963] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:28,025] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=4732.67801724601
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:18.33836209 ms
avg iteration GPU training time:311.01750599 ms
avg iteration (step) total cpu time:345.74918313 ms
Epoch Time(s): 7.8738
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.2891 | Train Acc 0.9212 | Speed (samples/sec) 33550.7265 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:45:33,698] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:33,754] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=4734.977675900063
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

avg iteration(step) data from cpu to GPU time:16.09141818 ms
avg iteration GPU training time:312.01781394 ms
avg iteration (step) total cpu time:344.87022053 ms
Epoch Time(s): 7.6727
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2795 | Train Acc 0.9238 | Speed (samples/sec) 33566.9278 | GPU 17152.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

[2021-06-12 22:45:39,364] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:39,426] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=4735.271637853719
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.7501802444458  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.7501802444458  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:45:42,932] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:42,995] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=4733.572578216141
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:17.53945576 ms
avg iteration GPU training time:312.40227439 ms
avg iteration (step) total cpu time:343.45893426 ms
Epoch Time(s): 7.8676
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.2863 | Train Acc 0.9192 | Speed (samples/sec) 33553.2443 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:45:48,635] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:48,696] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=4732.931452242917
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:45:52,132] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:52,196] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=4732.806628475871
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:16.65719552 ms
avg iteration GPU training time:317.72811335 ms
avg iteration (step) total cpu time:349.53370961 ms
Epoch Time(s): 7.8573
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2708 | Train Acc 0.9275 | Speed (samples/sec) 33544.4983 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:45:57,978] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:45:58,041] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=4729.6662157583405
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:16.95581670 ms
avg iteration GPU training time:317.77471369 ms
avg iteration (step) total cpu time:348.79699620 ms
Epoch Time(s): 7.8380
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.2674 | Train Acc 0.9288 | Speed (samples/sec) 33534.6813 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:03,622] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:03,686] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=4729.641450955919
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:07,106] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:07,169] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=4729.428169580005
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:16.18567553 ms
avg iteration GPU training time:314.94557051 ms
avg iteration (step) total cpu time:344.38317472 ms
Epoch Time(s): 7.7892
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2733 | Train Acc 0.9290 | Speed (samples/sec) 33531.2300 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:12,808] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:12,871] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=4729.868122268294
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:16.43943856 ms
avg iteration GPU training time:305.99251210 ms
avg iteration (step) total cpu time:334.85091816 ms
Epoch Time(s): 7.7324
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.2759 | Train Acc 0.9249 | Speed (samples/sec) 33548.1815 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:18,408] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:18,470] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=4731.074763737887
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:22,037] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:22,098] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=4728.419980761396
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:16.09095851 ms
avg iteration GPU training time:318.75250244 ms
avg iteration (step) total cpu time:350.93370351 ms
Epoch Time(s): 7.8965
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2757 | Train Acc 0.9262 | Speed (samples/sec) 33530.3636 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:27,877] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:27,940] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=4724.414298970887
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:31,429] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:31,492] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=4722.685483873415
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:16.53689020 ms
avg iteration GPU training time:327.77355402 ms
avg iteration (step) total cpu time:358.14827139 ms
Epoch Time(s): 8.0199
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2730 | Train Acc 0.9298 | Speed (samples/sec) 33499.7445 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:37,154] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:37,212] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=4721.504353945472
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:17.00029364 ms
avg iteration GPU training time:316.64816007 ms
avg iteration (step) total cpu time:347.75224599 ms
Epoch Time(s): 7.7930
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.2787 | Train Acc 0.9233 | Speed (samples/sec) 33499.5567 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:42,812] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:42,874] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=4721.625739616033
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:46,396] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:46,460] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=4719.869802296708
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:16.68582405 ms
avg iteration GPU training time:321.42080411 ms
avg iteration (step) total cpu time:352.53635320 ms
Epoch Time(s): 7.8281
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2712 | Train Acc 0.9268 | Speed (samples/sec) 33492.2897 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:52,157] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:52,219] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=4719.446600940525
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:16.44724378 ms
avg iteration GPU training time:314.65947654 ms
avg iteration (step) total cpu time:350.19781373 ms
Epoch Time(s): 7.8871
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2727 | Train Acc 0.9249 | Speed (samples/sec) 33482.9389 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:46:57,870] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:46:57,933] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=4719.354335209131
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:47:01,425] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:01,488] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=4717.928220281573
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:16.56811645 ms
avg iteration GPU training time:315.64012562 ms
avg iteration (step) total cpu time:345.20209919 ms
Epoch Time(s): 7.8103
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.2816 | Train Acc 0.9217 | Speed (samples/sec) 33477.1036 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:47:07,228] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:07,291] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=4716.328517035684
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:47:10,757] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:10,815] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=4715.226703955095
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

avg iteration(step) data from cpu to GPU time:15.68627193 ms
avg iteration GPU training time:324.46655273 ms
avg iteration (step) total cpu time:352.98100385 ms
Epoch Time(s): 8.0018
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.2806 | Train Acc 0.9209 | Speed (samples/sec) 33455.3820 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes

[2021-06-12 22:47:16,531] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:16,594] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=4714.162010330606
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.757363319396973  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.757363319396973  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.47617149 ms
avg iteration GPU training time:308.74516713 ms
avg iteration (step) total cpu time:342.78108857 ms
Epoch Time(s): 7.8427
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.2836 | Train Acc 0.9233 | Speed (samples/sec) 33456.0000 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:47:22,189] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:22,251] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=4714.497497252884
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:47:25,583] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:25,646] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=4716.622152887721
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.29912134 ms
avg iteration GPU training time:307.83747448 ms
avg iteration (step) total cpu time:338.08211847 ms
Epoch Time(s): 7.6673
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2732 | Train Acc 0.9256 | Speed (samples/sec) 33467.4102 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:47:31,356] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:31,415] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=4714.512679273907
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:15.61797818 ms
avg iteration GPU training time:321.79038863 ms
avg iteration (step) total cpu time:350.61311722 ms
Epoch Time(s): 7.7870
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.2698 | Train Acc 0.9273 | Speed (samples/sec) 33462.3547 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:47:36,939] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:37,001] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=4714.98758537914
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:47:40,453] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:40,517] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=4715.893840436258
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.01857775 ms
avg iteration GPU training time:309.61174705 ms
avg iteration (step) total cpu time:345.29222142 ms
Epoch Time(s): 7.7948
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.2610 | Train Acc 0.9288 | Speed (samples/sec) 33463.9525 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:47:46,193] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:46,256] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=4716.081847482052
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:47:49,525] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:49,588] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=4719.043861755338
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.20723794 ms
avg iteration GPU training time:301.63623324 ms
avg iteration (step) total cpu time:332.72223039 ms
Epoch Time(s): 7.7450
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.2706 | Train Acc 0.9252 | Speed (samples/sec) 33478.8029 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:47:55,425] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:47:55,488] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=4716.787427473428
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.55397814 ms
avg iteration GPU training time:313.58125444 ms
avg iteration (step) total cpu time:344.03532202 ms
Epoch Time(s): 7.9265
Eval Acc 0.9119
Test Acc: 0.7645
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.2657 | Train Acc 0.9261 | Speed (samples/sec) 33469.9863 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:48:51,351] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:48:51,408] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=4714.905233745339
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:48:55,087] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:48:55,145] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=4710.530341199156
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.15431005 ms
avg iteration GPU training time:346.71794545 ms
avg iteration (step) total cpu time:375.98796324 ms
Epoch Time(s): 8.2709
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.2650 | Train Acc 0.9270 | Speed (samples/sec) 33424.1598 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:01,101] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:01,164] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=4705.37249321419
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.28932953 ms
avg iteration GPU training time:317.95548040 ms
avg iteration (step) total cpu time:347.64387391 ms
Epoch Time(s): 7.9845
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.2578 | Train Acc 0.9279 | Speed (samples/sec) 33409.2971 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:06,762] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:06,825] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=4706.08138211184
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:10,289] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:10,353] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=4705.725321179809
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.79073160 ms
avg iteration GPU training time:309.25327370 ms
avg iteration (step) total cpu time:339.48620883 ms
Epoch Time(s): 7.7538
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.2748 | Train Acc 0.9268 | Speed (samples/sec) 33407.7690 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:16,086] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:16,148] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=4703.580140596155
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:19,627] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:19,690] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=4703.160156149051
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.48029960 ms
avg iteration GPU training time:322.27666959 ms
avg iteration (step) total cpu time:354.33372584 ms
Epoch Time(s): 7.9913
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.2754 | Train Acc 0.9226 | Speed (samples/sec) 33385.5479 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:25,656] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:25,719] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=4699.511807417864
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.71670706 ms
avg iteration GPU training time:336.19127586 ms
avg iteration (step) total cpu time:367.27393757 ms
Epoch Time(s): 8.2723
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.2729 | Train Acc 0.9242 | Speed (samples/sec) 33351.5190 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:31,563] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:31,626] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=4697.291333438223
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:35,060] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:35,121] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=4698.156728298859
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.83812332 ms
avg iteration GPU training time:311.49147172 ms
avg iteration (step) total cpu time:345.94102339 ms
Epoch Time(s): 7.8825
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2629 | Train Acc 0.9259 | Speed (samples/sec) 33351.8055 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:40,900] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:40,962] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=4698.228499688858
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.79753616 ms
avg iteration GPU training time:311.73092374 ms
avg iteration (step) total cpu time:342.93371981 ms
Epoch Time(s): 7.8517
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2813 | Train Acc 0.9243 | Speed (samples/sec) 33361.1525 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:46,586] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:46,647] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=4699.214649139529
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:50,197] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:50,260] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=4697.4477672319035
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.04250483 ms
avg iteration GPU training time:344.86178311 ms
avg iteration (step) total cpu time:374.60938367 ms
Epoch Time(s): 8.0869
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.2630 | Train Acc 0.9275 | Speed (samples/sec) 33337.9295 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:56,347] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:56,406] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=4692.715158312365
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:49:59,750] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:49:59,814] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=4694.002577741862
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.36259183 ms
avg iteration GPU training time:312.51352206 ms
avg iteration (step) total cpu time:341.41109206 ms
Epoch Time(s): 8.0855
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.2526 | Train Acc 0.9322 | Speed (samples/sec) 33333.2888 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:05,723] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:05,786] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=4693.864806270916
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.22779369 ms
avg iteration GPU training time:312.54182018 ms
avg iteration (step) total cpu time:342.94698455 ms
Epoch Time(s): 7.9765
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.2797 | Train Acc 0.9233 | Speed (samples/sec) 33336.1322 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:11,449] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:11,511] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=4693.892775809412
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:14,870] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:14,933] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=4695.121021109346
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.16752295 ms
avg iteration GPU training time:312.29168979 ms
avg iteration (step) total cpu time:341.83916179 ms
Epoch Time(s): 7.7801
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.2744 | Train Acc 0.9247 | Speed (samples/sec) 33343.4507 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:20,633] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:20,696] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=4694.854769594429
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.49217172 ms
avg iteration GPU training time:318.77228338 ms
avg iteration (step) total cpu time:352.51613097 ms
Epoch Time(s): 7.8258
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.2677 | Train Acc 0.9233 | Speed (samples/sec) 33342.7910 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:26,519] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:26,582] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=4696.065849139925
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:30,198] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:30,261] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=4693.716636630345
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.07939790 ms
avg iteration GPU training time:327.58547974 ms
avg iteration (step) total cpu time:357.53997889 ms
Epoch Time(s): 8.1828
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.2715 | Train Acc 0.9254 | Speed (samples/sec) 33333.4555 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:36,080] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:36,143] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=4694.050016790606
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:39,762] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:39,824] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=4691.291025100108
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:15.84471581 ms
avg iteration GPU training time:338.77442516 ms
avg iteration (step) total cpu time:367.36947840 ms
Epoch Time(s): 8.2000
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.2911 | Train Acc 0.9208 | Speed (samples/sec) 33310.6178 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:45,824] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:45,883] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=4688.798289593699
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.18606836 ms
avg iteration GPU training time:311.79665583 ms
avg iteration (step) total cpu time:342.09374948 ms
Epoch Time(s): 8.0601
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.2573 | Train Acc 0.9297 | Speed (samples/sec) 33304.9376 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:51,554] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:51,618] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=4688.878151482279
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:50:55,196] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:50:55,258] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=4687.081593071192
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.72279592 ms
avg iteration GPU training time:336.81339333 ms
avg iteration (step) total cpu time:367.28462306 ms
Epoch Time(s): 8.1121
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.2579 | Train Acc 0.9300 | Speed (samples/sec) 33283.9185 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:01,223] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:01,284] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=4684.0190393021285
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.22154765 ms
avg iteration GPU training time:329.25403664 ms
avg iteration (step) total cpu time:358.64186287 ms
Epoch Time(s): 8.1464
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.2563 | Train Acc 0.9277 | Speed (samples/sec) 33268.5016 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:07,091] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:07,153] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=4683.571785467072
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:10,554] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:10,618] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=4684.395055370203
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.47972367 ms
avg iteration GPU training time:310.96933261 ms
avg iteration (step) total cpu time:340.17339620 ms
Epoch Time(s): 7.8413
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.2731 | Train Acc 0.9276 | Speed (samples/sec) 33276.5412 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:16,409] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:16,473] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=4684.604892376032
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:19,762] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:19,826] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=4686.538159218638
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.44146911 ms
avg iteration GPU training time:304.97068648 ms
avg iteration (step) total cpu time:336.25370806 ms
Epoch Time(s): 7.8328
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.2648 | Train Acc 0.9289 | Speed (samples/sec) 33287.6318 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:25,586] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:25,650] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=4686.813144495782
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.30576593 ms
avg iteration GPU training time:309.92647483 ms
avg iteration (step) total cpu time:341.88606522 ms
Epoch Time(s): 7.8441
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.2682 | Train Acc 0.9269 | Speed (samples/sec) 33292.6135 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:31,315] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:31,378] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=4687.870010928233
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:34,884] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:34,948] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=4687.36464809766
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.60359287 ms
avg iteration GPU training time:322.03763927 ms
avg iteration (step) total cpu time:353.94748774 ms
Epoch Time(s): 7.9504
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.2738 | Train Acc 0.9265 | Speed (samples/sec) 33291.1613 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:40,650] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:40,713] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=4687.972398971065
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:18.14646981 ms
avg iteration GPU training time:310.81956621 ms
avg iteration (step) total cpu time:342.37673066 ms
Epoch Time(s): 7.8251
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.2591 | Train Acc 0.9298 | Speed (samples/sec) 33299.8011 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:46,422] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:46,485] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=4688.473249850015
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:50,147] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:50,200] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=4686.111677834221
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.19590976 ms
avg iteration GPU training time:335.16625699 ms
avg iteration (step) total cpu time:366.18971825 ms
Epoch Time(s): 8.1995
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.2636 | Train Acc 0.9262 | Speed (samples/sec) 33276.6825 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:56,182] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:56,239] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=4683.115575348609
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:51:59,676] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:51:59,739] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=4683.13183975929
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.55435354 ms
avg iteration GPU training time:323.56561279 ms
avg iteration (step) total cpu time:353.44513980 ms
Epoch Time(s): 8.1394
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.2725 | Train Acc 0.9234 | Speed (samples/sec) 33265.6654 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:05,608] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:05,667] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=4682.287657833165
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:15.73541520 ms
avg iteration GPU training time:313.84649381 ms
avg iteration (step) total cpu time:343.25974638 ms
Epoch Time(s): 7.9989
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.2589 | Train Acc 0.9302 | Speed (samples/sec) 33263.3856 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:11,465] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:11,528] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=4682.083605885101
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:15,188] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:15,251] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=4680.02094142294
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.61315779 ms
avg iteration GPU training time:333.44592563 ms
avg iteration (step) total cpu time:365.93870683 ms
Epoch Time(s): 8.1809
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.2616 | Train Acc 0.9262 | Speed (samples/sec) 33247.3283 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:21,197] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:21,260] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=4678.803424498638
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:18.26459937 ms
avg iteration GPU training time:335.17623901 ms
avg iteration (step) total cpu time:370.09044127 ms
Epoch Time(s): 8.3243
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.2694 | Train Acc 0.9244 | Speed (samples/sec) 33226.8116 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:27,280] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:27,342] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=4677.690064432107
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:30,713] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:30,775] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=4678.897144141743
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.24725819 ms
avg iteration GPU training time:311.12326050 ms
avg iteration (step) total cpu time:341.69132059 ms
Epoch Time(s): 7.8585
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.2598 | Train Acc 0.9281 | Speed (samples/sec) 33236.9711 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:36,648] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:36,712] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=4677.547614370222
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:40,021] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:40,083] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=4679.042309753388
-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.21902544 ms
avg iteration GPU training time:310.29726063 ms
avg iteration (step) total cpu time:339.66519616 ms
Epoch Time(s): 7.9127
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.2706 | Train Acc 0.9252 | Speed (samples/sec) 33237.0892 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:45,974] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:46,024] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=4677.211301732141
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:15.71662833 ms
avg iteration GPU training time:322.30376365 ms
avg iteration (step) total cpu time:351.53568875 ms
Epoch Time(s): 8.1150
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.2698 | Train Acc 0.9260 | Speed (samples/sec) 33225.5726 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:51,970] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:52,028] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=4675.74355629434
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25634765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:52:55,583] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:52:55,645] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=4674.542085224072
-----------------------------------------after batch engine step
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23291015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.25048828125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96142578125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95166015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95361328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95361328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.42891052 ms
avg iteration GPU training time:357.09303977 ms
avg iteration (step) total cpu time:385.99853082 ms
Epoch Time(s): 8.5482
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91455078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91455078125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.93798828125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96337890625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95361328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.2711 | Train Acc 0.9250 | Speed (samples/sec) 33199.6847 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91650390625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91650390625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.93994140625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.93994140625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95361328125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.93994140625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:01,840] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:01,903] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=4670.378106391458
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.93994140625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91650390625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91650390625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.93994140625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.93994140625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:15.88354908 ms
avg iteration GPU training time:325.56742720 ms
avg iteration (step) total cpu time:354.74280878 ms
Epoch Time(s): 8.0076
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.2743 | Train Acc 0.9264 | Speed (samples/sec) 33195.9999 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:07,706] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:07,768] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=4669.7335223003365
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:11,328] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:11,389] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=4668.862270412591
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.43818465 ms
avg iteration GPU training time:321.25649192 ms
avg iteration (step) total cpu time:352.39557786 ms
Epoch Time(s): 8.0429
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.2556 | Train Acc 0.9289 | Speed (samples/sec) 33188.4555 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:17,264] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:17,326] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=4668.039694414677
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:20,655] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:20,718] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=4669.385481974971
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.84152430 ms
avg iteration GPU training time:311.09579745 ms
avg iteration (step) total cpu time:341.39516137 ms
Epoch Time(s): 7.9349
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.2667 | Train Acc 0.9266 | Speed (samples/sec) 33189.7660 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:26,500] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:26,562] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=4668.846127939869
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.31300649 ms
avg iteration GPU training time:317.30788075 ms
avg iteration (step) total cpu time:348.32221811 ms
Epoch Time(s): 8.0197
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.2656 | Train Acc 0.9243 | Speed (samples/sec) 33187.2594 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:32,527] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:32,589] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=4668.222584642915
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:35,980] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:36,044] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=4668.954897415225
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.53940071 ms
avg iteration GPU training time:309.46709650 ms
avg iteration (step) total cpu time:338.94909512 ms
Epoch Time(s): 7.9785
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.2671 | Train Acc 0.9260 | Speed (samples/sec) 33190.7915 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:42,197] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:42,260] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=4667.773568525566
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.02114617 ms
avg iteration GPU training time:323.18780795 ms
avg iteration (step) total cpu time:354.03652625 ms
Epoch Time(s): 8.2904
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.2699 | Train Acc 0.9242 | Speed (samples/sec) 33182.5480 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:48,063] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:48,126] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=4668.230449404509
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:51,772] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:51,836] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=4668.81624369073
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.72625446 ms
avg iteration GPU training time:310.35726651 ms
avg iteration (step) total cpu time:339.71959894 ms
Epoch Time(s): 8.2147
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.2630 | Train Acc 0.9263 | Speed (samples/sec) 33178.9824 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:53:57,562] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:53:57,625] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=4668.405750595551
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:01,277] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:01,336] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=4666.466504746286
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.62239135 ms
avg iteration GPU training time:341.37240878 ms
avg iteration (step) total cpu time:372.06775492 ms
Epoch Time(s): 8.1687
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.2622 | Train Acc 0.9264 | Speed (samples/sec) 33161.4621 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:07,075] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:07,138] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=4665.9253259926445
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.65470860 ms
avg iteration GPU training time:311.35614846 ms
avg iteration (step) total cpu time:342.99568696 ms
Epoch Time(s): 7.8542
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.2618 | Train Acc 0.9262 | Speed (samples/sec) 33163.5575 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:12,830] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:12,893] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=4666.14253685081
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:16,503] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:16,565] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=4664.7719356098505
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.78344154 ms
avg iteration GPU training time:329.25507424 ms
avg iteration (step) total cpu time:360.45234854 ms
Epoch Time(s): 8.0388
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.2648 | Train Acc 0.9277 | Speed (samples/sec) 33153.5240 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:22,445] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:22,506] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=4663.477450590739
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.20514020 ms
avg iteration GPU training time:325.08003928 ms
avg iteration (step) total cpu time:355.45752265 ms
Epoch Time(s): 8.1205
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.2589 | Train Acc 0.9294 | Speed (samples/sec) 33144.7533 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:28,275] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:28,338] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=4663.345895883978
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:31,978] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:32,041] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=4661.805818996175
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:15.77467034 ms
avg iteration GPU training time:320.39523315 ms
avg iteration (step) total cpu time:350.44479370 ms
Epoch Time(s): 8.0199
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.2557 | Train Acc 0.9301 | Speed (samples/sec) 33141.1698 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:37,783] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:37,846] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=4662.0144014804855
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:41,324] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:41,387] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=4661.936915637918
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.14695852 ms
avg iteration GPU training time:324.16131869 ms
avg iteration (step) total cpu time:355.33883355 ms
Epoch Time(s): 8.0065
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.2641 | Train Acc 0.9258 | Speed (samples/sec) 33133.8380 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:47,055] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:47,117] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=4661.940345761702
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.27906036 ms
avg iteration GPU training time:309.36742054 ms
avg iteration (step) total cpu time:339.22316811 ms
Epoch Time(s): 7.7678
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.2642 | Train Acc 0.9290 | Speed (samples/sec) 33138.4316 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:52,753] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:52,816] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=4662.439834611713
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:54:56,487] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:54:56,549] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=4660.514269834106
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:15.92031999 ms
avg iteration GPU training time:343.04773782 ms
avg iteration (step) total cpu time:371.83354118 ms
Epoch Time(s): 8.1279
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.2613 | Train Acc 0.9283 | Speed (samples/sec) 33121.0789 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:55:02,362] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:55:02,419] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=4660.052066270049
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:17.16194612 ms
avg iteration GPU training time:310.47837691 ms
avg iteration (step) total cpu time:341.39756723 ms
Epoch Time(s): 7.8382
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.2495 | Train Acc 0.9296 | Speed (samples/sec) 33125.9990 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:55:08,030] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:55:08,093] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=4660.816658634512
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:55:11,526] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:55:11,590] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=4661.1426065481555
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.22815696 ms
avg iteration GPU training time:311.58654508 ms
avg iteration (step) total cpu time:340.59639411 ms
Epoch Time(s): 7.8243
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.2734 | Train Acc 0.9251 | Speed (samples/sec) 33131.6906 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:55:17,210] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:55:17,273] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=4661.751668488368
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:55:20,563] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:55:20,627] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=4663.274730813848
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.25852515 ms
avg iteration GPU training time:306.24272294 ms
avg iteration (step) total cpu time:336.35388721 ms
Epoch Time(s): 7.6512
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.2664 | Train Acc 0.9270 | Speed (samples/sec) 33145.4778 | GPU 17161.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.91845703125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

[2021-06-12 22:55:26,521] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:55:26,582] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=4662.58043858892
-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94384765625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96728515625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95947265625GB

Max Memory Allocated 16.758835315704346  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.92041015625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.94189453125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.96533203125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.95556640625GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.95751953125GB

Max Memory Allocated 16.758835315704346  GigaBytes

avg iteration(step) data from cpu to GPU time:16.86140789 ms
avg iteration GPU training time:317.26301159 ms
avg iteration (step) total cpu time:347.13701768 ms
Epoch Time(s): 8.0687
Eval Acc 0.9143
Test Acc: 0.7544
Avg epoch time(time.time()): 7913.726285099983 ms
total avg iteration(step) data from cpu to GPU time:16.75750083 ms
total avg iteration GPU training time:317.93161901 ms
total avg iteration (step) total cpu time:348.94537926 ms
