[2021-06-12 22:56:24,107] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-12 22:56:27,963] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 6245 --deepspeed_config ds_config.json
[2021-06-12 22:56:28,860] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-12 22:56:28,860] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-12 22:56:28,860] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-12 22:56:28,860] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-12 22:56:28,860] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623538594.3921509
before load_ogb step Time(s): 0.0019
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.1796875, 'VmSize': 20395.00390625, 'VmHWM': 1164.26171875, 'VmRSS': 1164.26171875}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6380
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2823
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0012
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.1364
-------------------------------------------------end of load ogb****************** step Time(s): 0.0022
finish constructing ogbn-products
load ogb-products time total: 2.0604169368743896
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0616
after inductive else step Time(s): 0.0001
after label step Time(s): 3.8298
after train_g.create_formats_() step Time(s): 1.6776
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 6245
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-12 22:56:41,993] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-12 22:56:41,995] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-12 22:56:41,999] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-12 22:56:44,352] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-12 22:56:44,354] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-12 22:56:44,354] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-12 22:56:44,354] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-12 22:56:44,355] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-12 22:56:44,355] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7fb3ce995908>
[2021-06-12 22:56:44,355] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:56:44,355] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-12 22:56:44,355] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-12 22:56:44,356] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-12 22:56:44,358] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.58837890625GB

Max Memory Allocated 1.1898789405822754  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.63330078125GB

Max Memory Allocated 1.1898789405822754  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 11.59228515625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 11.59228515625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 11.60400390625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 11.60400390625GB

Max Memory Allocated 9.887879848480225  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7270 | Train Acc 0.0311 | Speed (samples/sec) nan | GPU 10125.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 11.58056640625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 11.58056640625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 11.59423828125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08837890625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.887879848480225  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07861328125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07861328125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.09033203125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.887879848480225  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07275390625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07275390625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08837890625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.887879848480225  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07861328125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07861328125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.09033203125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes

[2021-06-12 22:56:48,999] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-12 22:56:49,031] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=6208.627476908991
-----------------------------------------after batch engine step
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08837890625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.887879848480225  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08837890625GB

Max Memory Allocated 9.887879848480225  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08837890625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.890732288360596  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07275390625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07275390625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes

[2021-06-12 22:56:51,650] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:56:51,682] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=6208.381304849733
-----------------------------------------after batch engine step
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08837890625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.890732288360596  GigaBytes

Epoch 00000 | Step 00020 | Loss 0.9757 | Train Acc 0.7486 | Speed (samples/sec) 23605.6344 | GPU 10128.1 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.890732288360596  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09423828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07275390625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07275390625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.08642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.08447265625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.08642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.08642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.06298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.06298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.07470703125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.08837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.08837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.08837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.08837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.06494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.06494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.07666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.08837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.08642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.08642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.08642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.06298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.06298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.07470703125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.08642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.08447265625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.08642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.08642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.06298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.06298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.07470703125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.08837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.08837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.08837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.08837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.06494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.06494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.07666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

[2021-06-12 22:56:54,272] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:56:54,304] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=6203.107794162512
-----------------------------------------after batch engine step
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.891451358795166  GigaBytes

avg iteration(step) data from cpu to GPU time:10.79428148 ms
avg iteration GPU training time:240.13661533 ms
avg iteration (step) total cpu time:260.90442693 ms
Epoch Time(s): 10.7041
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57470703125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

Epoch 00001 | Step 00000 | Loss 0.6072 | Train Acc 0.8548 | Speed (samples/sec) 22715.7929 | GPU 10128.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56298828125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

[2021-06-12 22:56:59,007] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:56:59,039] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=6265.963750948183
-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891451358795166  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56494140625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57666015625GB

Max Memory Allocated 9.891451358795166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.893043041229248  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.893043041229248  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.893043041229248  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.893043041229248  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.893043041229248  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.893043041229248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

[2021-06-12 22:57:01,756] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:01,788] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=6186.871322657659
-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

Epoch 00001 | Step 00020 | Loss 0.4999 | Train Acc 0.8761 | Speed (samples/sec) 23128.8117 | GPU 10136.3 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

[2021-06-12 22:57:04,419] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:04,451] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=6182.804929375573
-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

avg iteration(step) data from cpu to GPU time:9.67703109 ms
avg iteration GPU training time:244.31841250 ms
avg iteration (step) total cpu time:264.67962618 ms
Epoch Time(s): 10.6412
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.4171 | Train Acc 0.8930 | Speed (samples/sec) 22758.7938 | GPU 10136.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

[2021-06-12 22:57:08,768] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:08,800] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=6178.521084609527
-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

[2021-06-12 22:57:11,462] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:11,494] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=6161.593311430851
-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

Epoch 00002 | Step 00020 | Loss 0.4305 | Train Acc 0.8882 | Speed (samples/sec) 22983.2226 | GPU 10136.3 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes

[2021-06-12 22:57:13,938] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:13,961] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=6211.110904441099
-----------------------------------------after batch engine step
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56689453125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.898716926574707  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.898716926574707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05712890625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

avg iteration(step) data from cpu to GPU time:9.75863111 ms
avg iteration GPU training time:233.45304701 ms
avg iteration (step) total cpu time:253.04408427 ms
Epoch Time(s): 9.9701
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05712890625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.3899 | Train Acc 0.9002 | Speed (samples/sec) 22968.6106 | GPU 10144.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

[2021-06-12 22:57:18,160] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:18,192] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=6238.93985112843
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

[2021-06-12 22:57:20,708] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:20,740] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=6256.466133844057
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06689453125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

Epoch 00003 | Step 00020 | Loss 0.3759 | Train Acc 0.8999 | Speed (samples/sec) 23188.0071 | GPU 10144.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

[2021-06-12 22:57:23,312] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:23,345] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=6258.857747205858
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06689453125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05517578125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

avg iteration(step) data from cpu to GPU time:9.95409422 ms
avg iteration GPU training time:237.95338723 ms
avg iteration (step) total cpu time:258.23053607 ms
Epoch Time(s): 10.0311
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05712890625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.4025 | Train Acc 0.8983 | Speed (samples/sec) 22994.6241 | GPU 10144.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

[2021-06-12 22:57:27,980] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:28,013] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=6257.813943351372
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

[2021-06-12 22:57:30,483] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:30,515] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=6276.539848532137
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

Epoch 00004 | Step 00020 | Loss 0.3427 | Train Acc 0.9066 | Speed (samples/sec) 23268.9583 | GPU 10144.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

[2021-06-12 22:57:32,999] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:33,031] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=6292.621963325002
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

[2021-06-12 22:57:35,451] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:35,463] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=6315.413561315824
-----------------------------------------after batch engine step
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

avg iteration(step) data from cpu to GPU time:9.57762725 ms
avg iteration GPU training time:228.18991032 ms
avg iteration (step) total cpu time:247.75151853 ms
Epoch Time(s): 10.0179
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04345703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04345703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05712890625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.3420 | Train Acc 0.9116 | Speed (samples/sec) 23202.8521 | GPU 10144.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04541015625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

[2021-06-12 22:57:39,879] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:39,910] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=6293.921119104983
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.906928062438965  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.906928062438965  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:57:42,482] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:42,516] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=6293.84256852812
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00005 | Step 00020 | Loss 0.3683 | Train Acc 0.9062 | Speed (samples/sec) 23269.9831 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:57:44,984] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:45,017] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=6304.807402224288
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:10.09354554 ms
avg iteration GPU training time:233.82181690 ms
avg iteration (step) total cpu time:254.11823061 ms
Epoch Time(s): 9.9950
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.3543 | Train Acc 0.9042 | Speed (samples/sec) 23216.1443 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:57:49,120] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:49,153] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=6320.286850325056
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:57:51,544] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:51,578] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=6340.137588176445
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00006 | Step 00020 | Loss 0.3581 | Train Acc 0.9074 | Speed (samples/sec) 23443.3548 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:57:54,084] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:54,116] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=6343.367207424088
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.68960124 ms
avg iteration GPU training time:228.29227419 ms
avg iteration (step) total cpu time:247.43813939 ms
Epoch Time(s): 9.6525
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.3304 | Train Acc 0.9121 | Speed (samples/sec) 23340.0691 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:57:58,324] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:57:58,358] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=6347.905585671318
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:00,820] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:00,853] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=6355.880108765318
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00007 | Step 00020 | Loss 0.3268 | Train Acc 0.9132 | Speed (samples/sec) 23488.1229 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:03,283] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:03,316] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=6366.308280335613
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.41085754 ms
avg iteration GPU training time:225.80163405 ms
avg iteration (step) total cpu time:244.76280036 ms
Epoch Time(s): 9.6159
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3237 | Train Acc 0.9079 | Speed (samples/sec) 23455.1244 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:07,509] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:07,541] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=6370.984105615877
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:10,155] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:10,187] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=6363.922315854336
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00008 | Step 00020 | Loss 0.3158 | Train Acc 0.9179 | Speed (samples/sec) 23479.7520 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:12,813] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:12,843] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=6355.284638303453
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.59534456 ms
avg iteration GPU training time:237.64007116 ms
avg iteration (step) total cpu time:256.91353833 ms
Epoch Time(s): 10.0763
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3221 | Train Acc 0.9132 | Speed (samples/sec) 23427.4511 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:17,063] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:17,095] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=6358.103673769347
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:19,602] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:19,635] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=6361.177947043386
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00009 | Step 00020 | Loss 0.3225 | Train Acc 0.9114 | Speed (samples/sec) 23461.2251 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:22,253] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:22,286] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=6353.947465285373
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:24,732] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:24,743] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=6361.824419989828
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.95870341 ms
avg iteration GPU training time:235.12228733 ms
avg iteration (step) total cpu time:254.99108986 ms
Epoch Time(s): 9.9219
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3129 | Train Acc 0.9169 | Speed (samples/sec) 23416.9899 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:28,973] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:29,006] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=6360.299964379073
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:31,557] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:31,591] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=6359.032839951554
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00010 | Step 00020 | Loss 0.3271 | Train Acc 0.9098 | Speed (samples/sec) 23468.5972 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:34,006] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:34,040] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=6366.961892563245
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.53154603 ms
avg iteration GPU training time:231.18891850 ms
avg iteration (step) total cpu time:250.69099885 ms
Epoch Time(s): 9.7701
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3292 | Train Acc 0.9102 | Speed (samples/sec) 23452.9178 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:38,247] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:38,281] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=6368.6822495869565
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:40,861] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:40,894] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=6367.44698097826
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00011 | Step 00020 | Loss 0.3077 | Train Acc 0.9190 | Speed (samples/sec) 23492.7433 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:43,299] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:43,334] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=6375.427531867911
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:10.00346196 ms
avg iteration GPU training time:228.95277235 ms
avg iteration (step) total cpu time:249.40812146 ms
Epoch Time(s): 9.7401
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3147 | Train Acc 0.9118 | Speed (samples/sec) 23481.1916 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:47,604] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:47,638] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=6370.73234242671
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:50,021] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:50,054] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=6380.011603011493
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00012 | Step 00020 | Loss 0.3110 | Train Acc 0.9167 | Speed (samples/sec) 23552.6886 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:52,479] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:52,513] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=6386.00053443683
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.29594305 ms
avg iteration GPU training time:223.52372855 ms
avg iteration (step) total cpu time:242.50766083 ms
Epoch Time(s): 9.7254
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3118 | Train Acc 0.9153 | Speed (samples/sec) 23530.5227 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:56,734] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:56,768] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=6389.004994285148
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:58:59,336] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:58:59,370] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=6386.370082958678
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00013 | Step 00020 | Loss 0.3119 | Train Acc 0.9150 | Speed (samples/sec) 23552.7851 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:01,929] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:01,967] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=6383.927421909183
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.90474072 ms
avg iteration GPU training time:232.04714740 ms
avg iteration (step) total cpu time:251.70223801 ms
Epoch Time(s): 9.9110
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3277 | Train Acc 0.9132 | Speed (samples/sec) 23534.8460 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:06,108] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:06,142] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=6388.80934708544
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:08,672] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:08,706] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=6388.088191641233
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00014 | Step 00020 | Loss 0.3018 | Train Acc 0.9185 | Speed (samples/sec) 23571.8888 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:11,217] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:11,251] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=6388.650332475454
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:13,583] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:13,596] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=6399.361743182246
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.67251785 ms
avg iteration GPU training time:225.28900655 ms
avg iteration (step) total cpu time:244.65807279 ms
Epoch Time(s): 9.7099
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3134 | Train Acc 0.9129 | Speed (samples/sec) 23562.6788 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:17,770] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:17,804] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=6401.405451267336
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:20,332] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:20,366] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=6400.830865778845
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00015 | Step 00020 | Loss 0.3093 | Train Acc 0.9142 | Speed (samples/sec) 23618.0805 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:22,894] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:22,928] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=6399.551876339322
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.65844977 ms
avg iteration GPU training time:231.88619826 ms
avg iteration (step) total cpu time:251.33659222 ms
Epoch Time(s): 9.8407
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.2946 | Train Acc 0.9172 | Speed (samples/sec) 23575.7921 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:27,193] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:27,227] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=6399.6889353457045
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:29,778] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:29,813] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=6398.3749293892
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00016 | Step 00020 | Loss 0.3201 | Train Acc 0.9148 | Speed (samples/sec) 23600.2797 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:32,362] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:32,396] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=6396.541015263631
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:10.07868569 ms
avg iteration GPU training time:235.79842575 ms
avg iteration (step) total cpu time:255.85062416 ms
Epoch Time(s): 9.9715
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.3038 | Train Acc 0.9201 | Speed (samples/sec) 23559.2992 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:36,592] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:36,626] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=6398.699713460857
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:39,015] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:39,050] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=6404.465514173809
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00017 | Step 00020 | Loss 0.3140 | Train Acc 0.9155 | Speed (samples/sec) 23633.8018 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:41,458] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:41,492] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=6409.230691695488
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.39191942 ms
avg iteration GPU training time:221.61366102 ms
avg iteration (step) total cpu time:240.50938642 ms
Epoch Time(s): 9.4897
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.2970 | Train Acc 0.9230 | Speed (samples/sec) 23620.7087 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:45,733] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:45,767] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=6408.050952721691
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:48,312] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:48,346] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=6406.585445691823
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00018 | Step 00020 | Loss 0.3202 | Train Acc 0.9143 | Speed (samples/sec) 23651.7641 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:50,765] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:50,799] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=6410.849812259683
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.70525992 ms
avg iteration GPU training time:231.05784155 ms
avg iteration (step) total cpu time:250.39322288 ms
Epoch Time(s): 9.9687
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.2889 | Train Acc 0.9222 | Speed (samples/sec) 23615.3797 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:55,171] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:55,205] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=6407.264610030679
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 22:59:57,759] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 22:59:57,792] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=6406.82375835289
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00019 | Step 00020 | Loss 0.3031 | Train Acc 0.9155 | Speed (samples/sec) 23625.1546 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:00,356] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:00,390] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=6404.909517725742
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:02,905] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:02,918] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=6405.085121456975
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:10.39826496 ms
avg iteration GPU training time:235.82577063 ms
avg iteration (step) total cpu time:256.19852101 ms
Epoch Time(s): 10.0625
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.2787 | Train Acc 0.9207 | Speed (samples/sec) 23590.0783 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:07,074] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:07,107] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=6408.516393302773
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:09,501] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:09,535] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=6413.287725947593
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00020 | Step 00020 | Loss 0.3177 | Train Acc 0.9118 | Speed (samples/sec) 23651.7880 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:11,889] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:11,924] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=6419.030983229556
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.22588799 ms
avg iteration GPU training time:219.72057823 ms
avg iteration (step) total cpu time:238.69123282 ms
Epoch Time(s): 9.4307
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.2681 | Train Acc 0.9265 | Speed (samples/sec) 23648.8510 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:15,996] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:16,029] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=6424.310581749036
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:18,593] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:18,627] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=6422.446291562807
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00021 | Step 00020 | Loss 0.3055 | Train Acc 0.9183 | Speed (samples/sec) 23672.9299 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:21,149] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:21,183] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=6421.582337284402
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.76136296 ms
avg iteration GPU training time:232.23950195 ms
avg iteration (step) total cpu time:252.25735594 ms
Epoch Time(s): 9.7318
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.3226 | Train Acc 0.9092 | Speed (samples/sec) 23651.1255 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:25,375] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:25,409] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=6423.845225870985
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:27,884] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:27,918] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=6425.155942472582
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00022 | Step 00020 | Loss 0.3094 | Train Acc 0.9143 | Speed (samples/sec) 23679.9782 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:30,425] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:30,459] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=6425.430218293015
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.85192896 ms
avg iteration GPU training time:227.73875032 ms
avg iteration (step) total cpu time:247.42624495 ms
Epoch Time(s): 9.7405
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.2857 | Train Acc 0.9214 | Speed (samples/sec) 23666.6250 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:34,523] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:34,556] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=6429.346063048281
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:37,091] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:37,125] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=6428.513348425658
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00023 | Step 00020 | Loss 0.3115 | Train Acc 0.9151 | Speed (samples/sec) 23685.4472 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:39,646] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:39,680] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=6428.548736969724
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.50073604 ms
avg iteration GPU training time:228.61502358 ms
avg iteration (step) total cpu time:248.57994362 ms
Epoch Time(s): 9.7417
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.2906 | Train Acc 0.9207 | Speed (samples/sec) 23680.2187 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:44,190] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:44,224] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=6431.665093092205
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:46,610] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:46,645] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=6435.587940374388
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00024 | Step 00020 | Loss 0.2895 | Train Acc 0.9236 | Speed (samples/sec) 23695.8159 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:49,364] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:49,398] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=6428.080511501881
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:51,795] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:51,808] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=6431.979831977007
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.62089244 ms
avg iteration GPU training time:234.20287125 ms
avg iteration (step) total cpu time:253.48071699 ms
Epoch Time(s): 10.2449
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.3142 | Train Acc 0.9145 | Speed (samples/sec) 23678.0796 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:56,019] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:56,053] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=6432.220993001669
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:00:58,459] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:00:58,493] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=6435.35955313171
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00025 | Step 00020 | Loss 0.3021 | Train Acc 0.9183 | Speed (samples/sec) 23719.7161 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:00,860] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:00,894] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=6439.552469951019
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.61826245 ms
avg iteration GPU training time:220.43499360 ms
avg iteration (step) total cpu time:239.61641170 ms
Epoch Time(s): 9.5109
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2885 | Train Acc 0.9219 | Speed (samples/sec) 23714.5606 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:04,994] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:05,027] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=6443.423221686626
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:07,425] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:07,458] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=6446.514328426552
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00026 | Step 00020 | Loss 0.2971 | Train Acc 0.9172 | Speed (samples/sec) 23754.9693 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:09,843] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:09,877] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=6449.868360210065
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:9.22848470 ms
avg iteration GPU training time:221.35804466 ms
avg iteration (step) total cpu time:239.94407830 ms
Epoch Time(s): 9.4978
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2941 | Train Acc 0.9207 | Speed (samples/sec) 23751.4538 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:14,024] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:14,058] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=6451.827523252454
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:16,598] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:16,632] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=6450.48136271593
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00027 | Step 00020 | Loss 0.2904 | Train Acc 0.9230 | Speed (samples/sec) 23759.9904 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:19,160] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:19,195] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=6450.016278033323
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:10.17407053 ms
avg iteration GPU training time:233.88023942 ms
avg iteration (step) total cpu time:254.53142767 ms
Epoch Time(s): 9.8214
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.3067 | Train Acc 0.9156 | Speed (samples/sec) 23739.1888 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:23,425] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:23,459] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=6447.273659546782
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:26,017] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:26,051] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=6445.638338167937
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00028 | Step 00020 | Loss 0.2879 | Train Acc 0.9219 | Speed (samples/sec) 23744.1226 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:28,554] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:28,587] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=6445.801395507738
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:10.15610317 ms
avg iteration GPU training time:232.43580740 ms
avg iteration (step) total cpu time:252.49539481 ms
Epoch Time(s): 9.9392
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2707 | Train Acc 0.9235 | Speed (samples/sec) 23725.2192 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:32,837] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:32,871] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=6445.039044103561
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:35,483] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:35,517] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=6442.1614033221595
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00029 | Step 00020 | Loss 0.3066 | Train Acc 0.9164 | Speed (samples/sec) 23725.3008 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:38,082] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:38,116] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=6441.035536387794
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:40,685] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:40,698] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=6439.222147342328
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

avg iteration(step) data from cpu to GPU time:10.82595435 ms
avg iteration GPU training time:238.52000088 ms
avg iteration (step) total cpu time:259.45126569 ms
Epoch Time(s): 10.1367
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2920 | Train Acc 0.9249 | Speed (samples/sec) 23695.1493 | GPU 10159.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:44,831] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:44,865] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=6442.20727735939
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:47,388] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:47,422] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=6441.404257591647
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

Epoch 00030 | Step 00020 | Loss 0.3019 | Train Acc 0.9179 | Speed (samples/sec) 23722.1707 | GPU 10159.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes

[2021-06-12 23:01:49,911] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:49,945] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=6441.326420050038
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.9216628074646  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.9216628074646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.27302173 ms
avg iteration GPU training time:229.59182570 ms
avg iteration (step) total cpu time:248.38912929 ms
Epoch Time(s): 9.7032
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.3126 | Train Acc 0.9158 | Speed (samples/sec) 23706.4712 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:01:54,093] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:54,127] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=6444.175329486111
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:01:56,515] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:56,550] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=6447.088512010456
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00031 | Step 00020 | Loss 0.2855 | Train Acc 0.9241 | Speed (samples/sec) 23743.3685 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:01:58,923] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:01:58,956] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=6450.075067560502
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.35063104 ms
avg iteration GPU training time:221.55098696 ms
avg iteration (step) total cpu time:240.33270059 ms
Epoch Time(s): 9.4950
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.3097 | Train Acc 0.9195 | Speed (samples/sec) 23736.5046 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:03,154] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:03,188] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=6450.163502783704
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:05,788] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:05,822] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=6447.481442047138
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00032 | Step 00020 | Loss 0.2950 | Train Acc 0.9179 | Speed (samples/sec) 23737.1744 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:08,327] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:08,362] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=6447.101361248154
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.59722545 ms
avg iteration GPU training time:232.22067261 ms
avg iteration (step) total cpu time:251.34072480 ms
Epoch Time(s): 9.8580
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2901 | Train Acc 0.9207 | Speed (samples/sec) 23735.4009 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:12,564] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:12,599] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=6447.441393318535
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:15,205] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:15,239] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=6444.969828613224
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00033 | Step 00020 | Loss 0.3005 | Train Acc 0.9185 | Speed (samples/sec) 23725.9794 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:17,903] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:17,937] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=6441.094014330808
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.01522017 ms
avg iteration GPU training time:241.30180133 ms
avg iteration (step) total cpu time:261.54995848 ms
Epoch Time(s): 10.1904
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.3222 | Train Acc 0.9135 | Speed (samples/sec) 23705.0804 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:22,196] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:22,230] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=6439.649360151356
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:24,863] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:24,896] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=6436.714496767561
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00034 | Step 00020 | Loss 0.2941 | Train Acc 0.9204 | Speed (samples/sec) 23703.3721 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:27,480] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:27,510] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=6434.84120876176
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:29,973] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:29,987] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=6436.040510226806
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.11054330 ms
avg iteration GPU training time:234.73234784 ms
avg iteration (step) total cpu time:254.92780297 ms
Epoch Time(s): 10.0220
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2897 | Train Acc 0.9172 | Speed (samples/sec) 23685.6959 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:34,351] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:34,385] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=6432.206273269746
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:37,041] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:37,074] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=6428.786869480208
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00035 | Step 00020 | Loss 0.2828 | Train Acc 0.9227 | Speed (samples/sec) 23678.7805 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:39,628] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:39,662] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=6427.523086042272
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.11942152 ms
avg iteration GPU training time:242.73784101 ms
avg iteration (step) total cpu time:263.02101877 ms
Epoch Time(s): 10.1055
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.3005 | Train Acc 0.9190 | Speed (samples/sec) 23660.0824 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:43,885] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:43,918] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=6426.141692408934
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:46,446] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:46,480] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=6425.833486499979
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00036 | Step 00020 | Loss 0.3105 | Train Acc 0.9171 | Speed (samples/sec) 23666.7489 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:49,015] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:49,049] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=6425.122898672262
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.97881589 ms
avg iteration GPU training time:234.22577469 ms
avg iteration (step) total cpu time:254.12008497 ms
Epoch Time(s): 9.9218
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2773 | Train Acc 0.9241 | Speed (samples/sec) 23650.1023 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:53,381] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:53,415] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=6423.260958010545
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:55,804] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:55,838] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=6425.909082623726
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00037 | Step 00020 | Loss 0.2910 | Train Acc 0.9193 | Speed (samples/sec) 23672.2207 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:02:58,246] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:02:58,281] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=6427.897766622096
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.34628981 ms
avg iteration GPU training time:222.33675921 ms
avg iteration (step) total cpu time:241.23707524 ms
Epoch Time(s): 9.6748
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.3042 | Train Acc 0.9222 | Speed (samples/sec) 23668.7551 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:02,344] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:02,378] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=6431.238050847196
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:04,862] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:04,896] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=6431.878285661472
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00038 | Step 00020 | Loss 0.3073 | Train Acc 0.9153 | Speed (samples/sec) 23689.5605 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:07,382] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:07,416] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=6432.273099625432
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.44628159 ms
avg iteration GPU training time:229.71831993 ms
avg iteration (step) total cpu time:249.03400739 ms
Epoch Time(s): 9.6779
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.3073 | Train Acc 0.9175 | Speed (samples/sec) 23678.2669 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:11,663] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:11,697] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=6432.444024477751
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:14,245] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:14,279] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=6431.440410940048
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00039 | Step 00020 | Loss 0.3020 | Train Acc 0.9185 | Speed (samples/sec) 23680.3703 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:16,909] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:16,944] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=6428.68465974396
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:19,442] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:19,455] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=6429.098301082583
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.77228804 ms
avg iteration GPU training time:236.55048794 ms
avg iteration (step) total cpu time:256.32075027 ms
Epoch Time(s): 10.0962
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2916 | Train Acc 0.9180 | Speed (samples/sec) 23663.3448 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:23,672] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:23,717] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=6429.3557829316815
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:26,117] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:26,151] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=6431.537710711372
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00040 | Step 00020 | Loss 0.2942 | Train Acc 0.9206 | Speed (samples/sec) 23690.3451 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:28,510] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:28,544] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=6434.225305698701
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.18411728 ms
avg iteration GPU training time:221.04536608 ms
avg iteration (step) total cpu time:239.70507692 ms
Epoch Time(s): 9.5701
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.3195 | Train Acc 0.9167 | Speed (samples/sec) 23688.1360 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:32,709] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:32,743] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=6435.331732006159
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:35,259] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:35,293] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=6434.837227226438
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00041 | Step 00020 | Loss 0.3001 | Train Acc 0.9196 | Speed (samples/sec) 23706.6799 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:37,671] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:37,705] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=6437.1723262898195
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.37804690 ms
avg iteration GPU training time:226.39621367 ms
avg iteration (step) total cpu time:245.29814720 ms
Epoch Time(s): 9.6051
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2867 | Train Acc 0.9209 | Speed (samples/sec) 23701.0580 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:41,914] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:41,948] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=6437.082196486212
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:44,513] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:44,547] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=6435.935699677
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00042 | Step 00020 | Loss 0.3046 | Train Acc 0.9198 | Speed (samples/sec) 23707.6019 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:47,093] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:47,126] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=6435.420043926611
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.98998522 ms
avg iteration GPU training time:236.27742909 ms
avg iteration (step) total cpu time:256.62478694 ms
Epoch Time(s): 10.0008
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2977 | Train Acc 0.9198 | Speed (samples/sec) 23690.1381 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:51,392] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:51,426] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=6434.622502992792
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:54,019] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:54,053] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=6433.407116425449
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00043 | Step 00020 | Loss 0.3133 | Train Acc 0.9139 | Speed (samples/sec) 23693.2913 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:03:56,612] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:03:56,646] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=6432.481983470579
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.24005567 ms
avg iteration GPU training time:231.81384447 ms
avg iteration (step) total cpu time:253.17011939 ms
Epoch Time(s): 9.9160
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.2953 | Train Acc 0.9193 | Speed (samples/sec) 23685.4184 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:00,749] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:00,782] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=6435.442845028528
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:03,255] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:03,288] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=6436.092133483369
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00044 | Step 00020 | Loss 0.3074 | Train Acc 0.9166 | Speed (samples/sec) 23706.9659 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:05,711] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:05,745] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=6437.536589300566
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:08,086] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:08,098] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=6440.48812944365
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.16227800 ms
avg iteration GPU training time:223.75373727 ms
avg iteration (step) total cpu time:242.61015433 ms
Epoch Time(s): 9.5860
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.3035 | Train Acc 0.9185 | Speed (samples/sec) 23703.5860 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:12,487] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:12,521] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=6438.042882481813
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:14,918] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:14,952] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=6440.064553255948
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00045 | Step 00020 | Loss 0.3014 | Train Acc 0.9172 | Speed (samples/sec) 23719.9228 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:17,359] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:17,393] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=6441.6032197487975
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.54750338 ms
avg iteration GPU training time:223.60990736 ms
avg iteration (step) total cpu time:242.93321150 ms
Epoch Time(s): 9.7162
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.2972 | Train Acc 0.9188 | Speed (samples/sec) 23714.7998 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:21,777] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:21,811] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=6439.132074452119
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:24,479] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:24,513] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=6436.010424769304
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00046 | Step 00020 | Loss 0.2934 | Train Acc 0.9174 | Speed (samples/sec) 23705.5605 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:27,011] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:27,044] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=6436.018008405987
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.81913484 ms
avg iteration GPU training time:239.66578109 ms
avg iteration (step) total cpu time:259.28671272 ms
Epoch Time(s): 10.1460
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2973 | Train Acc 0.9172 | Speed (samples/sec) 23696.9297 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:31,362] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:31,396] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=6433.709943070844
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:33,810] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:33,844] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=6435.166112671214
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00047 | Step 00020 | Loss 0.2950 | Train Acc 0.9164 | Speed (samples/sec) 23708.7396 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:36,272] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:36,306] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=6436.34641382157
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.37338305 ms
avg iteration GPU training time:227.59568052 ms
avg iteration (step) total cpu time:246.39411326 ms
Epoch Time(s): 9.7863
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.2992 | Train Acc 0.9172 | Speed (samples/sec) 23700.0399 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:40,496] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:40,529] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=6436.574095593048
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:42,939] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:42,972] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=6438.6285066773335
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00048 | Step 00020 | Loss 0.2907 | Train Acc 0.9193 | Speed (samples/sec) 23726.3132 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:45,348] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:45,382] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=6440.744203338991
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.75052087 ms
avg iteration GPU training time:218.73730921 ms
avg iteration (step) total cpu time:237.75056556 ms
Epoch Time(s): 9.4303
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.3805 | Train Acc 0.9212 | Speed (samples/sec) 23725.3133 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:49,382] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:49,415] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=6443.878461392846
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:51,827] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:51,860] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=6445.451921842035
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00049 | Step 00020 | Loss 0.3036 | Train Acc 0.9196 | Speed (samples/sec) 23749.7682 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:54,246] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:54,281] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=6447.296186408175
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:04:56,646] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:04:56,659] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=6449.669024816555
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.24239648 ms
avg iteration GPU training time:221.19991331 ms
avg iteration (step) total cpu time:240.24874193 ms
Epoch Time(s): 9.4412
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.3172 | Train Acc 0.9111 | Speed (samples/sec) 23744.8859 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:05:00,869] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:05:00,903] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=6449.654345125864
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:05:03,550] [INFO] [logging.py:60:log_dist] [Rank 0] step=1620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:05:03,585] [INFO] [timer.py:160:stop] 0/1620, SamplesPerSec=6446.9844963942205
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00050 | Step 00020 | Loss 0.2896 | Train Acc 0.9214 | Speed (samples/sec) 23748.7018 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:05:06,023] [INFO] [logging.py:60:log_dist] [Rank 0] step=1630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:05:06,057] [INFO] [timer.py:160:stop] 0/1630, SamplesPerSec=6448.069021379249
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.12704111 ms
avg iteration GPU training time:232.42977001 ms
avg iteration (step) total cpu time:251.98097582 ms
Epoch Time(s): 9.8311
Eval Acc 0.9073
Test Acc: 0.7473
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.3051 | Train Acc 0.9161 | Speed (samples/sec) 23741.8910 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:25,758] [INFO] [logging.py:60:log_dist] [Rank 0] step=1640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:25,792] [INFO] [timer.py:160:stop] 0/1640, SamplesPerSec=6447.280051791227
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:28,524] [INFO] [logging.py:60:log_dist] [Rank 0] step=1650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:28,556] [INFO] [timer.py:160:stop] 0/1650, SamplesPerSec=6443.621299812517
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00051 | Step 00020 | Loss 0.2999 | Train Acc 0.9175 | Speed (samples/sec) 23734.8149 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:31,117] [INFO] [logging.py:60:log_dist] [Rank 0] step=1660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:31,151] [INFO] [timer.py:160:stop] 0/1660, SamplesPerSec=6442.569777005249
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.34238218 ms
avg iteration GPU training time:243.45150926 ms
avg iteration (step) total cpu time:263.94986223 ms
Epoch Time(s): 10.4663
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.3210 | Train Acc 0.9153 | Speed (samples/sec) 23721.1374 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:35,427] [INFO] [logging.py:60:log_dist] [Rank 0] step=1670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:35,460] [INFO] [timer.py:160:stop] 0/1670, SamplesPerSec=6441.3127155402335
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:38,026] [INFO] [logging.py:60:log_dist] [Rank 0] step=1680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:38,060] [INFO] [timer.py:160:stop] 0/1680, SamplesPerSec=6440.635170163531
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00052 | Step 00020 | Loss 0.3112 | Train Acc 0.9159 | Speed (samples/sec) 23714.2414 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:40,914] [INFO] [logging.py:60:log_dist] [Rank 0] step=1690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:40,948] [INFO] [timer.py:160:stop] 0/1690, SamplesPerSec=6435.181446829314
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:11.00023114 ms
avg iteration GPU training time:251.82495965 ms
avg iteration (step) total cpu time:274.16479146 ms
Epoch Time(s): 10.5349
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.3049 | Train Acc 0.9201 | Speed (samples/sec) 23685.8989 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:45,550] [INFO] [logging.py:60:log_dist] [Rank 0] step=1700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:45,584] [INFO] [timer.py:160:stop] 0/1700, SamplesPerSec=6430.392859389596
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:48,297] [INFO] [logging.py:60:log_dist] [Rank 0] step=1710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:48,331] [INFO] [timer.py:160:stop] 0/1710, SamplesPerSec=6427.168538608864
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00053 | Step 00020 | Loss 0.3131 | Train Acc 0.9137 | Speed (samples/sec) 23675.7634 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:50,999] [INFO] [logging.py:60:log_dist] [Rank 0] step=1720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:51,033] [INFO] [timer.py:160:stop] 0/1720, SamplesPerSec=6424.668395291165
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.92401895 ms
avg iteration GPU training time:241.85784347 ms
avg iteration (step) total cpu time:261.81778201 ms
Epoch Time(s): 10.3313
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.3101 | Train Acc 0.9180 | Speed (samples/sec) 23663.7908 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:55,263] [INFO] [logging.py:60:log_dist] [Rank 0] step=1730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:55,297] [INFO] [timer.py:160:stop] 0/1730, SamplesPerSec=6425.177033546512
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:06:58,031] [INFO] [logging.py:60:log_dist] [Rank 0] step=1740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:06:58,061] [INFO] [timer.py:160:stop] 0/1740, SamplesPerSec=6422.015629478142
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00054 | Step 00020 | Loss 0.3218 | Train Acc 0.9156 | Speed (samples/sec) 23658.3280 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:00,655] [INFO] [logging.py:60:log_dist] [Rank 0] step=1750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:00,685] [INFO] [timer.py:160:stop] 0/1750, SamplesPerSec=6420.792787712938
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:03,453] [INFO] [logging.py:60:log_dist] [Rank 0] step=1760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:03,462] [INFO] [timer.py:160:stop] 0/1760, SamplesPerSec=6416.9957765653835
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.51812377 ms
avg iteration GPU training time:251.08262352 ms
avg iteration (step) total cpu time:270.99487517 ms
Epoch Time(s): 10.4514
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.3182 | Train Acc 0.9122 | Speed (samples/sec) 23633.0304 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:07,785] [INFO] [logging.py:60:log_dist] [Rank 0] step=1770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:07,819] [INFO] [timer.py:160:stop] 0/1770, SamplesPerSec=6414.640340349564
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:10,627] [INFO] [logging.py:60:log_dist] [Rank 0] step=1780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:10,661] [INFO] [timer.py:160:stop] 0/1780, SamplesPerSec=6410.173557149625
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00055 | Step 00020 | Loss 0.3057 | Train Acc 0.9148 | Speed (samples/sec) 23622.8724 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:13,289] [INFO] [logging.py:60:log_dist] [Rank 0] step=1790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:13,323] [INFO] [timer.py:160:stop] 0/1790, SamplesPerSec=6408.426295569974
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.52831992 ms
avg iteration GPU training time:249.47880385 ms
avg iteration (step) total cpu time:269.81457958 ms
Epoch Time(s): 10.3147
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.3155 | Train Acc 0.9106 | Speed (samples/sec) 23609.3292 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:17,674] [INFO] [logging.py:60:log_dist] [Rank 0] step=1800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:17,707] [INFO] [timer.py:160:stop] 0/1800, SamplesPerSec=6406.287281442925
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:20,296] [INFO] [logging.py:60:log_dist] [Rank 0] step=1810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:20,330] [INFO] [timer.py:160:stop] 0/1810, SamplesPerSec=6405.342540436155
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00056 | Step 00020 | Loss 0.3035 | Train Acc 0.9166 | Speed (samples/sec) 23601.0452 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:23,216] [INFO] [logging.py:60:log_dist] [Rank 0] step=1820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:23,250] [INFO] [timer.py:160:stop] 0/1820, SamplesPerSec=6400.024229728236
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.46986779 ms
avg iteration GPU training time:254.14488616 ms
avg iteration (step) total cpu time:275.42442746 ms
Epoch Time(s): 10.6030
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.3058 | Train Acc 0.9148 | Speed (samples/sec) 23572.7730 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:27,733] [INFO] [logging.py:60:log_dist] [Rank 0] step=1830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:27,768] [INFO] [timer.py:160:stop] 0/1830, SamplesPerSec=6396.287157580935
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:30,252] [INFO] [logging.py:60:log_dist] [Rank 0] step=1840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:30,286] [INFO] [timer.py:160:stop] 0/1840, SamplesPerSec=6396.601112197145
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00057 | Step 00020 | Loss 0.2966 | Train Acc 0.9174 | Speed (samples/sec) 23573.9565 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:33,034] [INFO] [logging.py:60:log_dist] [Rank 0] step=1850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:33,068] [INFO] [timer.py:160:stop] 0/1850, SamplesPerSec=6393.119778174332
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.33046415 ms
avg iteration GPU training time:242.15643028 ms
avg iteration (step) total cpu time:260.99358665 ms
Epoch Time(s): 10.1969
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2999 | Train Acc 0.9230 | Speed (samples/sec) 23558.9879 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:37,625] [INFO] [logging.py:60:log_dist] [Rank 0] step=1860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:37,659] [INFO] [timer.py:160:stop] 0/1860, SamplesPerSec=6390.455128592474
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:40,449] [INFO] [logging.py:60:log_dist] [Rank 0] step=1870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:40,482] [INFO] [timer.py:160:stop] 0/1870, SamplesPerSec=6386.729587308011
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00058 | Step 00020 | Loss 0.3132 | Train Acc 0.9167 | Speed (samples/sec) 23543.2566 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:43,085] [INFO] [logging.py:60:log_dist] [Rank 0] step=1880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:43,120] [INFO] [timer.py:160:stop] 0/1880, SamplesPerSec=6385.677711713923
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.19720289 ms
avg iteration GPU training time:244.31473909 ms
avg iteration (step) total cpu time:264.74522661 ms
Epoch Time(s): 10.5938
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.3067 | Train Acc 0.9151 | Speed (samples/sec) 23533.1647 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:47,380] [INFO] [logging.py:60:log_dist] [Rank 0] step=1890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:47,412] [INFO] [timer.py:160:stop] 0/1890, SamplesPerSec=6385.408066858712
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:50,271] [INFO] [logging.py:60:log_dist] [Rank 0] step=1900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:50,305] [INFO] [timer.py:160:stop] 0/1900, SamplesPerSec=6380.767270018388
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00059 | Step 00020 | Loss 0.2950 | Train Acc 0.9201 | Speed (samples/sec) 23520.1351 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:52,967] [INFO] [logging.py:60:log_dist] [Rank 0] step=1910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:53,001] [INFO] [timer.py:160:stop] 0/1910, SamplesPerSec=6378.90808504325
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:07:55,468] [INFO] [logging.py:60:log_dist] [Rank 0] step=1920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:07:55,481] [INFO] [timer.py:160:stop] 0/1920, SamplesPerSec=6379.888266590986
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.20310879 ms
avg iteration GPU training time:245.65298744 ms
avg iteration (step) total cpu time:265.93422007 ms
Epoch Time(s): 10.3388
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.2665 | Train Acc 0.9284 | Speed (samples/sec) 23511.5522 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:00,039] [INFO] [logging.py:60:log_dist] [Rank 0] step=1930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:00,073] [INFO] [timer.py:160:stop] 0/1930, SamplesPerSec=6375.53136555807
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:02,671] [INFO] [logging.py:60:log_dist] [Rank 0] step=1940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:02,704] [INFO] [timer.py:160:stop] 0/1940, SamplesPerSec=6374.566402761472
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00060 | Step 00020 | Loss 0.3047 | Train Acc 0.9187 | Speed (samples/sec) 23504.8166 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:05,456] [INFO] [logging.py:60:log_dist] [Rank 0] step=1950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:05,490] [INFO] [timer.py:160:stop] 0/1950, SamplesPerSec=6371.281862409052
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.93677869 ms
avg iteration GPU training time:249.70612759 ms
avg iteration (step) total cpu time:269.47121267 ms
Epoch Time(s): 10.5133
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.3149 | Train Acc 0.9143 | Speed (samples/sec) 23486.5832 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:10,053] [INFO] [logging.py:60:log_dist] [Rank 0] step=1960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:10,087] [INFO] [timer.py:160:stop] 0/1960, SamplesPerSec=6367.166326084116
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:12,552] [INFO] [logging.py:60:log_dist] [Rank 0] step=1970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:12,586] [INFO] [timer.py:160:stop] 0/1970, SamplesPerSec=6367.87792874302
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00061 | Step 00020 | Loss 0.2925 | Train Acc 0.9172 | Speed (samples/sec) 23489.9987 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:15,094] [INFO] [logging.py:60:log_dist] [Rank 0] step=1980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:15,129] [INFO] [timer.py:160:stop] 0/1980, SamplesPerSec=6368.025052748594
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.23245398 ms
avg iteration GPU training time:234.54126824 ms
avg iteration (step) total cpu time:253.30135557 ms
Epoch Time(s): 10.0762
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.3184 | Train Acc 0.9135 | Speed (samples/sec) 23481.5470 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:19,283] [INFO] [logging.py:60:log_dist] [Rank 0] step=1990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:19,317] [INFO] [timer.py:160:stop] 0/1990, SamplesPerSec=6369.368009408199
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:22,028] [INFO] [logging.py:60:log_dist] [Rank 0] step=2000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:22,062] [INFO] [timer.py:160:stop] 0/2000, SamplesPerSec=6366.960609993804
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00062 | Step 00020 | Loss 0.3229 | Train Acc 0.9143 | Speed (samples/sec) 23484.1846 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:24,529] [INFO] [logging.py:60:log_dist] [Rank 0] step=2010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:24,563] [INFO] [timer.py:160:stop] 0/2010, SamplesPerSec=6367.649964424183
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.93711177 ms
avg iteration GPU training time:234.72782333 ms
avg iteration (step) total cpu time:254.00651826 ms
Epoch Time(s): 9.8376
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.3210 | Train Acc 0.9105 | Speed (samples/sec) 23483.9865 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:28,767] [INFO] [logging.py:60:log_dist] [Rank 0] step=2020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:28,801] [INFO] [timer.py:160:stop] 0/2020, SamplesPerSec=6367.242076731731
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:31,461] [INFO] [logging.py:60:log_dist] [Rank 0] step=2030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:31,495] [INFO] [timer.py:160:stop] 0/2030, SamplesPerSec=6365.751343100764
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00063 | Step 00020 | Loss 0.3064 | Train Acc 0.9132 | Speed (samples/sec) 23480.7263 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:34,063] [INFO] [logging.py:60:log_dist] [Rank 0] step=2040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:34,095] [INFO] [timer.py:160:stop] 0/2040, SamplesPerSec=6365.47276151294
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.43834314 ms
avg iteration GPU training time:239.00906090 ms
avg iteration (step) total cpu time:259.68870410 ms
Epoch Time(s): 10.2240
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.3428 | Train Acc 0.9082 | Speed (samples/sec) 23470.5595 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:38,406] [INFO] [logging.py:60:log_dist] [Rank 0] step=2050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:38,439] [INFO] [timer.py:160:stop] 0/2050, SamplesPerSec=6364.959223525455
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:41,196] [INFO] [logging.py:60:log_dist] [Rank 0] step=2060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:41,230] [INFO] [timer.py:160:stop] 0/2060, SamplesPerSec=6361.993411784323
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00064 | Step 00020 | Loss 0.3097 | Train Acc 0.9191 | Speed (samples/sec) 23460.7877 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:43,963] [INFO] [logging.py:60:log_dist] [Rank 0] step=2070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:43,998] [INFO] [timer.py:160:stop] 0/2070, SamplesPerSec=6359.635002135407
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:46,444] [INFO] [logging.py:60:log_dist] [Rank 0] step=2080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:46,457] [INFO] [timer.py:160:stop] 0/2080, SamplesPerSec=6360.741277356229
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.22037808 ms
avg iteration GPU training time:245.37346677 ms
avg iteration (step) total cpu time:265.56276392 ms
Epoch Time(s): 10.3174
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.3227 | Train Acc 0.9119 | Speed (samples/sec) 23453.8833 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:50,934] [INFO] [logging.py:60:log_dist] [Rank 0] step=2090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:50,968] [INFO] [timer.py:160:stop] 0/2090, SamplesPerSec=6357.346021693593
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:53,504] [INFO] [logging.py:60:log_dist] [Rank 0] step=2100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:53,538] [INFO] [timer.py:160:stop] 0/2100, SamplesPerSec=6357.219885254521
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00065 | Step 00020 | Loss 0.3279 | Train Acc 0.9148 | Speed (samples/sec) 23453.6638 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:08:56,123] [INFO] [logging.py:60:log_dist] [Rank 0] step=2110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:08:56,157] [INFO] [timer.py:160:stop] 0/2110, SamplesPerSec=6356.870144879512
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.71427317 ms
avg iteration GPU training time:238.19486378 ms
avg iteration (step) total cpu time:258.48701265 ms
Epoch Time(s): 10.1495
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.3145 | Train Acc 0.9126 | Speed (samples/sec) 23445.2676 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:00,499] [INFO] [logging.py:60:log_dist] [Rank 0] step=2120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:00,533] [INFO] [timer.py:160:stop] 0/2120, SamplesPerSec=6356.708018990098
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:03,091] [INFO] [logging.py:60:log_dist] [Rank 0] step=2130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:03,125] [INFO] [timer.py:160:stop] 0/2130, SamplesPerSec=6356.525776925347
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00066 | Step 00020 | Loss 0.3111 | Train Acc 0.9177 | Speed (samples/sec) 23449.1472 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:05,737] [INFO] [logging.py:60:log_dist] [Rank 0] step=2140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:05,772] [INFO] [timer.py:160:stop] 0/2140, SamplesPerSec=6355.412483682541
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.84257423 ms
avg iteration GPU training time:240.33125362 ms
avg iteration (step) total cpu time:260.34681002 ms
Epoch Time(s): 10.1827
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.3191 | Train Acc 0.9105 | Speed (samples/sec) 23436.7081 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:10,073] [INFO] [logging.py:60:log_dist] [Rank 0] step=2150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:10,107] [INFO] [timer.py:160:stop] 0/2150, SamplesPerSec=6355.380810860295
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:12,529] [INFO] [logging.py:60:log_dist] [Rank 0] step=2160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:12,563] [INFO] [timer.py:160:stop] 0/2160, SamplesPerSec=6356.662576965092
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00067 | Step 00020 | Loss 0.3217 | Train Acc 0.9114 | Speed (samples/sec) 23451.0427 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:15,087] [INFO] [logging.py:60:log_dist] [Rank 0] step=2170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:15,121] [INFO] [timer.py:160:stop] 0/2170, SamplesPerSec=6356.728737884988
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.45771615 ms
avg iteration GPU training time:227.43196389 ms
avg iteration (step) total cpu time:246.27022390 ms
Epoch Time(s): 9.7526
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.3199 | Train Acc 0.9122 | Speed (samples/sec) 23447.6203 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:19,194] [INFO] [logging.py:60:log_dist] [Rank 0] step=2180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:19,228] [INFO] [timer.py:160:stop] 0/2180, SamplesPerSec=6359.149172134568
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:21,864] [INFO] [logging.py:60:log_dist] [Rank 0] step=2190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:21,899] [INFO] [timer.py:160:stop] 0/2190, SamplesPerSec=6358.100461205433
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00068 | Step 00020 | Loss 0.3334 | Train Acc 0.9092 | Speed (samples/sec) 23451.6744 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:24,484] [INFO] [logging.py:60:log_dist] [Rank 0] step=2200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:24,518] [INFO] [timer.py:160:stop] 0/2200, SamplesPerSec=6357.440812429412
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.96813398 ms
avg iteration GPU training time:238.70548616 ms
avg iteration (step) total cpu time:258.62642571 ms
Epoch Time(s): 9.9870
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.3101 | Train Acc 0.9142 | Speed (samples/sec) 23442.7850 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:28,766] [INFO] [logging.py:60:log_dist] [Rank 0] step=2210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:28,800] [INFO] [timer.py:160:stop] 0/2210, SamplesPerSec=6357.1132474015985
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:31,500] [INFO] [logging.py:60:log_dist] [Rank 0] step=2220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:31,534] [INFO] [timer.py:160:stop] 0/2220, SamplesPerSec=6354.973061816155
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00069 | Step 00020 | Loss 0.3193 | Train Acc 0.9105 | Speed (samples/sec) 23434.8797 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:34,361] [INFO] [logging.py:60:log_dist] [Rank 0] step=2230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:34,395] [INFO] [timer.py:160:stop] 0/2230, SamplesPerSec=6351.442486488094
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:37,013] [INFO] [logging.py:60:log_dist] [Rank 0] step=2240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:37,027] [INFO] [timer.py:160:stop] 0/2240, SamplesPerSec=6350.6058035154865
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.13770905 ms
avg iteration GPU training time:253.55080499 ms
avg iteration (step) total cpu time:273.16728345 ms
Epoch Time(s): 10.5063
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.3070 | Train Acc 0.9131 | Speed (samples/sec) 23420.0969 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:41,556] [INFO] [logging.py:60:log_dist] [Rank 0] step=2250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:41,590] [INFO] [timer.py:160:stop] 0/2250, SamplesPerSec=6347.3860457903165
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:44,305] [INFO] [logging.py:60:log_dist] [Rank 0] step=2260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:44,339] [INFO] [timer.py:160:stop] 0/2260, SamplesPerSec=6345.282721400761
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00070 | Step 00020 | Loss 0.2976 | Train Acc 0.9183 | Speed (samples/sec) 23411.2055 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:47,156] [INFO] [logging.py:60:log_dist] [Rank 0] step=2270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:47,190] [INFO] [timer.py:160:stop] 0/2270, SamplesPerSec=6341.965279400848
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.05220740 ms
avg iteration GPU training time:257.19392508 ms
avg iteration (step) total cpu time:277.04694536 ms
Epoch Time(s): 10.6576
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.3036 | Train Acc 0.9193 | Speed (samples/sec) 23391.4388 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:51,607] [INFO] [logging.py:60:log_dist] [Rank 0] step=2280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:51,641] [INFO] [timer.py:160:stop] 0/2280, SamplesPerSec=6339.516800799955
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:54,111] [INFO] [logging.py:60:log_dist] [Rank 0] step=2290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:54,145] [INFO] [timer.py:160:stop] 0/2290, SamplesPerSec=6340.245927109258
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00071 | Step 00020 | Loss 0.3103 | Train Acc 0.9179 | Speed (samples/sec) 23395.6264 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:09:56,846] [INFO] [logging.py:60:log_dist] [Rank 0] step=2300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:09:56,881] [INFO] [timer.py:160:stop] 0/2300, SamplesPerSec=6338.169686896463
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.37625714 ms
avg iteration GPU training time:240.64341566 ms
avg iteration (step) total cpu time:259.65917552 ms
Epoch Time(s): 10.1337
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.3325 | Train Acc 0.9134 | Speed (samples/sec) 23383.2091 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:01,198] [INFO] [logging.py:60:log_dist] [Rank 0] step=2310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:01,233] [INFO] [timer.py:160:stop] 0/2310, SamplesPerSec=6336.841184144427
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:03,798] [INFO] [logging.py:60:log_dist] [Rank 0] step=2320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:03,832] [INFO] [timer.py:160:stop] 0/2320, SamplesPerSec=6336.416684238538
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00072 | Step 00020 | Loss 0.3299 | Train Acc 0.9102 | Speed (samples/sec) 23382.1765 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:06,576] [INFO] [logging.py:60:log_dist] [Rank 0] step=2330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:06,610] [INFO] [timer.py:160:stop] 0/2330, SamplesPerSec=6334.059545662403
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.26735414 ms
avg iteration GPU training time:244.77854863 ms
avg iteration (step) total cpu time:263.96138580 ms
Epoch Time(s): 10.2882
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.2957 | Train Acc 0.9155 | Speed (samples/sec) 23370.7999 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:11,246] [INFO] [logging.py:60:log_dist] [Rank 0] step=2340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:11,279] [INFO] [timer.py:160:stop] 0/2340, SamplesPerSec=6333.180199278755
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:13,898] [INFO] [logging.py:60:log_dist] [Rank 0] step=2350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:13,932] [INFO] [timer.py:160:stop] 0/2350, SamplesPerSec=6332.3546017487415
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00073 | Step 00020 | Loss 0.3144 | Train Acc 0.9153 | Speed (samples/sec) 23368.0115 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:16,475] [INFO] [logging.py:60:log_dist] [Rank 0] step=2360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:16,509] [INFO] [timer.py:160:stop] 0/2360, SamplesPerSec=6332.374942149823
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.61952241 ms
avg iteration GPU training time:231.45071694 ms
avg iteration (step) total cpu time:251.12892963 ms
Epoch Time(s): 10.2340
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.3231 | Train Acc 0.9089 | Speed (samples/sec) 23368.7213 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:20,698] [INFO] [logging.py:60:log_dist] [Rank 0] step=2370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:20,731] [INFO] [timer.py:160:stop] 0/2370, SamplesPerSec=6333.853631285036
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:23,409] [INFO] [logging.py:60:log_dist] [Rank 0] step=2380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:23,443] [INFO] [timer.py:160:stop] 0/2380, SamplesPerSec=6332.225455761376
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00074 | Step 00020 | Loss 0.3310 | Train Acc 0.9078 | Speed (samples/sec) 23373.4489 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:25,896] [INFO] [logging.py:60:log_dist] [Rank 0] step=2390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:25,930] [INFO] [timer.py:160:stop] 0/2390, SamplesPerSec=6333.190665650681
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:28,271] [INFO] [logging.py:60:log_dist] [Rank 0] step=2400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:28,284] [INFO] [timer.py:160:stop] 0/2400, SamplesPerSec=6335.3558284268665
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.33079342 ms
avg iteration GPU training time:229.35721673 ms
avg iteration (step) total cpu time:248.48858515 ms
Epoch Time(s): 9.9859
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.3341 | Train Acc 0.9116 | Speed (samples/sec) 23372.7617 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:32,582] [INFO] [logging.py:60:log_dist] [Rank 0] step=2410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:32,616] [INFO] [timer.py:160:stop] 0/2410, SamplesPerSec=6335.563106354747
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:35,032] [INFO] [logging.py:60:log_dist] [Rank 0] step=2420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:35,065] [INFO] [timer.py:160:stop] 0/2420, SamplesPerSec=6336.8571283476585
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00075 | Step 00020 | Loss 0.3209 | Train Acc 0.9106 | Speed (samples/sec) 23388.6468 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:37,690] [INFO] [logging.py:60:log_dist] [Rank 0] step=2430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:37,720] [INFO] [timer.py:160:stop] 0/2430, SamplesPerSec=6335.885428439463
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.56070158 ms
avg iteration GPU training time:233.57149364 ms
avg iteration (step) total cpu time:252.88941242 ms
Epoch Time(s): 9.8554
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.3349 | Train Acc 0.9090 | Speed (samples/sec) 23376.9770 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:42,223] [INFO] [logging.py:60:log_dist] [Rank 0] step=2440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:42,256] [INFO] [timer.py:160:stop] 0/2440, SamplesPerSec=6332.909678596053
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:44,912] [INFO] [logging.py:60:log_dist] [Rank 0] step=2450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:44,946] [INFO] [timer.py:160:stop] 0/2450, SamplesPerSec=6331.776186899019
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00076 | Step 00020 | Loss 0.3471 | Train Acc 0.9054 | Speed (samples/sec) 23372.4747 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:47,475] [INFO] [logging.py:60:log_dist] [Rank 0] step=2460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:47,509] [INFO] [timer.py:160:stop] 0/2460, SamplesPerSec=6331.860013485457
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.06519226 ms
avg iteration GPU training time:241.49775865 ms
avg iteration (step) total cpu time:261.72577010 ms
Epoch Time(s): 10.3071
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.3261 | Train Acc 0.9113 | Speed (samples/sec) 23364.8460 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:51,783] [INFO] [logging.py:60:log_dist] [Rank 0] step=2470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:51,817] [INFO] [timer.py:160:stop] 0/2470, SamplesPerSec=6331.7007336981615
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:54,444] [INFO] [logging.py:60:log_dist] [Rank 0] step=2480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:54,478] [INFO] [timer.py:160:stop] 0/2480, SamplesPerSec=6330.661469693263
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00077 | Step 00020 | Loss 0.3553 | Train Acc 0.9046 | Speed (samples/sec) 23369.8442 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:10:56,976] [INFO] [logging.py:60:log_dist] [Rank 0] step=2490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:10:57,010] [INFO] [timer.py:160:stop] 0/2490, SamplesPerSec=6330.9687413422425
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.01347197 ms
avg iteration GPU training time:234.93365139 ms
avg iteration (step) total cpu time:253.33868133 ms
Epoch Time(s): 9.9317
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.3283 | Train Acc 0.9103 | Speed (samples/sec) 23366.5495 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:01,236] [INFO] [logging.py:60:log_dist] [Rank 0] step=2500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:01,270] [INFO] [timer.py:160:stop] 0/2500, SamplesPerSec=6331.413857002731
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:03,945] [INFO] [logging.py:60:log_dist] [Rank 0] step=2510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:03,980] [INFO] [timer.py:160:stop] 0/2510, SamplesPerSec=6330.069169539086
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00078 | Step 00020 | Loss 0.3586 | Train Acc 0.9041 | Speed (samples/sec) 23360.3187 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:06,750] [INFO] [logging.py:60:log_dist] [Rank 0] step=2520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:06,784] [INFO] [timer.py:160:stop] 0/2520, SamplesPerSec=6327.646279316164
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.90227212 ms
avg iteration GPU training time:256.94989522 ms
avg iteration (step) total cpu time:276.76341269 ms
Epoch Time(s): 10.5938
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.3121 | Train Acc 0.9156 | Speed (samples/sec) 23345.6659 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:11,305] [INFO] [logging.py:60:log_dist] [Rank 0] step=2530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:11,338] [INFO] [timer.py:160:stop] 0/2530, SamplesPerSec=6325.119107053954
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:14,072] [INFO] [logging.py:60:log_dist] [Rank 0] step=2540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:14,105] [INFO] [timer.py:160:stop] 0/2540, SamplesPerSec=6323.270519110058
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00079 | Step 00020 | Loss 0.3531 | Train Acc 0.9033 | Speed (samples/sec) 23347.2738 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:16,588] [INFO] [logging.py:60:log_dist] [Rank 0] step=2550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:16,622] [INFO] [timer.py:160:stop] 0/2550, SamplesPerSec=6323.955317654821
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:19,399] [INFO] [logging.py:60:log_dist] [Rank 0] step=2560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:19,411] [INFO] [timer.py:160:stop] 0/2560, SamplesPerSec=6321.57440977183
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.14661927 ms
avg iteration GPU training time:246.03804073 ms
avg iteration (step) total cpu time:265.82196024 ms
Epoch Time(s): 10.4239
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.3340 | Train Acc 0.9076 | Speed (samples/sec) 23331.5324 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:24,197] [INFO] [logging.py:60:log_dist] [Rank 0] step=2570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:24,231] [INFO] [timer.py:160:stop] 0/2570, SamplesPerSec=6318.436335806013
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:27,094] [INFO] [logging.py:60:log_dist] [Rank 0] step=2580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:27,128] [INFO] [timer.py:160:stop] 0/2580, SamplesPerSec=6315.244116025967
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00080 | Step 00020 | Loss 0.3478 | Train Acc 0.9028 | Speed (samples/sec) 23318.1169 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:29,687] [INFO] [logging.py:60:log_dist] [Rank 0] step=2590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:29,721] [INFO] [timer.py:160:stop] 0/2590, SamplesPerSec=6315.145291026176
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.40318102 ms
avg iteration GPU training time:253.13833618 ms
avg iteration (step) total cpu time:273.99418972 ms
Epoch Time(s): 10.7382
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.3463 | Train Acc 0.9023 | Speed (samples/sec) 23310.1482 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:34,052] [INFO] [logging.py:60:log_dist] [Rank 0] step=2600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:34,086] [INFO] [timer.py:160:stop] 0/2600, SamplesPerSec=6314.685508853945
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:36,552] [INFO] [logging.py:60:log_dist] [Rank 0] step=2610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:36,586] [INFO] [timer.py:160:stop] 0/2610, SamplesPerSec=6315.479587928664
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00081 | Step 00020 | Loss 0.3147 | Train Acc 0.9132 | Speed (samples/sec) 23319.3706 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:39,106] [INFO] [logging.py:60:log_dist] [Rank 0] step=2620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:39,140] [INFO] [timer.py:160:stop] 0/2620, SamplesPerSec=6315.641733130279
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.40982744 ms
avg iteration GPU training time:229.44259417 ms
avg iteration (step) total cpu time:248.56284813 ms
Epoch Time(s): 9.8588
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.3444 | Train Acc 0.9055 | Speed (samples/sec) 23315.4586 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:43,327] [INFO] [logging.py:60:log_dist] [Rank 0] step=2630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:43,361] [INFO] [timer.py:160:stop] 0/2630, SamplesPerSec=6315.900906171379
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:45,874] [INFO] [logging.py:60:log_dist] [Rank 0] step=2640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:45,908] [INFO] [timer.py:160:stop] 0/2640, SamplesPerSec=6316.2674766633445
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00082 | Step 00020 | Loss 0.3487 | Train Acc 0.9050 | Speed (samples/sec) 23322.1069 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:48,449] [INFO] [logging.py:60:log_dist] [Rank 0] step=2650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:48,483] [INFO] [timer.py:160:stop] 0/2650, SamplesPerSec=6316.311867930812
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.79078288 ms
avg iteration GPU training time:233.81535509 ms
avg iteration (step) total cpu time:253.53289534 ms
Epoch Time(s): 9.9579
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.3472 | Train Acc 0.9018 | Speed (samples/sec) 23314.9837 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:52,940] [INFO] [logging.py:60:log_dist] [Rank 0] step=2660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:52,974] [INFO] [timer.py:160:stop] 0/2660, SamplesPerSec=6316.140608605628
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:55,771] [INFO] [logging.py:60:log_dist] [Rank 0] step=2670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:55,805] [INFO] [timer.py:160:stop] 0/2670, SamplesPerSec=6313.601796011292
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00083 | Step 00020 | Loss 0.3467 | Train Acc 0.9017 | Speed (samples/sec) 23310.0085 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:11:58,386] [INFO] [logging.py:60:log_dist] [Rank 0] step=2680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:11:58,420] [INFO] [timer.py:160:stop] 0/2680, SamplesPerSec=6313.2005155162915
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.45944187 ms
avg iteration GPU training time:247.52591677 ms
avg iteration (step) total cpu time:266.35765146 ms
Epoch Time(s): 10.4707
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.3443 | Train Acc 0.9004 | Speed (samples/sec) 23302.8732 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:02,731] [INFO] [logging.py:60:log_dist] [Rank 0] step=2690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:02,764] [INFO] [timer.py:160:stop] 0/2690, SamplesPerSec=6312.615549144901
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:05,266] [INFO] [logging.py:60:log_dist] [Rank 0] step=2700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:05,300] [INFO] [timer.py:160:stop] 0/2700, SamplesPerSec=6313.184351934351
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00084 | Step 00020 | Loss 0.3838 | Train Acc 0.8996 | Speed (samples/sec) 23310.3244 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:07,905] [INFO] [logging.py:60:log_dist] [Rank 0] step=2710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:07,938] [INFO] [timer.py:160:stop] 0/2710, SamplesPerSec=6312.700222371096
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:10,449] [INFO] [logging.py:60:log_dist] [Rank 0] step=2720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:10,462] [INFO] [timer.py:160:stop] 0/2720, SamplesPerSec=6313.136963783368
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.80865305 ms
avg iteration GPU training time:237.73156964 ms
avg iteration (step) total cpu time:257.64636640 ms
Epoch Time(s): 10.0058
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.3497 | Train Acc 0.9038 | Speed (samples/sec) 23302.6721 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:14,838] [INFO] [logging.py:60:log_dist] [Rank 0] step=2730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:14,871] [INFO] [timer.py:160:stop] 0/2730, SamplesPerSec=6312.177200208523
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:17,495] [INFO] [logging.py:60:log_dist] [Rank 0] step=2740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:17,529] [INFO] [timer.py:160:stop] 0/2740, SamplesPerSec=6311.429380390604
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00085 | Step 00020 | Loss 0.3616 | Train Acc 0.9023 | Speed (samples/sec) 23305.8453 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:19,935] [INFO] [logging.py:60:log_dist] [Rank 0] step=2750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:19,969] [INFO] [timer.py:160:stop] 0/2750, SamplesPerSec=6312.70642596765
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.58026434 ms
avg iteration GPU training time:232.52425356 ms
avg iteration (step) total cpu time:252.10137720 ms
Epoch Time(s): 9.9584
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.3788 | Train Acc 0.8954 | Speed (samples/sec) 23305.4100 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:24,348] [INFO] [logging.py:60:log_dist] [Rank 0] step=2760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:24,381] [INFO] [timer.py:160:stop] 0/2760, SamplesPerSec=6311.823687478844
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:27,011] [INFO] [logging.py:60:log_dist] [Rank 0] step=2770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:27,044] [INFO] [timer.py:160:stop] 0/2770, SamplesPerSec=6311.034706096738
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00086 | Step 00020 | Loss 0.3756 | Train Acc 0.8946 | Speed (samples/sec) 23305.0061 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:29,576] [INFO] [logging.py:60:log_dist] [Rank 0] step=2780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:29,610] [INFO] [timer.py:160:stop] 0/2780, SamplesPerSec=6311.134398761842
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.71716030 ms
avg iteration GPU training time:241.19553517 ms
avg iteration (step) total cpu time:260.59274320 ms
Epoch Time(s): 10.1847
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.3968 | Train Acc 0.8894 | Speed (samples/sec) 23299.1078 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:33,916] [INFO] [logging.py:60:log_dist] [Rank 0] step=2790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:33,950] [INFO] [timer.py:160:stop] 0/2790, SamplesPerSec=6311.108474877142
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:36,498] [INFO] [logging.py:60:log_dist] [Rank 0] step=2800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:36,532] [INFO] [timer.py:160:stop] 0/2800, SamplesPerSec=6311.113415325684
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00087 | Step 00020 | Loss 0.3862 | Train Acc 0.8914 | Speed (samples/sec) 23303.1090 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:39,213] [INFO] [logging.py:60:log_dist] [Rank 0] step=2810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:39,247] [INFO] [timer.py:160:stop] 0/2810, SamplesPerSec=6309.819428383114
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.46311122 ms
avg iteration GPU training time:245.77225523 ms
avg iteration (step) total cpu time:265.21898199 ms
Epoch Time(s): 10.2286
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.3887 | Train Acc 0.8962 | Speed (samples/sec) 23290.0623 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:43,737] [INFO] [logging.py:60:log_dist] [Rank 0] step=2820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:43,770] [INFO] [timer.py:160:stop] 0/2820, SamplesPerSec=6307.330207193919
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:46,504] [INFO] [logging.py:60:log_dist] [Rank 0] step=2830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:46,538] [INFO] [timer.py:160:stop] 0/2830, SamplesPerSec=6305.629380332254
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00088 | Step 00020 | Loss 0.4153 | Train Acc 0.8831 | Speed (samples/sec) 23282.8557 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:49,260] [INFO] [logging.py:60:log_dist] [Rank 0] step=2840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:49,294] [INFO] [timer.py:160:stop] 0/2840, SamplesPerSec=6304.353714731309
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.66730201 ms
avg iteration GPU training time:245.68862802 ms
avg iteration (step) total cpu time:266.67694692 ms
Epoch Time(s): 10.4216
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.4022 | Train Acc 0.8887 | Speed (samples/sec) 23276.5050 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:53,528] [INFO] [logging.py:60:log_dist] [Rank 0] step=2850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:53,561] [INFO] [timer.py:160:stop] 0/2850, SamplesPerSec=6304.720134982803
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:56,457] [INFO] [logging.py:60:log_dist] [Rank 0] step=2860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:56,491] [INFO] [timer.py:160:stop] 0/2860, SamplesPerSec=6301.753917012019
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00089 | Step 00020 | Loss 0.4109 | Train Acc 0.8895 | Speed (samples/sec) 23268.7722 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:12:59,172] [INFO] [logging.py:60:log_dist] [Rank 0] step=2870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:12:59,206] [INFO] [timer.py:160:stop] 0/2870, SamplesPerSec=6300.607749189523
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:01,688] [INFO] [logging.py:60:log_dist] [Rank 0] step=2880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:01,701] [INFO] [timer.py:160:stop] 0/2880, SamplesPerSec=6301.3673852905
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.59209599 ms
avg iteration GPU training time:247.57980121 ms
avg iteration (step) total cpu time:268.15346435 ms
Epoch Time(s): 10.4007
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.4108 | Train Acc 0.8849 | Speed (samples/sec) 23263.1993 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:05,976] [INFO] [logging.py:60:log_dist] [Rank 0] step=2890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:06,010] [INFO] [timer.py:160:stop] 0/2890, SamplesPerSec=6300.7561669982515
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:08,508] [INFO] [logging.py:60:log_dist] [Rank 0] step=2900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:08,543] [INFO] [timer.py:160:stop] 0/2900, SamplesPerSec=6301.276334778528
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00090 | Step 00020 | Loss 0.4681 | Train Acc 0.8705 | Speed (samples/sec) 23271.5115 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:11,171] [INFO] [logging.py:60:log_dist] [Rank 0] step=2910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:11,205] [INFO] [timer.py:160:stop] 0/2910, SamplesPerSec=6300.490723869718
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.01434422 ms
avg iteration GPU training time:237.86390008 ms
avg iteration (step) total cpu time:257.54340490 ms
Epoch Time(s): 10.0248
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.4454 | Train Acc 0.8685 | Speed (samples/sec) 23261.2507 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:15,963] [INFO] [logging.py:60:log_dist] [Rank 0] step=2920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:15,997] [INFO] [timer.py:160:stop] 0/2920, SamplesPerSec=6298.619496797729
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:18,783] [INFO] [logging.py:60:log_dist] [Rank 0] step=2930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:18,817] [INFO] [timer.py:160:stop] 0/2930, SamplesPerSec=6296.55121741547
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00091 | Step 00020 | Loss 0.4959 | Train Acc 0.8655 | Speed (samples/sec) 23248.3912 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:21,569] [INFO] [logging.py:60:log_dist] [Rank 0] step=2940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:21,603] [INFO] [timer.py:160:stop] 0/2940, SamplesPerSec=6294.801224060573
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:10.07312119 ms
avg iteration GPU training time:255.20307470 ms
avg iteration (step) total cpu time:275.33352817 ms
Epoch Time(s): 10.9089
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.4877 | Train Acc 0.8674 | Speed (samples/sec) 23240.1133 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:26,117] [INFO] [logging.py:60:log_dist] [Rank 0] step=2950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:26,151] [INFO] [timer.py:160:stop] 0/2950, SamplesPerSec=6294.078621718776
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:28,663] [INFO] [logging.py:60:log_dist] [Rank 0] step=2960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:28,697] [INFO] [timer.py:160:stop] 0/2960, SamplesPerSec=6294.379903314735
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00092 | Step 00020 | Loss 0.4845 | Train Acc 0.8673 | Speed (samples/sec) 23247.4550 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:31,080] [INFO] [logging.py:60:log_dist] [Rank 0] step=2970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:31,114] [INFO] [timer.py:160:stop] 0/2970, SamplesPerSec=6295.845362415571
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.29928758 ms
avg iteration GPU training time:225.69293213 ms
avg iteration (step) total cpu time:244.99463152 ms
Epoch Time(s): 9.9199
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4857 | Train Acc 0.8650 | Speed (samples/sec) 23247.2879 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:35,311] [INFO] [logging.py:60:log_dist] [Rank 0] step=2980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:35,339] [INFO] [timer.py:160:stop] 0/2980, SamplesPerSec=6296.4784627960735
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:37,986] [INFO] [logging.py:60:log_dist] [Rank 0] step=2990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:38,020] [INFO] [timer.py:160:stop] 0/2990, SamplesPerSec=6295.7207966983415
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00093 | Step 00020 | Loss 0.4940 | Train Acc 0.8610 | Speed (samples/sec) 23251.2959 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:40,546] [INFO] [logging.py:60:log_dist] [Rank 0] step=3000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:40,580] [INFO] [timer.py:160:stop] 0/3000, SamplesPerSec=6295.972123064483
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.65323372 ms
avg iteration GPU training time:238.83855862 ms
avg iteration (step) total cpu time:258.55818501 ms
Epoch Time(s): 10.1042
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.5109 | Train Acc 0.8581 | Speed (samples/sec) 23243.5403 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:44,922] [INFO] [logging.py:60:log_dist] [Rank 0] step=3010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:44,954] [INFO] [timer.py:160:stop] 0/3010, SamplesPerSec=6295.2878358075295
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:47,556] [INFO] [logging.py:60:log_dist] [Rank 0] step=3020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:47,589] [INFO] [timer.py:160:stop] 0/3020, SamplesPerSec=6294.854432972673
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00094 | Step 00020 | Loss 0.4904 | Train Acc 0.8626 | Speed (samples/sec) 23250.4773 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:50,067] [INFO] [logging.py:60:log_dist] [Rank 0] step=3030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:50,100] [INFO] [timer.py:160:stop] 0/3030, SamplesPerSec=6295.510489636903
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:52,426] [INFO] [logging.py:60:log_dist] [Rank 0] step=3040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:52,438] [INFO] [timer.py:160:stop] 0/3040, SamplesPerSec=6297.433006016527
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.07174527 ms
avg iteration GPU training time:225.90636642 ms
avg iteration (step) total cpu time:244.43163695 ms
Epoch Time(s): 9.8125
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.5153 | Train Acc 0.8600 | Speed (samples/sec) 23250.8462 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:57,061] [INFO] [logging.py:60:log_dist] [Rank 0] step=3050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:57,095] [INFO] [timer.py:160:stop] 0/3050, SamplesPerSec=6295.812253854188
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:13:59,694] [INFO] [logging.py:60:log_dist] [Rank 0] step=3060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:13:59,727] [INFO] [timer.py:160:stop] 0/3060, SamplesPerSec=6295.484142265194
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00095 | Step 00020 | Loss 0.5488 | Train Acc 0.8448 | Speed (samples/sec) 23251.3813 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:14:02,099] [INFO] [logging.py:60:log_dist] [Rank 0] step=3070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:02,133] [INFO] [timer.py:160:stop] 0/3070, SamplesPerSec=6296.923622064963
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.84350581 ms
avg iteration GPU training time:236.75845789 ms
avg iteration (step) total cpu time:256.08390349 ms
Epoch Time(s): 10.1995
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.5054 | Train Acc 0.8613 | Speed (samples/sec) 23250.2065 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:14:06,860] [INFO] [logging.py:60:log_dist] [Rank 0] step=3080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:06,893] [INFO] [timer.py:160:stop] 0/3080, SamplesPerSec=6296.917462993656
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:14:09,329] [INFO] [logging.py:60:log_dist] [Rank 0] step=3090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:09,363] [INFO] [timer.py:160:stop] 0/3090, SamplesPerSec=6297.946880649096
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00096 | Step 00020 | Loss 0.5497 | Train Acc 0.8522 | Speed (samples/sec) 23260.8112 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:14:11,765] [INFO] [logging.py:60:log_dist] [Rank 0] step=3100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:11,797] [INFO] [timer.py:160:stop] 0/3100, SamplesPerSec=6299.222156057298
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

avg iteration(step) data from cpu to GPU time:9.99024714 ms
avg iteration GPU training time:231.89941689 ms
avg iteration (step) total cpu time:251.32480374 ms
Epoch Time(s): 10.2839
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.5500 | Train Acc 0.8450 | Speed (samples/sec) 23254.4574 | GPU 10161.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:14:16,304] [INFO] [logging.py:60:log_dist] [Rank 0] step=3110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:16,337] [INFO] [timer.py:160:stop] 0/3110, SamplesPerSec=6297.044675775578
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

[2021-06-12 23:14:19,123] [INFO] [logging.py:60:log_dist] [Rank 0] step=3120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:19,157] [INFO] [timer.py:160:stop] 0/3120, SamplesPerSec=6295.124963576109
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

Epoch 00097 | Step 00020 | Loss 0.5439 | Train Acc 0.8487 | Speed (samples/sec) 23246.5243 | GPU 10161.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.923350811004639  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.923350811004639  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:21,937] [INFO] [logging.py:60:log_dist] [Rank 0] step=3130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:21,971] [INFO] [timer.py:160:stop] 0/3130, SamplesPerSec=6293.3511980482035
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

avg iteration(step) data from cpu to GPU time:10.60321894 ms
avg iteration GPU training time:255.73767259 ms
avg iteration (step) total cpu time:275.98713062 ms
Epoch Time(s): 10.6116
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.5204 | Train Acc 0.8554 | Speed (samples/sec) 23238.2063 | GPU 10162.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:26,415] [INFO] [logging.py:60:log_dist] [Rank 0] step=3140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:26,448] [INFO] [timer.py:160:stop] 0/3140, SamplesPerSec=6292.077678528948
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:29,217] [INFO] [logging.py:60:log_dist] [Rank 0] step=3150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:29,251] [INFO] [timer.py:160:stop] 0/3150, SamplesPerSec=6290.285551301338
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

Epoch 00098 | Step 00020 | Loss 0.5621 | Train Acc 0.8432 | Speed (samples/sec) 23235.2051 | GPU 10162.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:31,804] [INFO] [logging.py:60:log_dist] [Rank 0] step=3160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:31,837] [INFO] [timer.py:160:stop] 0/3160, SamplesPerSec=6290.330437193544
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

avg iteration(step) data from cpu to GPU time:9.65049963 ms
avg iteration GPU training time:243.03242719 ms
avg iteration (step) total cpu time:262.20325187 ms
Epoch Time(s): 10.2628
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.5466 | Train Acc 0.8479 | Speed (samples/sec) 23230.7498 | GPU 10162.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:36,077] [INFO] [logging.py:60:log_dist] [Rank 0] step=3170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:36,111] [INFO] [timer.py:160:stop] 0/3170, SamplesPerSec=6290.221107286784
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:38,856] [INFO] [logging.py:60:log_dist] [Rank 0] step=3180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:38,890] [INFO] [timer.py:160:stop] 0/3180, SamplesPerSec=6288.747839197117
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

Epoch 00099 | Step 00020 | Loss 0.5445 | Train Acc 0.8477 | Speed (samples/sec) 23230.1583 | GPU 10162.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:41,454] [INFO] [logging.py:60:log_dist] [Rank 0] step=3190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:41,488] [INFO] [timer.py:160:stop] 0/3190, SamplesPerSec=6288.764797276134
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:43,962] [INFO] [logging.py:60:log_dist] [Rank 0] step=3200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:43,974] [INFO] [timer.py:160:stop] 0/3200, SamplesPerSec=6289.5178746434
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

avg iteration(step) data from cpu to GPU time:10.07057420 ms
avg iteration GPU training time:237.42195695 ms
avg iteration (step) total cpu time:257.42809861 ms
Epoch Time(s): 10.1522
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.5199 | Train Acc 0.8543 | Speed (samples/sec) 23225.6009 | GPU 10162.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:48,551] [INFO] [logging.py:60:log_dist] [Rank 0] step=3210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:48,584] [INFO] [timer.py:160:stop] 0/3210, SamplesPerSec=6288.1027653134115
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:51,411] [INFO] [logging.py:60:log_dist] [Rank 0] step=3220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:51,445] [INFO] [timer.py:160:stop] 0/3220, SamplesPerSec=6285.9113476182865
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

Epoch 00100 | Step 00020 | Loss 0.5270 | Train Acc 0.8464 | Speed (samples/sec) 23220.6817 | GPU 10162.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58056640625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes

[2021-06-12 23:14:53,960] [INFO] [logging.py:60:log_dist] [Rank 0] step=3230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 23:14:53,994] [INFO] [timer.py:160:stop] 0/3230, SamplesPerSec=6286.215689472812
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.924253463745117  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.924253463745117  GigaBytes

avg iteration(step) data from cpu to GPU time:9.97134214 ms
avg iteration GPU training time:246.57699076 ms
avg iteration (step) total cpu time:266.40850526 ms
Epoch Time(s): 10.5096
Eval Acc 0.8583
Test Acc: 0.6446
Avg epoch time(time.time()): 10039.840184152126 ms
total avg iteration(step) data from cpu to GPU time:9.81985065 ms
total avg iteration GPU training time:236.13710961 ms
total avg iteration (step) total cpu time:255.83728539 ms
